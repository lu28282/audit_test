2022-11-01T12:57:32.755+01:00  INFO 56741 --- [main] c.example.demo.AuditLogTestApplication   : Starting AuditLogTestApplication using Java 17.0.4.1 on luca-MS-7850 with PID 56741 (/home/luca/Desktop/spring stuff/demo/target/classes started by luca in /home/luca/Desktop/spring stuff/demo)
2022-11-01T12:57:32.764+01:00  INFO 56741 --- [main] c.example.demo.AuditLogTestApplication   : No active profile set, falling back to 1 default profile: "default"
2022-11-01T12:57:33.379+01:00  INFO 56741 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-11-01T12:57:33.435+01:00  INFO 56741 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 45 ms. Found 1 JPA repository interfaces.
2022-11-01T12:57:33.884+01:00  INFO 56741 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
2022-11-01T12:57:33.891+01:00  INFO 56741 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-11-01T12:57:33.892+01:00  INFO 56741 --- [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.0.27]
2022-11-01T12:57:33.974+01:00  INFO 56741 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-11-01T12:57:33.974+01:00  INFO 56741 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1132 ms
2022-11-01T12:57:34.023+01:00  WARN 56741 --- [main] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'dataSourceScriptDatabaseInitializer' defined in class path resource [org/springframework/boot/autoconfigure/sql/init/DataSourceInitializationConfiguration.class]: Unsatisfied dependency expressed through method 'dataSourceScriptDatabaseInitializer' parameter 0: Error creating bean with name 'dataSource' defined in class path resource [org/springframework/boot/autoconfigure/jdbc/DataSourceConfiguration$Hikari.class]: Failed to instantiate [com.zaxxer.hikari.HikariDataSource]: Factory method 'dataSource' threw exception with message: Failed to determine a suitable driver class
2022-11-01T12:57:34.025+01:00  INFO 56741 --- [main] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]
2022-11-01T12:57:34.056+01:00 ERROR 56741 --- [main] o.s.b.d.LoggingFailureAnalysisReporter   : 

***************************
APPLICATION FAILED TO START
***************************

Description:

Failed to configure a DataSource: 'url' attribute is not specified and no embedded datasource could be configured.

Reason: Failed to determine a suitable driver class


Action:

Consider the following:
	If you want an embedded database (H2, HSQL or Derby), please put it on the classpath.
	If you have database settings to be loaded from a particular profile you may need to activate it (no profiles are currently active).

2022-11-01T12:58:56.211+01:00  INFO 57309 --- [main] c.example.demo.AuditLogTestApplication   : Starting AuditLogTestApplication using Java 17.0.4.1 on luca-MS-7850 with PID 57309 (/home/luca/Desktop/spring stuff/demo/target/classes started by luca in /home/luca/Desktop/spring stuff/demo)
2022-11-01T12:58:56.215+01:00  INFO 57309 --- [main] c.example.demo.AuditLogTestApplication   : No active profile set, falling back to 1 default profile: "default"
2022-11-01T12:58:56.691+01:00  INFO 57309 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-11-01T12:58:56.749+01:00  INFO 57309 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 43 ms. Found 1 JPA repository interfaces.
2022-11-01T12:58:57.220+01:00  INFO 57309 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
2022-11-01T12:58:57.231+01:00  INFO 57309 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-11-01T12:58:57.231+01:00  INFO 57309 --- [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.0.27]
2022-11-01T12:58:57.330+01:00  INFO 57309 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-11-01T12:58:57.331+01:00  INFO 57309 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1070 ms
2022-11-01T12:58:57.501+01:00  INFO 57309 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-11-01T12:58:57.577+01:00  INFO 57309 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.1.4.Final
2022-11-01T12:58:57.757+01:00  WARN 57309 --- [main] org.hibernate.orm.deprecation            : HHH90000021: Encountered deprecated setting [javax.persistence.sharedCache.mode], use [jakarta.persistence.sharedCache.mode] instead
2022-11-01T12:58:57.872+01:00  INFO 57309 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-11-01T12:58:58.136+01:00  INFO 57309 --- [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@15f519f7
2022-11-01T12:58:58.138+01:00  INFO 57309 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-11-01T12:58:58.194+01:00  INFO 57309 --- [main] SQL dialect                              : HHH000400: Using dialect: org.hibernate.dialect.MySQLDialect
2022-11-01T12:58:58.770+01:00  INFO 57309 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-11-01T12:58:58.776+01:00  INFO 57309 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-11-01T12:58:59.012+01:00  INFO 57309 --- [main] o.a.k.connect.json.JsonConverterConfig   : JsonConverterConfig values: 
	converter.type = key
	decimal.format = BASE64
	schemas.cache.size = 1000
	schemas.enable = false

2022-11-01T12:58:59.014+01:00  INFO 57309 --- [main] o.a.k.connect.json.JsonConverterConfig   : JsonConverterConfig values: 
	converter.type = value
	decimal.format = BASE64
	schemas.cache.size = 1000
	schemas.enable = false

2022-11-01T12:58:59.021+01:00  INFO 57309 --- [main] i.d.e.EmbeddedEngine$EmbeddedConfig      : EmbeddedConfig values: 
	access.control.allow.methods = 
	access.control.allow.origin = 
	admin.listeners = null
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	config.providers = []
	connector.client.config.override.policy = All
	header.converter = class org.apache.kafka.connect.storage.SimpleHeaderConverter
	key.converter = class org.apache.kafka.connect.json.JsonConverter
	listeners = [http://:8083]
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	offset.flush.interval.ms = 60000
	offset.flush.timeout.ms = 5000
	offset.storage.file.filename = /tmp/offsets_10373112995339397416.dat
	offset.storage.partitions = null
	offset.storage.replication.factor = null
	offset.storage.topic = 
	plugin.path = null
	response.http.headers.config = 
	rest.advertised.host.name = null
	rest.advertised.listener = null
	rest.advertised.port = null
	rest.extension.classes = []
	ssl.cipher.suites = null
	ssl.client.auth = none
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	task.shutdown.graceful.timeout.ms = 5000
	topic.creation.enable = true
	topic.tracking.allow.reset = true
	topic.tracking.enable = true
	value.converter = class org.apache.kafka.connect.json.JsonConverter

2022-11-01T12:58:59.022+01:00  WARN 57309 --- [main] o.a.kafka.connect.runtime.WorkerConfig   : Variables cannot be used in the 'plugin.path' property, since the property is used by plugin scanning before the config providers that replace the variables are initialized. The raw value 'null' was used for plugin scanning, as opposed to the transformed value 'null', and this may cause unexpected results.
2022-11-01T12:58:59.027+01:00  INFO 57309 --- [pool-1-thread-1] o.a.k.c.storage.FileOffsetBackingStore   : Starting FileOffsetBackingStore with file /tmp/offsets_10373112995339397416.dat
2022-11-01T12:58:59.061+01:00  WARN 57309 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-11-01T12:58:59.070+01:00  INFO 57309 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-01T12:58:59.071+01:00  INFO 57309 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-01T12:58:59.071+01:00  INFO 57309 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-01T12:58:59.071+01:00  INFO 57309 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-01T12:58:59.071+01:00  INFO 57309 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-01T12:58:59.071+01:00  INFO 57309 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-01T12:58:59.071+01:00  INFO 57309 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-01T12:58:59.071+01:00  INFO 57309 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-01T12:58:59.071+01:00  INFO 57309 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-01T12:58:59.071+01:00  INFO 57309 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-01T12:58:59.072+01:00  INFO 57309 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_1151120796229225807.dat
2022-11-01T12:58:59.072+01:00  INFO 57309 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-01T12:58:59.072+01:00  INFO 57309 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-01T12:58:59.072+01:00  INFO 57309 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-01T12:58:59.072+01:00  INFO 57309 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_10373112995339397416.dat
2022-11-01T12:58:59.072+01:00  INFO 57309 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-01T12:58:59.072+01:00  INFO 57309 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-01T12:58:59.072+01:00  INFO 57309 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-01T12:58:59.072+01:00  INFO 57309 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-01T12:58:59.073+01:00  INFO 57309 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-01T12:58:59.073+01:00  INFO 57309 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-01T12:58:59.073+01:00  INFO 57309 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-01T12:58:59.100+01:00  INFO 57309 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-01T12:58:59.145+01:00  INFO 57309 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-01T12:58:59.220+01:00  INFO 57309 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-01T12:58:59.222+01:00  INFO 57309 --- [pool-2-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-01T12:58:59.223+01:00  INFO 57309 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-01T12:58:59.224+01:00  INFO 57309 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-01T12:58:59.255+01:00  INFO 57309 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-01T12:58:59.257+01:00  INFO 57309 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-01T12:58:59.260+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-01T12:58:59.261+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-01T12:58:59.264+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-01T12:58:59.264+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-01T12:58:59.265+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-01T12:58:59.265+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-01T12:58:59.265+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-01T12:58:59.267+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, mysql, performance_schema, sys]
2022-11-01T12:58:59.268+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-01T12:58:59.279+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, performance_schema, dbSRC, mysql, sys]
2022-11-01T12:58:59.280+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-01T12:58:59.281+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-01T12:58:59.284+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-01T12:58:59.287+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-01T12:58:59.291+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read binlog position of MySQL primary server
2022-11-01T12:58:59.293+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 using binlog 'binlog.000005' at position '493' and gtid 'ad2c6120-59d9-11ed-82f8-0242ac130002:1'
2022-11-01T12:58:59.293+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-01T12:58:59.293+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : All eligible tables schema should be captured, capturing: [dbSRC.customer]
2022-11-01T12:58:59.423+01:00  INFO 57309 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
2022-11-01T12:58:59.432+01:00  INFO 57309 --- [main] c.example.demo.AuditLogTestApplication   : Started AuditLogTestApplication in 3.628 seconds (process running for 4.152)
2022-11-01T12:58:59.793+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Reading structure of database 'dbSRC'
2022-11-01T12:58:59.859+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 6 - Persisting schema history
2022-11-01T12:58:59.878+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Releasing global read lock to enable MySQL writes
2022-11-01T12:58:59.879+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Writes to MySQL tables prevented for a total of 00:00:00.593
2022-11-01T12:58:59.880+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 7 - Snapshotting data
2022-11-01T12:58:59.880+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshotting contents of 1 tables while still in transaction
2022-11-01T12:58:59.880+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Exporting data from table 'dbSRC.customer' (1 of 1 tables)
2022-11-01T12:58:59.882+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : 	 For table 'dbSRC.customer' using select statement: 'SELECT `id`, `fullname`, `email` FROM `dbSRC`.`customer`'
2022-11-01T12:58:59.893+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : 	 Finished exporting 0 records for table 'dbSRC.customer'; total duration '00:00:00.013'
2022-11-01T12:58:59.895+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-01T12:58:59.895+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot completed
2022-11-01T12:58:59.895+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Snapshot ended with SnapshotResult [status=COMPLETED, offset=MySqlOffsetContext [sourceInfoSchema=Schema{io.debezium.connector.mysql.Source:STRUCT}, sourceInfo=SourceInfo [currentGtid=null, currentBinlogFilename=binlog.000005, currentBinlogPosition=493, currentRowNumber=0, serverId=0, sourceTime=2022-11-01T11:58:59.868Z, threadId=-1, currentQuery=null, tableIds=[dbSRC.customer], databaseName=dbSRC], snapshotCompleted=true, transactionContext=TransactionContext [currentTransactionId=null, perTableEventCount={}, totalEventCount=0], restartGtidSet=ad2c6120-59d9-11ed-82f8-0242ac130002:1, currentGtidSet=ad2c6120-59d9-11ed-82f8-0242ac130002:1, restartBinlogFilename=binlog.000005, restartBinlogPosition=493, restartRowsToSkip=0, restartEventsToSkip=0, currentEventLengthInBytes=0, inTransaction=false, transactionId=null, incrementalSnapshotContext =IncrementalSnapshotContext [windowOpened=false, chunkEndPosition=null, dataCollectionsToSnapshot=[], lastEventKeySent=null, maximumKey=null]]]
2022-11-01T12:58:59.919+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = binlog-client
2022-11-01T12:58:59.921+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Starting streaming
2022-11-01T12:58:59.935+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlStreamingChangeEventSource  : GTID set purged on server: 
2022-11-01T12:58:59.935+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlStreamingChangeEventSource  : Attempting to generate a filtered GTID set
2022-11-01T12:58:59.935+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlStreamingChangeEventSource  : GTID set from previous recorded offset: ad2c6120-59d9-11ed-82f8-0242ac130002:1
2022-11-01T12:58:59.936+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlStreamingChangeEventSource  : GTID set available on server: ad2c6120-59d9-11ed-82f8-0242ac130002:1-1
2022-11-01T12:58:59.936+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlStreamingChangeEventSource  : Using first available positions for new GTID channels
2022-11-01T12:58:59.936+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlStreamingChangeEventSource  : Relevant GTID set available on server: ad2c6120-59d9-11ed-82f8-0242ac130002:1-1
2022-11-01T12:58:59.937+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlStreamingChangeEventSource  : Final merged GTID set to use when connecting to MySQL: ad2c6120-59d9-11ed-82f8-0242ac130002:1-1
2022-11-01T12:58:59.938+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlStreamingChangeEventSource  : Registering binlog reader with GTID set: ad2c6120-59d9-11ed-82f8-0242ac130002:1-1
2022-11-01T12:58:59.938+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlStreamingChangeEventSource  : Skip 0 events on streaming start
2022-11-01T12:58:59.939+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlStreamingChangeEventSource  : Skip 0 rows on streaming start
2022-11-01T12:58:59.939+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-binlog-client
2022-11-01T12:58:59.942+01:00  INFO 57309 --- [blc-localhost:3306] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-binlog-client
2022-11-01T12:58:59.951+01:00  INFO 57309 --- [blc-localhost:3306] c.g.shyiko.mysql.binlog.BinaryLogClient  : Connected to localhost:3306 at ad2c6120-59d9-11ed-82f8-0242ac130002:1-1 (sid:1, cid:27)
2022-11-01T12:58:59.951+01:00  INFO 57309 --- [blc-localhost:3306] i.d.c.m.MySqlStreamingChangeEventSource  : Connected to MySQL binlog at localhost:3306, starting at MySqlOffsetContext [sourceInfoSchema=Schema{io.debezium.connector.mysql.Source:STRUCT}, sourceInfo=SourceInfo [currentGtid=null, currentBinlogFilename=binlog.000005, currentBinlogPosition=493, currentRowNumber=0, serverId=0, sourceTime=2022-11-01T11:58:59.868Z, threadId=-1, currentQuery=null, tableIds=[dbSRC.customer], databaseName=dbSRC], snapshotCompleted=true, transactionContext=TransactionContext [currentTransactionId=null, perTableEventCount={}, totalEventCount=0], restartGtidSet=ad2c6120-59d9-11ed-82f8-0242ac130002:1-1, currentGtidSet=ad2c6120-59d9-11ed-82f8-0242ac130002:1-1, restartBinlogFilename=binlog.000005, restartBinlogPosition=493, restartRowsToSkip=0, restartEventsToSkip=0, currentEventLengthInBytes=0, inTransaction=false, transactionId=null, incrementalSnapshotContext =IncrementalSnapshotContext [windowOpened=false, chunkEndPosition=null, dataCollectionsToSnapshot=[], lastEventKeySent=null, maximumKey=null]]
2022-11-01T12:58:59.952+01:00  INFO 57309 --- [blc-localhost:3306] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-binlog-client
2022-11-01T12:58:59.952+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlStreamingChangeEventSource  : Waiting for keepalive thread to start
2022-11-01T12:58:59.953+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlStreamingChangeEventSource  : Keepalive thread is running
2022-11-01T13:00:01.383+01:00  INFO 57309 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : 1 records sent during previous 00:01:02.338, last recorded offset of {server=my-app-connector} partition is {transaction_id=null, ts_sec=1667304001, file=binlog.000005, pos=572, gtids=ad2c6120-59d9-11ed-82f8-0242ac130002:1-1, row=1, server_id=1, event=2}
2022-11-01T13:00:01.384+01:00  INFO 57309 --- [pool-1-thread-1] c.e.demo.listener.DebeziumListener       : Key = 'Struct{id=1}' value = 'Struct{after=Struct{id=1,fullname=John Doe,email=jd@example.com},source=Struct{version=2.0.0.Final,connector=mysql,name=my-app-connector,ts_ms=1667304001000,db=dbSRC,table=customer,server_id=1,gtid=ad2c6120-59d9-11ed-82f8-0242ac130002:2,file=binlog.000005,pos=714,row=0,thread=14},op=c,ts_ms=1667304001034}'
2022-11-01T13:01:51.609+01:00  INFO 57309 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : 2 records sent during previous 00:01:50.226, last recorded offset of {server=my-app-connector} partition is {transaction_id=null, ts_sec=1667304111, file=binlog.000005, pos=890, gtids=ad2c6120-59d9-11ed-82f8-0242ac130002:1-2, row=1, server_id=1, event=2}
2022-11-01T13:01:51.609+01:00  INFO 57309 --- [pool-1-thread-1] c.e.demo.listener.DebeziumListener       : Key = 'Struct{id=1}' value = 'Struct{before=Struct{id=1,fullname=John Doe,email=jd@example.com},source=Struct{version=2.0.0.Final,connector=mysql,name=my-app-connector,ts_ms=1667304111000,db=dbSRC,table=customer,server_id=1,gtid=ad2c6120-59d9-11ed-82f8-0242ac130002:3,file=binlog.000005,pos=1032,row=0,thread=14},op=d,ts_ms=1667304111361}'
2022-11-01T13:01:51.609+01:00  INFO 57309 --- [pool-1-thread-1] c.e.demo.listener.DebeziumListener       : Key = 'Struct{id=1}' value = 'null'
2022-11-01T13:01:58.681+01:00  INFO 57309 --- [SpringApplicationShutdownHook] io.debezium.embedded.EmbeddedEngine      : Stopping the embedded engine
2022-11-01T13:01:58.681+01:00  INFO 57309 --- [SpringApplicationShutdownHook] io.debezium.embedded.EmbeddedEngine      : Waiting for PT5M for connector to stop
2022-11-01T13:01:59.125+01:00  INFO 57309 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Stopping the task and engine
2022-11-01T13:01:59.125+01:00  INFO 57309 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Stopping down connector
2022-11-01T13:01:59.221+01:00  INFO 57309 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Finished streaming
2022-11-01T13:01:59.221+01:00  INFO 57309 --- [blc-localhost:3306] i.d.c.m.MySqlStreamingChangeEventSource  : Stopped reading binlog after 0 events, last recorded offset: {transaction_id=null, ts_sec=1667304111, file=binlog.000005, pos=1129, gtids=ad2c6120-59d9-11ed-82f8-0242ac130002:1-3, server_id=1, event=1}
2022-11-01T13:01:59.222+01:00  INFO 57309 --- [pool-3-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-01T13:01:59.223+01:00  INFO 57309 --- [pool-1-thread-1] o.a.k.c.storage.FileOffsetBackingStore   : Stopped FileOffsetBackingStore
2022-11-01T13:01:59.224+01:00  INFO 57309 --- [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2022-11-01T13:01:59.225+01:00  INFO 57309 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-11-01T13:01:59.231+01:00  INFO 57309 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-11-02T08:12:27.296+01:00  INFO 35740 --- [main] c.example.demo.AuditLogTestApplication   : Starting AuditLogTestApplication using Java 17.0.4.1 with PID 35740 (/home/schmitz/dev/security/audit_test/target/classes started by schmitz in /home/schmitz/dev/security/audit_test)
2022-11-02T08:12:27.299+01:00  INFO 35740 --- [main] c.example.demo.AuditLogTestApplication   : No active profile set, falling back to 1 default profile: "default"
2022-11-02T08:12:27.811+01:00  INFO 35740 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-11-02T08:12:27.867+01:00  INFO 35740 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 46 ms. Found 1 JPA repository interfaces.
2022-11-02T08:12:28.285+01:00  INFO 35740 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
2022-11-02T08:12:28.295+01:00  INFO 35740 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-11-02T08:12:28.296+01:00  INFO 35740 --- [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.0.27]
2022-11-02T08:12:28.389+01:00  INFO 35740 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-11-02T08:12:28.390+01:00  INFO 35740 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1053 ms
2022-11-02T08:12:28.568+01:00  INFO 35740 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-11-02T08:12:28.608+01:00  INFO 35740 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.1.5.Final
2022-11-02T08:12:28.717+01:00  WARN 35740 --- [main] org.hibernate.orm.deprecation            : HHH90000021: Encountered deprecated setting [javax.persistence.sharedCache.mode], use [jakarta.persistence.sharedCache.mode] instead
2022-11-02T08:12:28.793+01:00  INFO 35740 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-11-02T08:12:29.088+01:00  INFO 35740 --- [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@3d8d52be
2022-11-02T08:12:29.090+01:00  INFO 35740 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-11-02T08:12:29.133+01:00  INFO 35740 --- [main] SQL dialect                              : HHH000400: Using dialect: org.hibernate.dialect.MySQLDialect
2022-11-02T08:12:29.635+01:00  INFO 35740 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-11-02T08:12:29.641+01:00  INFO 35740 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-11-02T08:12:29.690+01:00  INFO 35740 --- [main] o.a.k.connect.json.JsonConverterConfig   : JsonConverterConfig values: 
	converter.type = key
	decimal.format = BASE64
	schemas.cache.size = 1000
	schemas.enable = false

2022-11-02T08:12:29.692+01:00  INFO 35740 --- [main] o.a.k.connect.json.JsonConverterConfig   : JsonConverterConfig values: 
	converter.type = value
	decimal.format = BASE64
	schemas.cache.size = 1000
	schemas.enable = false

2022-11-02T08:12:29.699+01:00  INFO 35740 --- [main] i.d.e.EmbeddedEngine$EmbeddedConfig      : EmbeddedConfig values: 
	access.control.allow.methods = 
	access.control.allow.origin = 
	admin.listeners = null
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	config.providers = []
	connector.client.config.override.policy = All
	header.converter = class org.apache.kafka.connect.storage.SimpleHeaderConverter
	key.converter = class org.apache.kafka.connect.json.JsonConverter
	listeners = [http://:8083]
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	offset.flush.interval.ms = 60000
	offset.flush.timeout.ms = 5000
	offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
	offset.storage.partitions = null
	offset.storage.replication.factor = null
	offset.storage.topic = 
	plugin.path = null
	response.http.headers.config = 
	rest.advertised.host.name = null
	rest.advertised.listener = null
	rest.advertised.port = null
	rest.extension.classes = []
	ssl.cipher.suites = null
	ssl.client.auth = none
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	task.shutdown.graceful.timeout.ms = 5000
	topic.creation.enable = true
	topic.tracking.allow.reset = true
	topic.tracking.enable = true
	value.converter = class org.apache.kafka.connect.json.JsonConverter

2022-11-02T08:12:29.699+01:00  WARN 35740 --- [main] o.a.kafka.connect.runtime.WorkerConfig   : Variables cannot be used in the 'plugin.path' property, since the property is used by plugin scanning before the config providers that replace the variables are initialized. The raw value 'null' was used for plugin scanning, as opposed to the transformed value 'null', and this may cause unexpected results.
2022-11-02T08:12:29.704+01:00  INFO 35740 --- [pool-1-thread-1] o.a.k.c.storage.FileOffsetBackingStore   : Starting FileOffsetBackingStore with file /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:29.744+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:29.745+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:29.746+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:29.746+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:29.746+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:29.746+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:29.746+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:29.746+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:29.747+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:29.747+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:29.747+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:29.747+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:29.747+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:29.747+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:29.747+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:29.748+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:29.752+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:29.752+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:29.752+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:29.753+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:29.753+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:29.753+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:29.780+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:29.830+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:29.890+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:29.892+01:00  INFO 35740 --- [pool-2-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:29.893+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:29.893+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:29.924+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:29.926+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:29.930+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:29.931+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:29.937+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:29.937+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:29.938+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:29.938+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:29.939+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:29.941+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:29.941+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:29.958+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:29.959+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:29.960+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:29.961+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:29.964+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:29.965+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:29.966+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:29.967+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:29.968+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:29.970+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:29.971+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:29.971+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:30.030+01:00  WARN 35740 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-11-02T08:12:30.429+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:30.431+01:00  INFO 35740 --- [pool-3-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:30.432+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:30.434+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:30.434+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:30.435+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:30.436+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:30.436+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:30.436+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:30.436+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:30.436+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:30.436+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:30.437+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:30.437+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:30.437+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:30.437+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:30.437+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:30.437+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:30.437+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:30.437+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:30.437+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:30.437+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:30.437+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:30.437+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:30.438+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:30.438+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:30.438+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:30.439+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:30.453+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:30.464+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:30.465+01:00  INFO 35740 --- [pool-4-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:30.466+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:30.466+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:30.473+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:30.473+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:30.475+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:30.475+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:30.475+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:30.475+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:30.475+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:30.476+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:30.476+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:30.479+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:30.479+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:30.486+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:30.487+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:30.487+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:30.487+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:30.489+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:30.491+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:30.492+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:30.492+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:30.493+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:30.494+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:30.495+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:30.495+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:30.507+01:00  INFO 35740 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
2022-11-02T08:12:30.519+01:00  INFO 35740 --- [main] c.example.demo.AuditLogTestApplication   : Started AuditLogTestApplication in 3.518 seconds (process running for 3.955)
2022-11-02T08:12:30.974+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:30.977+01:00  INFO 35740 --- [pool-5-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:30.977+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:30.977+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:30.977+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:30.978+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:30.978+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:30.978+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:30.978+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:30.978+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:30.978+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:30.978+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:30.978+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:30.978+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:30.978+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:30.978+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:30.978+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:30.978+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:30.978+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:30.978+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:30.978+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:30.978+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:30.978+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:30.978+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:30.978+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:30.978+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:30.978+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:30.979+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:30.987+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:30.990+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:30.991+01:00  INFO 35740 --- [pool-6-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:30.991+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:30.991+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:30.994+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:30.994+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:30.994+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:30.995+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:30.995+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:30.995+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:30.995+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:30.995+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:30.995+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:30.996+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:30.996+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:30.998+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:30.999+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:30.999+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:30.999+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:31.000+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:31.000+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:31.000+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:31.000+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:31.001+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:31.001+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:31.001+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:31.001+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:31.494+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:31.496+01:00  INFO 35740 --- [pool-7-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:31.496+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:31.497+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:31.497+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:31.497+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:31.498+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:31.498+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:31.498+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:31.498+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:31.498+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:31.498+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:31.498+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:31.498+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:31.498+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:31.498+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:31.498+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:31.498+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:31.498+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:31.498+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:31.498+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:31.498+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:31.498+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:31.498+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:31.498+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:31.498+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:31.498+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:31.499+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:31.505+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:31.510+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:31.511+01:00  INFO 35740 --- [pool-8-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:31.511+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:31.511+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:31.514+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:31.514+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:31.515+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:31.515+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:31.515+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:31.515+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:31.515+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:31.515+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:31.515+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:31.516+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:31.516+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:31.519+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:31.519+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:31.519+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:31.519+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:31.520+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:31.520+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:31.521+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:31.521+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:31.521+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:31.522+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:31.522+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:31.522+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:32.015+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:32.017+01:00  INFO 35740 --- [pool-9-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:32.018+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:32.018+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:32.019+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:32.019+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:32.019+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:32.019+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:32.019+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:32.019+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:32.019+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:32.019+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:32.019+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:32.019+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:32.020+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:32.020+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:32.020+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:32.020+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:32.020+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:32.020+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:32.020+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:32.020+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:32.020+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:32.020+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:32.020+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:32.020+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:32.020+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:32.021+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:32.026+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:32.030+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:32.031+01:00  INFO 35740 --- [pool-10-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:32.031+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:32.031+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:32.034+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:32.034+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:32.035+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:32.035+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:32.035+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:32.035+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:32.035+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:32.036+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:32.036+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:32.037+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:32.037+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:32.041+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:32.042+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:32.042+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:32.042+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:32.042+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:32.043+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:32.043+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:32.043+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:32.043+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:32.044+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:32.044+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:32.044+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:32.535+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:32.537+01:00  INFO 35740 --- [pool-11-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:32.537+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:32.538+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:32.538+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:32.538+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:32.538+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:32.538+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:32.538+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:32.538+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:32.539+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:32.539+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:32.539+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:32.539+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:32.539+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:32.539+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:32.539+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:32.539+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:32.539+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:32.539+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:32.539+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:32.539+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:32.539+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:32.539+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:32.539+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:32.539+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:32.539+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:32.540+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:32.548+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:32.556+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:32.557+01:00  INFO 35740 --- [pool-12-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:32.557+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:32.557+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:32.559+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:32.559+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:32.560+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:32.560+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:32.560+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:32.560+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:32.560+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:32.560+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:32.560+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:32.562+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:32.562+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:32.565+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:32.565+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:32.566+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:32.566+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:32.566+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:32.567+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:32.567+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:32.567+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:32.567+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:32.568+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:32.568+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:32.568+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:33.060+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:33.062+01:00  INFO 35740 --- [pool-13-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:33.062+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:33.063+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:33.063+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:33.063+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:33.064+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:33.064+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:33.064+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:33.064+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:33.064+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:33.064+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:33.064+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:33.064+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:33.064+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:33.064+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:33.064+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:33.064+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:33.064+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:33.064+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:33.064+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:33.064+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:33.064+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:33.064+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:33.064+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:33.064+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:33.064+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:33.065+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:33.071+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:33.077+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:33.078+01:00  INFO 35740 --- [pool-14-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:33.078+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:33.078+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:33.080+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:33.080+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:33.081+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:33.081+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:33.081+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:33.081+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:33.081+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:33.081+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:33.081+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:33.083+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:33.083+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:33.087+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:33.087+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:33.088+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:33.088+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:33.089+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:33.089+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:33.089+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:33.089+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:33.090+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:33.090+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:33.090+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:33.090+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:33.581+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:33.582+01:00  INFO 35740 --- [pool-15-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:33.582+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:33.582+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:33.583+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:33.583+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:33.583+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:33.583+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:33.583+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:33.583+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:33.583+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:33.583+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:33.583+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:33.583+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:33.583+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:33.583+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:33.583+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:33.583+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:33.583+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:33.583+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:33.583+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:33.583+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:33.583+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:33.583+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:33.583+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:33.584+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:33.584+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:33.584+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:33.592+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:33.598+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:33.599+01:00  INFO 35740 --- [pool-16-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:33.599+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:33.599+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:33.603+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:33.603+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:33.603+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:33.603+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:33.604+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:33.604+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:33.604+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:33.604+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:33.604+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:33.605+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:33.605+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:33.610+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:33.610+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:33.610+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:33.610+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:33.611+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:33.611+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:33.612+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:33.612+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:33.612+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:33.613+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:33.613+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:33.613+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:34.103+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:34.105+01:00  INFO 35740 --- [pool-17-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:34.105+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:34.106+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:34.106+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:34.106+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:34.106+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:34.107+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:34.107+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:34.107+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:34.107+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:34.107+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:34.107+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:34.107+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:34.107+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:34.107+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:34.107+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:34.107+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:34.107+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:34.107+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:34.107+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:34.107+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:34.107+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:34.107+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:34.107+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:34.107+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:34.107+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:34.107+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:34.113+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:34.117+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:34.117+01:00  INFO 35740 --- [pool-18-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:34.117+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:34.117+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:34.120+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:34.120+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:34.121+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:34.121+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:34.121+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:34.121+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:34.121+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:34.121+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:34.121+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:34.122+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:34.122+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:34.124+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:34.125+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:34.125+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:34.125+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:34.126+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:34.126+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:34.126+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:34.126+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:34.127+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:34.127+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:34.127+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:34.127+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:34.620+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:34.623+01:00  INFO 35740 --- [pool-19-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:34.623+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:34.624+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:34.624+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:34.625+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:34.625+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:34.625+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:34.625+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:34.625+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:34.625+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:34.625+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:34.625+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:34.625+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:34.625+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:34.625+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:34.625+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:34.625+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:34.625+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:34.625+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:34.625+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:34.625+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:34.625+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:34.625+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:34.625+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:34.625+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:34.625+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:34.626+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:34.633+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:34.637+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:34.637+01:00  INFO 35740 --- [pool-20-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:34.637+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:34.638+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:34.640+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:34.640+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:34.640+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:34.640+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:34.641+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:34.641+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:34.641+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:34.641+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:34.641+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:34.642+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:34.642+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:34.647+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:34.647+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:34.647+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:34.647+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:34.648+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:34.648+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:34.648+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:34.648+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:34.648+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:34.649+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:34.649+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:34.649+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:35.140+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:35.142+01:00  INFO 35740 --- [pool-21-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:35.142+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:35.142+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:35.142+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:35.143+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:35.143+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:35.143+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:35.143+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:35.143+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:35.143+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:35.143+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:35.143+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:35.143+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:35.143+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:35.143+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:35.143+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:35.143+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:35.143+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:35.143+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:35.143+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:35.143+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:35.143+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:35.143+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:35.143+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:35.143+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:35.143+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:35.143+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:35.150+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:35.154+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:35.154+01:00  INFO 35740 --- [pool-22-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:35.154+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:35.154+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:35.157+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:35.157+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:35.158+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:35.158+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:35.158+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:35.158+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:35.158+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:35.158+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:35.158+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:35.159+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:35.159+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:35.162+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:35.162+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:35.163+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:35.163+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:35.163+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:35.164+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:35.164+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:35.164+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:35.164+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:35.164+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:35.165+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:35.165+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:35.658+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:35.660+01:00  INFO 35740 --- [pool-23-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:35.660+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:35.661+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:35.661+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:35.661+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:35.661+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:35.661+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:35.662+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:35.662+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:35.662+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:35.662+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:35.662+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:35.662+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:35.662+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:35.662+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:35.662+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:35.662+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:35.662+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:35.662+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:35.662+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:35.662+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:35.662+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:35.662+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:35.662+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:35.662+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:35.662+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:35.664+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:35.678+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:35.685+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:35.686+01:00  INFO 35740 --- [pool-24-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:35.686+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:35.686+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:35.689+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:35.689+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:35.690+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:35.690+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:35.690+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:35.690+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:35.690+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:35.691+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:35.691+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:35.692+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:35.692+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:35.695+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:35.696+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:35.696+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:35.696+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:35.696+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:35.697+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:35.697+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:35.697+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:35.697+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:35.698+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:35.698+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:35.698+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:36.190+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:36.192+01:00  INFO 35740 --- [pool-25-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:36.192+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:36.193+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:36.193+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:36.193+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:36.193+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:36.193+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:36.193+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:36.193+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:36.193+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:36.193+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:36.193+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:36.193+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:36.193+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:36.193+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:36.193+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:36.193+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:36.194+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:36.194+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:36.194+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:36.194+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:36.194+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:36.194+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:36.194+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:36.194+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:36.194+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:36.194+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:36.203+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:36.208+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:36.209+01:00  INFO 35740 --- [pool-26-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:36.209+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:36.209+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:36.212+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:36.212+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:36.212+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:36.212+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:36.212+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:36.212+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:36.212+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:36.213+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:36.213+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:36.214+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:36.214+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:36.217+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:36.217+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:36.217+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:36.217+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:36.217+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:36.218+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:36.218+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:36.218+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:36.218+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:36.218+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:36.218+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:36.218+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:36.712+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:36.714+01:00  INFO 35740 --- [pool-27-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:36.714+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:36.715+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:36.715+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:36.715+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:36.715+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:36.715+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:36.715+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:36.715+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:36.716+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:36.716+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:36.716+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:36.716+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:36.716+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:36.716+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:36.716+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:36.716+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:36.716+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:36.716+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:36.716+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:36.716+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:36.716+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:36.716+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:36.716+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:36.716+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:36.716+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:36.716+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:36.725+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:36.728+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:36.729+01:00  INFO 35740 --- [pool-28-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:36.729+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:36.729+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:36.732+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:36.732+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:36.732+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:36.732+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:36.732+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:36.732+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:36.733+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:36.733+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:36.733+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:36.734+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:36.734+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:36.736+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:36.737+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:36.737+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:36.737+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:36.737+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:36.738+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:36.738+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:36.738+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:36.738+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:36.739+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:36.739+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:36.739+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:37.232+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:37.233+01:00  INFO 35740 --- [pool-29-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:37.233+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:37.234+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:37.234+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:37.234+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:37.234+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:37.234+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:37.234+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:37.234+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:37.234+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:37.234+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:37.234+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:37.235+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:37.235+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:37.235+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:37.235+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:37.235+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:37.235+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:37.235+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:37.235+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:37.235+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:37.235+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:37.235+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:37.235+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:37.235+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:37.235+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:37.236+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:37.244+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:37.248+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:37.249+01:00  INFO 35740 --- [pool-30-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:37.249+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:37.249+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:37.252+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:37.253+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:37.253+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:37.253+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:37.253+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:37.254+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:37.254+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:37.254+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:37.254+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:37.255+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:37.255+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:37.258+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:37.258+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:37.258+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:37.258+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:37.259+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:37.259+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:37.260+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:37.260+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:37.260+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:37.260+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:37.260+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:37.260+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:37.753+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:37.755+01:00  INFO 35740 --- [pool-31-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:37.756+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:37.756+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:37.756+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:37.756+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:37.756+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:37.756+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:37.756+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:37.756+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:37.756+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:37.756+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:37.756+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:37.756+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:37.756+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:37.756+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:37.756+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:37.756+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:37.756+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:37.756+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:37.756+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:37.756+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:37.756+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:37.756+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:37.756+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:37.756+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:37.756+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:37.757+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:37.762+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:37.766+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:37.767+01:00  INFO 35740 --- [pool-32-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:37.767+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:37.767+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:37.769+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:37.770+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:37.770+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:37.770+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:37.770+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:37.770+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:37.770+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:37.770+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:37.770+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:37.771+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:37.771+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:37.774+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:37.774+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:37.774+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:37.774+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:37.775+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:37.775+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:37.776+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:37.776+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:37.776+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:37.776+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:37.776+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:37.776+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:38.270+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:38.271+01:00  INFO 35740 --- [pool-33-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:38.271+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:38.272+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:38.272+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:38.272+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:38.272+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:38.272+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:38.272+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:38.272+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:38.272+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:38.272+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:38.272+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:38.272+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:38.272+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:38.272+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:38.272+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:38.272+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:38.272+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:38.272+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:38.272+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:38.272+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:38.272+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:38.272+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:38.272+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:38.272+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:38.272+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:38.273+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:38.277+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:38.279+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:38.279+01:00  INFO 35740 --- [pool-34-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:38.279+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:38.280+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:38.282+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:38.282+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:38.282+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:38.283+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:38.283+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:38.283+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:38.283+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:38.283+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:38.283+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:38.285+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:38.285+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:38.287+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:38.287+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:38.287+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:38.287+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:38.288+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:38.288+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:38.288+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:38.288+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:38.289+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:38.289+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:38.289+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:38.289+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:38.782+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:38.784+01:00  INFO 35740 --- [pool-35-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:38.784+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:38.784+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:38.784+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:38.784+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:38.785+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:38.785+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:38.785+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:38.785+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:38.785+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:38.785+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:38.785+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:38.785+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:38.785+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:38.785+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:38.785+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:38.785+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:38.785+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:38.785+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:38.785+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:38.785+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:38.785+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:38.785+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:38.785+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:38.785+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:38.785+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:38.785+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:38.790+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:38.793+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:38.793+01:00  INFO 35740 --- [pool-36-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:38.793+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:38.793+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:38.796+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:38.796+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:38.796+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:38.796+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:38.796+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:38.796+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:38.796+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:38.796+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:38.796+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:38.797+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:38.797+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:38.800+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:38.800+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:38.800+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:38.801+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:38.801+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:38.801+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:38.802+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:38.802+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:38.802+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:38.802+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:38.802+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:38.802+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:39.296+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:39.299+01:00  INFO 35740 --- [pool-37-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:39.299+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:39.300+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:39.300+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:39.300+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:39.300+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:39.300+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:39.300+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:39.300+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:39.300+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:39.300+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:39.300+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:39.300+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:39.300+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:39.300+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:39.300+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:39.300+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:39.300+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:39.300+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:39.300+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:39.300+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:39.300+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:39.300+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:39.300+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:39.300+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:39.300+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:39.300+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:39.306+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:39.309+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:39.309+01:00  INFO 35740 --- [pool-38-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:39.309+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:39.309+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:39.311+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:39.311+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:39.312+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:39.312+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:39.312+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:39.312+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:39.312+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:39.312+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:39.312+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:39.313+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:39.313+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:39.316+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:39.316+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:39.316+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:39.316+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:39.317+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:39.317+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:39.317+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:39.317+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:39.318+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:39.318+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:39.318+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:39.318+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:39.812+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:39.813+01:00  INFO 35740 --- [pool-39-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:39.813+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:39.813+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:39.813+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:39.814+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:39.814+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:39.814+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:39.814+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:39.814+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:39.814+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:39.814+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:39.814+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:39.814+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:39.814+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:39.814+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:39.814+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:39.814+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:39.814+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:39.814+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:39.814+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:39.814+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:39.814+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:39.814+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:39.814+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:39.814+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:39.814+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:39.815+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:39.821+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:39.825+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:39.826+01:00  INFO 35740 --- [pool-40-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:39.826+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:39.826+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:39.828+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:39.828+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:39.829+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:39.829+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:39.829+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:39.829+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:39.829+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:39.829+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:39.829+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:39.831+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:39.831+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:39.834+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:39.834+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:39.834+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:39.834+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:39.835+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:39.835+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:39.835+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:39.835+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:39.835+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:39.836+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:39.836+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:39.836+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:40.329+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:40.331+01:00  INFO 35740 --- [pool-41-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:40.331+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:40.331+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:40.331+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:40.331+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:40.331+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:40.331+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:40.331+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:40.332+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:40.332+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:40.332+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:40.332+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:40.332+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:40.332+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:40.332+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:40.332+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:40.332+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:40.332+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:40.332+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:40.332+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:40.332+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:40.332+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:40.332+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:40.332+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:40.332+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:40.332+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:40.332+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:40.336+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:40.339+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:40.339+01:00  INFO 35740 --- [pool-42-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:40.339+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:40.339+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:40.341+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:40.341+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:40.342+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:40.342+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:40.342+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:40.342+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:40.342+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:40.342+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:40.342+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:40.343+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:40.343+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:40.344+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:40.344+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:40.344+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:40.345+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:40.345+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:40.345+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:40.345+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:40.345+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:40.346+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:40.346+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:40.346+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:40.346+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:40.842+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:40.844+01:00  INFO 35740 --- [pool-43-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:40.844+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:40.844+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:40.844+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:40.845+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:40.845+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:40.845+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:40.845+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:40.845+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:40.845+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:40.845+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:40.845+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:40.845+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:40.845+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:40.845+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:40.845+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:40.845+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:40.845+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:40.845+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:40.845+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:40.845+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:40.845+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:40.845+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:40.845+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:40.845+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:40.845+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:40.846+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:40.853+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:40.856+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:40.856+01:00  INFO 35740 --- [pool-44-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:40.856+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:40.856+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:40.858+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:40.859+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:40.859+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:40.859+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:40.859+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:40.859+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:40.859+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:40.859+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:40.859+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:40.860+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:40.860+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:40.862+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:40.862+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:40.862+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:40.862+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:40.862+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:40.863+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:40.863+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:40.863+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:40.863+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:40.864+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:40.864+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:40.864+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:41.359+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:41.361+01:00  INFO 35740 --- [pool-45-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:41.361+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:41.361+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:41.361+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:41.361+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:41.361+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:41.361+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:41.361+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:41.361+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:41.361+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:41.361+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:41.362+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:41.362+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:41.362+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:41.362+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:41.362+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:41.362+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:41.362+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:41.362+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:41.362+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:41.362+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:41.362+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:41.362+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:41.362+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:41.362+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:41.362+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:41.362+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:41.368+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:41.372+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:41.373+01:00  INFO 35740 --- [pool-46-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:41.373+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:41.373+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:41.375+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:41.375+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:41.376+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:41.376+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:41.376+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:41.376+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:41.376+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:41.376+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:41.376+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:41.377+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:41.377+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:41.380+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:41.380+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:41.380+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:41.381+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:41.381+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:41.381+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:41.382+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:41.382+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:41.382+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:41.382+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:41.382+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:41.382+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:41.876+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:41.878+01:00  INFO 35740 --- [pool-47-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:41.878+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:41.879+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:41.879+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:41.879+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:41.879+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:41.879+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:41.879+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:41.879+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:41.879+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:41.879+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:41.879+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:41.879+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:41.879+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:41.879+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:41.879+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:41.879+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:41.879+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:41.879+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:41.879+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:41.879+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:41.879+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:41.880+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:41.880+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:41.880+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:41.880+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:41.880+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:41.888+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:41.891+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:41.892+01:00  INFO 35740 --- [pool-48-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:41.892+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:41.892+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:41.895+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:41.895+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:41.895+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:41.896+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:41.896+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:41.896+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:41.896+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:41.896+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:41.896+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:41.897+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:41.897+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:41.900+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:41.901+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:41.901+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:41.901+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:41.901+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:41.902+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:41.902+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:41.902+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:41.902+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:41.902+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:41.902+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:41.902+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:42.395+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:42.397+01:00  INFO 35740 --- [pool-49-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:42.400+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:42.401+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:42.401+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:42.401+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:42.401+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:42.401+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:42.401+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:42.401+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:42.401+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:42.401+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:42.401+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:42.401+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:42.401+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:42.401+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:42.401+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:42.401+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:42.401+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:42.401+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:42.401+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:42.401+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:42.401+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:42.401+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:42.401+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:42.401+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:42.401+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:42.402+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:42.407+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:42.409+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:42.410+01:00  INFO 35740 --- [pool-50-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:42.410+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:42.410+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:42.412+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:42.412+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:42.412+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:42.412+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:42.412+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:42.412+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:42.412+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:42.412+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:42.412+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:42.413+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:42.413+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:42.415+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:42.415+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:42.415+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:42.415+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:42.416+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:42.416+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:42.416+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:42.416+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:42.416+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:42.417+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:42.417+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:42.417+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:42.912+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:42.914+01:00  INFO 35740 --- [pool-51-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:42.914+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:42.915+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:42.915+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:42.915+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:42.915+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:42.915+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:42.915+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:42.915+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:42.915+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:42.915+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:42.915+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:42.915+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:42.915+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:42.915+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:42.915+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:42.915+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:42.915+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:42.915+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:42.915+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:42.915+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:42.915+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:42.915+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:42.915+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:42.915+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:42.915+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:42.916+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:42.922+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:42.925+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:42.926+01:00  INFO 35740 --- [pool-52-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:42.926+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:42.926+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:42.928+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:42.928+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:42.928+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:42.928+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:42.929+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:42.929+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:42.929+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:42.929+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:42.929+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:42.930+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:42.930+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:42.931+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:42.931+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:42.932+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:42.932+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:42.932+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:42.932+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:42.932+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:42.932+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:42.933+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:42.933+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:42.933+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:42.933+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:43.429+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:43.430+01:00  INFO 35740 --- [pool-53-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:43.431+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:43.431+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:43.431+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:43.431+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:43.431+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:43.431+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:43.431+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:43.431+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:43.431+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:43.431+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:43.431+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:43.431+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:43.431+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:43.431+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:43.431+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:43.431+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:43.431+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:43.432+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:43.432+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:43.432+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:43.432+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:43.432+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:43.432+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:43.432+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:43.432+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:43.432+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:43.437+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:43.441+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:43.441+01:00  INFO 35740 --- [pool-54-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:43.441+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:43.441+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:43.443+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:43.443+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:43.444+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:43.444+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:43.444+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:43.444+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:43.444+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:43.444+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:43.444+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:43.445+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:43.445+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:43.447+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:43.447+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:43.447+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:43.447+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:43.447+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:43.447+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:43.447+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:43.447+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:43.448+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:43.448+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:43.448+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:43.448+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:43.944+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:43.946+01:00  INFO 35740 --- [pool-55-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:43.946+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:43.946+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:43.946+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:43.946+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:43.946+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:43.946+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:43.946+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:43.946+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:43.946+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:43.946+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:43.947+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:43.947+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:43.947+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:43.947+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:43.947+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:43.947+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:43.947+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:43.947+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:43.947+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:43.947+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:43.947+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:43.947+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:43.947+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:43.947+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:43.947+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:43.947+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:43.954+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:43.957+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:43.958+01:00  INFO 35740 --- [pool-56-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:43.958+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:43.958+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:43.960+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:43.960+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:43.961+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:43.961+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:43.961+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:43.961+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:43.961+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:43.961+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:43.961+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:43.962+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:43.962+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:43.964+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:43.964+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:43.964+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:43.964+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:43.965+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:43.965+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:43.965+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:43.965+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:43.965+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:43.965+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:43.965+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:43.966+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:44.461+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:44.462+01:00  INFO 35740 --- [pool-57-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:44.462+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:44.463+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:44.463+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:44.463+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:44.463+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:44.463+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:44.463+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:44.463+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:44.463+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:44.463+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:44.463+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:44.463+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:44.463+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:44.463+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:44.463+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:44.463+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:44.463+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:44.463+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:44.463+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:44.463+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:44.463+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:44.463+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:44.463+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:44.463+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:44.463+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:44.464+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:44.469+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:44.474+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:44.474+01:00  INFO 35740 --- [pool-58-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:44.474+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:44.474+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:44.476+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:44.477+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:44.477+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:44.477+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:44.477+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:44.477+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:44.477+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:44.477+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:44.477+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:44.478+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:44.478+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:44.480+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:44.480+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:44.480+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:44.480+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:44.481+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:44.481+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:44.481+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:44.481+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:44.482+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:44.482+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:44.482+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:44.482+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:44.977+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:44.978+01:00  INFO 35740 --- [pool-59-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:44.978+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:44.979+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:44.979+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:44.979+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:44.979+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:44.979+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:44.979+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:44.979+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:44.979+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:44.979+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:44.979+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:44.979+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:44.979+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:44.979+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:44.979+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:44.979+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:44.979+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:44.979+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:44.979+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:44.979+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:44.979+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:44.979+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:44.979+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:44.979+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:44.979+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:44.980+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:44.984+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:44.989+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:44.989+01:00  INFO 35740 --- [pool-60-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:44.989+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:44.989+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:44.992+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:44.992+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:44.992+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:44.992+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:44.992+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:44.992+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:44.992+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:44.993+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:44.993+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:44.993+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:44.993+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:44.995+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:44.996+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:44.996+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:44.996+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:44.996+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:44.996+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:44.996+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:44.996+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:44.997+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:44.997+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:44.997+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:44.997+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:45.492+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:45.494+01:00  INFO 35740 --- [pool-61-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:45.494+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:45.494+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:45.494+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:45.495+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:45.495+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:45.495+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:45.495+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:45.495+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:45.495+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:45.495+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:45.495+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:45.495+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:45.495+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:45.495+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:45.495+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:45.495+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:45.495+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:45.495+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:45.495+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:45.495+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:45.495+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:45.495+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:45.495+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:45.495+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:45.495+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:45.495+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:45.499+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:45.502+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:45.502+01:00  INFO 35740 --- [pool-62-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:45.502+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:45.503+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:45.506+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:45.506+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:45.506+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:45.506+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:45.506+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:45.506+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:45.507+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:45.507+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:45.507+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:45.508+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:45.508+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:45.510+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:45.510+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:45.510+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:45.510+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:45.511+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:45.511+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:45.511+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:45.511+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:45.511+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:45.511+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:45.511+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:45.511+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:46.006+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:46.008+01:00  INFO 35740 --- [pool-63-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:46.008+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:46.008+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:46.008+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:46.008+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:46.008+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:46.008+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:46.008+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:46.008+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:46.008+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:46.008+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:46.008+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:46.008+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:46.008+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:46.008+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:46.008+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:46.008+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:46.008+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:46.008+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:46.008+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:46.008+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:46.008+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:46.008+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:46.008+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:46.009+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:46.009+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:46.009+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:46.014+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:46.016+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:46.017+01:00  INFO 35740 --- [pool-64-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:46.017+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:46.017+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:46.019+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:46.019+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:46.020+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:46.020+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:46.020+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:46.020+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:46.020+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:46.020+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:46.020+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:46.021+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:46.021+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:46.023+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:46.024+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:46.024+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:46.024+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:46.024+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:46.024+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:46.024+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:46.025+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:46.025+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:46.025+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:46.025+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:46.025+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:46.519+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:46.521+01:00  INFO 35740 --- [pool-65-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:46.522+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:46.522+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:46.522+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:46.522+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:46.523+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:46.523+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:46.523+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:46.523+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:46.523+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:46.523+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:46.523+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:46.523+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:46.523+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:46.523+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:46.523+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:46.523+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:46.523+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:46.523+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:46.523+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:46.523+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:46.523+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:46.523+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:46.523+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:46.523+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:46.523+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:46.523+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:46.528+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:46.530+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:46.530+01:00  INFO 35740 --- [pool-66-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:46.530+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:46.530+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:46.532+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:46.532+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:46.533+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:46.533+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:46.533+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:46.533+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:46.533+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:46.533+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:46.533+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:46.534+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:46.534+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:46.537+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:46.537+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:46.537+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:46.537+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:46.538+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:46.538+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:46.538+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:46.538+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:46.538+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:46.539+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:46.539+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:46.539+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:47.032+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:47.033+01:00  INFO 35740 --- [pool-67-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:47.034+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:47.034+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:47.034+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:47.034+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:47.034+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:47.034+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:47.034+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:47.034+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:47.034+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:47.034+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:47.034+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:47.034+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:47.034+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:47.034+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:47.034+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:47.034+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:47.034+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:47.035+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:47.035+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:47.035+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:47.035+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:47.035+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:47.035+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:47.035+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:47.035+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:47.035+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:47.041+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:47.045+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:47.045+01:00  INFO 35740 --- [pool-68-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:47.045+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:47.045+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:47.047+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:47.047+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:47.048+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:47.048+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:47.048+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:47.048+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:47.048+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:47.048+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:47.048+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:47.049+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:47.049+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:47.051+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:47.051+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:47.051+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:47.051+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:47.051+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:47.052+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:47.052+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:47.052+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:47.052+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:47.052+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:47.052+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:47.052+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:47.548+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:47.549+01:00  INFO 35740 --- [pool-69-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:47.552+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:47.553+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:47.553+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:47.553+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:47.553+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:47.553+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:47.553+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:47.553+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:47.553+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:47.553+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:47.553+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:47.553+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:47.553+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:47.553+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:47.553+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:47.553+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:47.553+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:47.553+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:47.553+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:47.553+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:47.553+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:47.553+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:47.553+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:47.553+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:47.553+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:47.554+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:47.560+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:47.564+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:47.564+01:00  INFO 35740 --- [pool-70-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:47.564+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:47.564+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:47.566+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:47.567+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:47.567+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:47.567+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:47.567+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:47.567+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:47.567+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:47.567+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:47.567+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:47.568+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:47.568+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:47.570+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:47.570+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:47.570+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:47.570+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:47.570+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:47.571+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:47.571+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:47.571+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:47.571+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:47.572+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:47.572+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:47.572+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:48.067+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:48.068+01:00  INFO 35740 --- [pool-71-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:48.069+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:48.069+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:48.069+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:48.069+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:48.069+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:48.069+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:48.069+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:48.069+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:48.069+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:48.069+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:48.069+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:48.069+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:48.069+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:48.069+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:48.069+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:48.069+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:48.069+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:48.070+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:48.070+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:48.070+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:48.070+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:48.070+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:48.070+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:48.070+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:48.070+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:48.070+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:48.077+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:48.080+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:48.081+01:00  INFO 35740 --- [pool-72-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:48.081+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:48.081+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:48.084+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:48.084+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:48.084+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:48.084+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:48.084+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:48.084+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:48.084+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:48.084+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:48.084+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:48.085+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:48.085+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:48.087+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:48.087+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:48.087+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:48.087+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:48.088+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:48.088+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:48.088+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:48.088+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:48.088+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:48.089+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:48.089+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:48.089+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:48.584+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:48.585+01:00  INFO 35740 --- [pool-73-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:48.585+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:48.586+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:48.586+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:48.586+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:48.586+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:48.586+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:48.586+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:48.586+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:48.586+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:48.586+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:48.586+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:48.586+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:48.586+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:48.586+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:48.586+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:48.586+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:48.586+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:48.586+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:48.586+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:48.587+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:48.587+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:48.587+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:48.587+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:48.587+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:48.587+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:48.587+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:48.593+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:48.596+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:48.597+01:00  INFO 35740 --- [pool-74-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:48.597+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:48.597+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:48.600+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:48.600+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:48.600+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:48.600+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:48.600+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:48.601+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:48.601+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:48.601+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:48.601+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:48.602+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:48.602+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:48.605+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:48.605+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:48.605+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:48.605+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:48.605+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:48.606+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:48.606+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:48.606+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:48.606+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:48.606+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:48.606+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:48.606+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:49.100+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:49.101+01:00  INFO 35740 --- [pool-75-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:49.102+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:49.102+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:49.102+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:49.102+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:49.102+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:49.102+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:49.102+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:49.102+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:49.102+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:49.102+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:49.102+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:49.102+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:49.102+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:49.102+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:49.102+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:49.102+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:49.102+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:49.102+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:49.102+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:49.102+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:49.102+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:49.103+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:49.103+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:49.103+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:49.103+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:49.103+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:49.110+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:49.113+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:49.113+01:00  INFO 35740 --- [pool-76-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:49.114+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:49.114+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:49.117+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:49.117+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:49.117+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:49.117+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:49.117+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:49.117+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:49.117+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:49.118+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:49.118+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:49.119+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:49.119+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:49.121+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:49.121+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:49.121+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:49.121+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:49.122+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:49.122+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:49.122+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:49.122+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:49.122+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:49.123+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:49.123+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:49.123+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:49.617+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:49.619+01:00  INFO 35740 --- [pool-77-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:49.619+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:49.619+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:49.619+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:49.620+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:49.620+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:49.620+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:49.620+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:49.620+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:49.620+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:49.620+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:49.620+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:49.620+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:49.620+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:49.620+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:49.620+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:49.620+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:49.620+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:49.620+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:49.620+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:49.620+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:49.620+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:49.620+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:49.620+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:49.620+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:49.620+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:49.620+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:49.624+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:49.627+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:49.628+01:00  INFO 35740 --- [pool-78-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:49.628+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:49.629+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:49.631+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:49.631+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:49.631+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:49.631+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:49.631+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:49.631+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:49.631+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:49.632+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:49.632+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:49.633+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:49.633+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:49.635+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:49.635+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:49.635+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:49.635+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:49.635+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:49.636+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:49.636+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:49.636+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:49.636+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:49.636+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:49.636+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:49.636+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:50.131+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:50.132+01:00  INFO 35740 --- [pool-79-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:50.133+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:50.133+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:50.133+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:50.133+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:50.133+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:50.134+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:50.134+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:50.134+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:50.134+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:50.134+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:50.134+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:50.134+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:50.134+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:50.134+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:50.134+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:50.134+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:50.134+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:50.134+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:50.134+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:50.134+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:50.134+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:50.134+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:50.134+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:50.134+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:50.134+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:50.134+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:50.140+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:50.144+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:50.145+01:00  INFO 35740 --- [pool-80-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:50.145+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:50.145+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:50.148+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:50.148+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:50.148+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:50.148+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:50.148+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:50.148+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:50.148+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:50.148+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:50.148+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:50.149+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:50.149+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:50.152+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:50.152+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:50.152+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:50.152+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:50.153+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:50.153+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:50.153+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:50.153+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:50.153+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:50.153+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:50.153+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:50.153+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:50.648+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:50.650+01:00  INFO 35740 --- [pool-81-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:50.650+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:50.650+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:50.650+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:50.650+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:50.650+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:50.650+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:50.650+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:50.650+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:50.650+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:50.650+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:50.650+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:50.650+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:50.650+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:50.650+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:50.650+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:50.650+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:50.650+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:50.650+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:50.650+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:50.650+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:50.650+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:50.650+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:50.650+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:50.650+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:50.650+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:50.651+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:50.656+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:50.660+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:50.660+01:00  INFO 35740 --- [pool-82-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:50.660+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:50.661+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:50.663+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:50.663+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:50.663+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:50.663+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:50.663+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:50.663+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:50.663+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:50.664+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:50.664+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:50.664+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:50.664+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:50.667+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:50.667+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:50.667+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:50.667+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:50.667+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:50.668+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:50.668+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:50.668+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:50.668+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:50.668+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:50.668+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:50.668+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:51.117+01:00  INFO 35740 --- [SpringApplicationShutdownHook] io.debezium.embedded.EmbeddedEngine      : Stopping the embedded engine
2022-11-02T08:12:51.118+01:00  INFO 35740 --- [SpringApplicationShutdownHook] io.debezium.embedded.EmbeddedEngine      : Waiting for PT5M for connector to stop
2022-11-02T08:12:51.163+01:00  WARN 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:12:51.164+01:00  INFO 35740 --- [pool-83-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:51.164+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:51.165+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:12:51.165+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:12:51.165+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:12:51.165+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:12:51.165+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:12:51.165+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:12:51.165+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:12:51.165+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:12:51.165+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:12:51.165+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:12:51.165+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:12:51.165+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:12:51.165+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9725227051002718595.dat
2022-11-02T08:12:51.165+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:12:51.165+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:12:51.165+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:12:51.165+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_8685484369126976251.dat
2022-11-02T08:12:51.165+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:12:51.165+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:12:51.165+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:12:51.165+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:12:51.165+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:12:51.165+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:51.165+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:12:51.166+01:00  INFO 35740 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:12:51.171+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:12:51.174+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:12:51.175+01:00  INFO 35740 --- [pool-84-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:51.175+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:12:51.175+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:12:51.177+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:12:51.177+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:12:51.177+01:00  INFO 35740 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Stopping the task and engine
2022-11-02T08:12:51.177+01:00  INFO 35740 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Stopping down connector
2022-11-02T08:12:51.178+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:12:51.178+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:12:51.178+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:12:51.178+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:12:51.178+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:12:51.178+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:12:51.178+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:12:51.179+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:12:51.179+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:12:51.181+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:12:51.181+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:12:51.181+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:12:51.181+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:12:51.182+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:12:51.182+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:12:51.182+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:12:51.182+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:12:51.183+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:12:51.183+01:00  INFO 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:12:51.183+01:00  WARN 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:12:51.183+01:00 ERROR 35740 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:12:51.184+01:00  INFO 35740 --- [pool-85-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:12:51.185+01:00  INFO 35740 --- [pool-1-thread-1] o.a.k.c.storage.FileOffsetBackingStore   : Stopped FileOffsetBackingStore
2022-11-02T08:12:51.185+01:00  INFO 35740 --- [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2022-11-02T08:12:51.186+01:00  INFO 35740 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-11-02T08:12:51.190+01:00  INFO 35740 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-11-02T08:28:02.663+01:00  INFO 40828 --- [main] c.example.demo.AuditLogTestApplication   : Starting AuditLogTestApplication using Java 17.0.4.1 with PID 40828 (/home/schmitz/dev/security/audit_test/target/classes started by schmitz in /home/schmitz/dev/security/audit_test)
2022-11-02T08:28:02.665+01:00  INFO 40828 --- [main] c.example.demo.AuditLogTestApplication   : No active profile set, falling back to 1 default profile: "default"
2022-11-02T08:28:03.153+01:00  INFO 40828 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-11-02T08:28:03.204+01:00  INFO 40828 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 42 ms. Found 1 JPA repository interfaces.
2022-11-02T08:28:03.595+01:00  INFO 40828 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
2022-11-02T08:28:03.603+01:00  INFO 40828 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-11-02T08:28:03.604+01:00  INFO 40828 --- [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.0.27]
2022-11-02T08:28:03.697+01:00  INFO 40828 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-11-02T08:28:03.698+01:00  INFO 40828 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 996 ms
2022-11-02T08:28:03.843+01:00  INFO 40828 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-11-02T08:28:03.880+01:00  INFO 40828 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.1.5.Final
2022-11-02T08:28:03.998+01:00  WARN 40828 --- [main] org.hibernate.orm.deprecation            : HHH90000021: Encountered deprecated setting [javax.persistence.sharedCache.mode], use [jakarta.persistence.sharedCache.mode] instead
2022-11-02T08:28:04.077+01:00  INFO 40828 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-11-02T08:28:04.345+01:00  INFO 40828 --- [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@2c2a7d53
2022-11-02T08:28:04.346+01:00  INFO 40828 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-11-02T08:28:04.391+01:00  INFO 40828 --- [main] SQL dialect                              : HHH000400: Using dialect: org.hibernate.dialect.MySQLDialect
2022-11-02T08:28:04.872+01:00  INFO 40828 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-11-02T08:28:04.878+01:00  INFO 40828 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-11-02T08:28:04.923+01:00  INFO 40828 --- [main] o.a.k.connect.json.JsonConverterConfig   : JsonConverterConfig values: 
	converter.type = key
	decimal.format = BASE64
	schemas.cache.size = 1000
	schemas.enable = false

2022-11-02T08:28:04.925+01:00  INFO 40828 --- [main] o.a.k.connect.json.JsonConverterConfig   : JsonConverterConfig values: 
	converter.type = value
	decimal.format = BASE64
	schemas.cache.size = 1000
	schemas.enable = false

2022-11-02T08:28:04.930+01:00  INFO 40828 --- [main] i.d.e.EmbeddedEngine$EmbeddedConfig      : EmbeddedConfig values: 
	access.control.allow.methods = 
	access.control.allow.origin = 
	admin.listeners = null
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	config.providers = []
	connector.client.config.override.policy = All
	header.converter = class org.apache.kafka.connect.storage.SimpleHeaderConverter
	key.converter = class org.apache.kafka.connect.json.JsonConverter
	listeners = [http://:8083]
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	offset.flush.interval.ms = 60000
	offset.flush.timeout.ms = 5000
	offset.storage.file.filename = /tmp/offsets_1180040358548378627.dat
	offset.storage.partitions = null
	offset.storage.replication.factor = null
	offset.storage.topic = 
	plugin.path = null
	response.http.headers.config = 
	rest.advertised.host.name = null
	rest.advertised.listener = null
	rest.advertised.port = null
	rest.extension.classes = []
	ssl.cipher.suites = null
	ssl.client.auth = none
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	task.shutdown.graceful.timeout.ms = 5000
	topic.creation.enable = true
	topic.tracking.allow.reset = true
	topic.tracking.enable = true
	value.converter = class org.apache.kafka.connect.json.JsonConverter

2022-11-02T08:28:04.931+01:00  WARN 40828 --- [main] o.a.kafka.connect.runtime.WorkerConfig   : Variables cannot be used in the 'plugin.path' property, since the property is used by plugin scanning before the config providers that replace the variables are initialized. The raw value 'null' was used for plugin scanning, as opposed to the transformed value 'null', and this may cause unexpected results.
2022-11-02T08:28:04.936+01:00  INFO 40828 --- [pool-1-thread-1] o.a.k.c.storage.FileOffsetBackingStore   : Starting FileOffsetBackingStore with file /tmp/offsets_1180040358548378627.dat
2022-11-02T08:28:04.978+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:28:04.979+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:28:04.979+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:28:04.979+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:28:04.979+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:28:04.979+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:28:04.979+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:28:04.979+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:28:04.979+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:28:04.979+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:28:04.979+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_7182882803568758390.dat
2022-11-02T08:28:04.979+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:28:04.979+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:28:04.980+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:28:04.980+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_1180040358548378627.dat
2022-11-02T08:28:04.980+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:28:04.980+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:28:04.980+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:28:04.980+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:28:04.980+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:28:04.981+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:28:04.981+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:28:05.016+01:00  INFO 40828 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:28:05.064+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:28:05.132+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:28:05.134+01:00  INFO 40828 --- [pool-2-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:28:05.135+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:28:05.136+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:28:05.173+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:28:05.175+01:00  WARN 40828 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-11-02T08:28:05.176+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:28:05.179+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:28:05.180+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:28:05.186+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:28:05.186+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:28:05.186+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:28:05.187+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:28:05.188+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:28:05.190+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:28:05.191+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:28:05.207+01:00  WARN 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:28:05.207+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:28:05.208+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:28:05.209+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:28:05.211+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:28:05.212+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:28:05.212+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:28:05.212+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:28:05.214+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:28:05.216+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:28:05.216+01:00  WARN 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:28:05.216+01:00 ERROR 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:28:05.502+01:00  INFO 40828 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
2022-11-02T08:28:05.511+01:00  INFO 40828 --- [main] c.example.demo.AuditLogTestApplication   : Started AuditLogTestApplication in 3.145 seconds (process running for 3.573)
2022-11-02T08:28:05.678+01:00  WARN 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:28:05.680+01:00  INFO 40828 --- [pool-3-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:28:05.681+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:28:05.682+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:28:05.682+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:28:05.682+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:28:05.683+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:28:05.683+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:28:05.683+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:28:05.683+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:28:05.683+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:28:05.683+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:28:05.683+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:28:05.683+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:28:05.683+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:28:05.683+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_7182882803568758390.dat
2022-11-02T08:28:05.683+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:28:05.683+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:28:05.683+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:28:05.683+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_1180040358548378627.dat
2022-11-02T08:28:05.683+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:28:05.683+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:28:05.683+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:28:05.683+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:28:05.683+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:28:05.683+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:28:05.683+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:28:05.684+01:00  INFO 40828 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:28:05.692+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:28:05.699+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:28:05.700+01:00  INFO 40828 --- [pool-4-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:28:05.700+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:28:05.700+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:28:05.704+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:28:05.704+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:28:05.704+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:28:05.705+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:28:05.705+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:28:05.705+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:28:05.705+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:28:05.705+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:28:05.705+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:28:05.707+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:28:05.707+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:28:05.710+01:00  WARN 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:28:05.710+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:28:05.710+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:28:05.710+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:28:05.711+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:28:05.711+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:28:05.712+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:28:05.712+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:28:05.712+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:28:05.713+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:28:05.713+01:00  WARN 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:28:05.713+01:00 ERROR 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:28:06.205+01:00  WARN 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:28:06.207+01:00  INFO 40828 --- [pool-5-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:28:06.207+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:28:06.208+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:28:06.208+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:28:06.208+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:28:06.209+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:28:06.209+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:28:06.209+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:28:06.209+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:28:06.209+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:28:06.209+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:28:06.209+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:28:06.209+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:28:06.209+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:28:06.209+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_7182882803568758390.dat
2022-11-02T08:28:06.209+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:28:06.209+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:28:06.209+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:28:06.209+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_1180040358548378627.dat
2022-11-02T08:28:06.209+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:28:06.209+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:28:06.209+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:28:06.209+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:28:06.209+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:28:06.209+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:28:06.209+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:28:06.210+01:00  INFO 40828 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:28:06.218+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:28:06.224+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:28:06.225+01:00  INFO 40828 --- [pool-6-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:28:06.225+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:28:06.226+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:28:06.229+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:28:06.230+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:28:06.230+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:28:06.231+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:28:06.231+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:28:06.231+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:28:06.231+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:28:06.231+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:28:06.231+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:28:06.232+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:28:06.232+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:28:06.234+01:00  WARN 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:28:06.234+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:28:06.234+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:28:06.234+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:28:06.235+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:28:06.235+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:28:06.236+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:28:06.236+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:28:06.236+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:28:06.236+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:28:06.236+01:00  WARN 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:28:06.236+01:00 ERROR 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:28:06.731+01:00  WARN 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:28:06.733+01:00  INFO 40828 --- [pool-7-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:28:06.733+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:28:06.734+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:28:06.734+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:28:06.735+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:28:06.735+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:28:06.735+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:28:06.735+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:28:06.735+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:28:06.735+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:28:06.735+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:28:06.735+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:28:06.735+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:28:06.735+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:28:06.735+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_7182882803568758390.dat
2022-11-02T08:28:06.735+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:28:06.735+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:28:06.735+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:28:06.735+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_1180040358548378627.dat
2022-11-02T08:28:06.735+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:28:06.735+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:28:06.735+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:28:06.735+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:28:06.735+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:28:06.735+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:28:06.736+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:28:06.736+01:00  INFO 40828 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:28:06.745+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:28:06.751+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:28:06.752+01:00  INFO 40828 --- [pool-8-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:28:06.752+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:28:06.752+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:28:06.755+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:28:06.755+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:28:06.756+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:28:06.756+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:28:06.756+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:28:06.756+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:28:06.756+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:28:06.757+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:28:06.757+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:28:06.758+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:28:06.758+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:28:06.761+01:00  WARN 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:28:06.761+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:28:06.761+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:28:06.761+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:28:06.762+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:28:06.762+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:28:06.762+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:28:06.762+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:28:06.763+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:28:06.763+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:28:06.763+01:00  WARN 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:28:06.763+01:00 ERROR 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:28:07.256+01:00  WARN 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:28:07.258+01:00  INFO 40828 --- [pool-9-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:28:07.259+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:28:07.259+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:28:07.259+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:28:07.260+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:28:07.260+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:28:07.260+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:28:07.260+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:28:07.260+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:28:07.260+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:28:07.261+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:28:07.261+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:28:07.261+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:28:07.261+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:28:07.261+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_7182882803568758390.dat
2022-11-02T08:28:07.261+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:28:07.261+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:28:07.261+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:28:07.261+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_1180040358548378627.dat
2022-11-02T08:28:07.261+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:28:07.261+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:28:07.261+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:28:07.261+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:28:07.261+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:28:07.261+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:28:07.261+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:28:07.262+01:00  INFO 40828 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:28:07.271+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:28:07.277+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:28:07.278+01:00  INFO 40828 --- [pool-10-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:28:07.279+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:28:07.279+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:28:07.282+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:28:07.283+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:28:07.283+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:28:07.283+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:28:07.283+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:28:07.283+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:28:07.283+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:28:07.283+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:28:07.283+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:28:07.285+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:28:07.285+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:28:07.288+01:00  WARN 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:28:07.288+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:28:07.288+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:28:07.288+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:28:07.289+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:28:07.289+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:28:07.289+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:28:07.289+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:28:07.290+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:28:07.291+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:28:07.291+01:00  WARN 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:28:07.291+01:00 ERROR 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:28:07.783+01:00  WARN 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:28:07.785+01:00  INFO 40828 --- [pool-11-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:28:07.788+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:28:07.789+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:28:07.789+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:28:07.790+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:28:07.790+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:28:07.790+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:28:07.790+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:28:07.790+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:28:07.790+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:28:07.790+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:28:07.790+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:28:07.790+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:28:07.790+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:28:07.790+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_7182882803568758390.dat
2022-11-02T08:28:07.790+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:28:07.790+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:28:07.790+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:28:07.790+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_1180040358548378627.dat
2022-11-02T08:28:07.790+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:28:07.790+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:28:07.790+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:28:07.790+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:28:07.790+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:28:07.790+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:28:07.790+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:28:07.791+01:00  INFO 40828 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:28:07.799+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:28:07.803+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:28:07.804+01:00  INFO 40828 --- [pool-12-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:28:07.804+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:28:07.804+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:28:07.807+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:28:07.807+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:28:07.808+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:28:07.808+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:28:07.808+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:28:07.808+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:28:07.808+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:28:07.809+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:28:07.809+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:28:07.811+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:28:07.811+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:28:07.814+01:00  WARN 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:28:07.814+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:28:07.815+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:28:07.815+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:28:07.815+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:28:07.816+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:28:07.816+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:28:07.816+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:28:07.817+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:28:07.817+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:28:07.817+01:00  WARN 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:28:07.817+01:00 ERROR 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:28:08.308+01:00  WARN 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:28:08.310+01:00  INFO 40828 --- [pool-13-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:28:08.310+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:28:08.311+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:28:08.311+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:28:08.311+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:28:08.311+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:28:08.311+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:28:08.311+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:28:08.311+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:28:08.311+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:28:08.311+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:28:08.311+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:28:08.312+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:28:08.312+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:28:08.312+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_7182882803568758390.dat
2022-11-02T08:28:08.312+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:28:08.312+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:28:08.312+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:28:08.312+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_1180040358548378627.dat
2022-11-02T08:28:08.312+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:28:08.312+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:28:08.312+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:28:08.312+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:28:08.312+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:28:08.312+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:28:08.312+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:28:08.313+01:00  INFO 40828 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:28:08.319+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:28:08.332+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:28:08.333+01:00  INFO 40828 --- [pool-14-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:28:08.333+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:28:08.333+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:28:08.336+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:28:08.336+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:28:08.337+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:28:08.337+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:28:08.338+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:28:08.338+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:28:08.338+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:28:08.338+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:28:08.338+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:28:08.340+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:28:08.340+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:28:08.343+01:00  WARN 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:28:08.343+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:28:08.343+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:28:08.343+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:28:08.343+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:28:08.343+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:28:08.344+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:28:08.344+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:28:08.344+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:28:08.344+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:28:08.344+01:00  WARN 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:28:08.344+01:00 ERROR 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:28:08.837+01:00  WARN 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:28:08.839+01:00  INFO 40828 --- [pool-15-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:28:08.839+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:28:08.840+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:28:08.840+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:28:08.840+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:28:08.841+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:28:08.841+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:28:08.841+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:28:08.841+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:28:08.841+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:28:08.841+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:28:08.841+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:28:08.841+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:28:08.841+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:28:08.841+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_7182882803568758390.dat
2022-11-02T08:28:08.841+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:28:08.841+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:28:08.841+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:28:08.842+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_1180040358548378627.dat
2022-11-02T08:28:08.842+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:28:08.842+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:28:08.842+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:28:08.842+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:28:08.842+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:28:08.842+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:28:08.842+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:28:08.843+01:00  INFO 40828 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:28:08.850+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:28:08.858+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:28:08.858+01:00  INFO 40828 --- [pool-16-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:28:08.859+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:28:08.859+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:28:08.863+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:28:08.863+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:28:08.864+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:28:08.864+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:28:08.864+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:28:08.864+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:28:08.864+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:28:08.864+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:28:08.864+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:28:08.865+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:28:08.866+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:28:08.870+01:00  WARN 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:28:08.870+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:28:08.871+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:28:08.871+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:28:08.871+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:28:08.872+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:28:08.872+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:28:08.872+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:28:08.872+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:28:08.873+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:28:08.873+01:00  WARN 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:28:08.873+01:00 ERROR 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:28:09.364+01:00  WARN 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:28:09.366+01:00  INFO 40828 --- [pool-17-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:28:09.366+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:28:09.366+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:28:09.367+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:28:09.367+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:28:09.367+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:28:09.367+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:28:09.367+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:28:09.367+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:28:09.367+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:28:09.367+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:28:09.367+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:28:09.367+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:28:09.367+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:28:09.367+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_7182882803568758390.dat
2022-11-02T08:28:09.367+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:28:09.367+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:28:09.367+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:28:09.367+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_1180040358548378627.dat
2022-11-02T08:28:09.367+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:28:09.367+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:28:09.367+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:28:09.367+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:28:09.367+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:28:09.367+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:28:09.367+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:28:09.368+01:00  INFO 40828 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:28:09.374+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:28:09.378+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:28:09.379+01:00  INFO 40828 --- [pool-18-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:28:09.379+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:28:09.379+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:28:09.382+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:28:09.382+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:28:09.382+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:28:09.382+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:28:09.382+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:28:09.382+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:28:09.382+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:28:09.383+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:28:09.383+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:28:09.384+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:28:09.384+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:28:09.387+01:00  WARN 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:28:09.387+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:28:09.387+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:28:09.387+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:28:09.388+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:28:09.388+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:28:09.389+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:28:09.389+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:28:09.389+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:28:09.389+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:28:09.389+01:00  WARN 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:28:09.389+01:00 ERROR 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:28:09.882+01:00  WARN 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:28:09.884+01:00  INFO 40828 --- [pool-19-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:28:09.885+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:28:09.885+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:28:09.885+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:28:09.886+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:28:09.886+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:28:09.886+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:28:09.886+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:28:09.886+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:28:09.886+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:28:09.886+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:28:09.886+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:28:09.886+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:28:09.886+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:28:09.886+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_7182882803568758390.dat
2022-11-02T08:28:09.886+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:28:09.886+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:28:09.886+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:28:09.886+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_1180040358548378627.dat
2022-11-02T08:28:09.886+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:28:09.886+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:28:09.886+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:28:09.886+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:28:09.886+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:28:09.886+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:28:09.886+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:28:09.887+01:00  INFO 40828 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:28:09.893+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:28:09.897+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:28:09.897+01:00  INFO 40828 --- [pool-20-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:28:09.897+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:28:09.897+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:28:09.900+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:28:09.900+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:28:09.900+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:28:09.901+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:28:09.901+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:28:09.901+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:28:09.901+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:28:09.901+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:28:09.901+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:28:09.902+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:28:09.903+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:28:09.907+01:00  WARN 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:28:09.907+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:28:09.907+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:28:09.907+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:28:09.908+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:28:09.909+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:28:09.909+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:28:09.909+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:28:09.909+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:28:09.910+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:28:09.910+01:00  WARN 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:28:09.910+01:00 ERROR 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:28:10.400+01:00  WARN 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:28:10.402+01:00  INFO 40828 --- [pool-21-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:28:10.402+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:28:10.403+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:28:10.403+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:28:10.404+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:28:10.404+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:28:10.404+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:28:10.404+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:28:10.404+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:28:10.404+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:28:10.404+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:28:10.404+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:28:10.404+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:28:10.404+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:28:10.404+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_7182882803568758390.dat
2022-11-02T08:28:10.404+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:28:10.404+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:28:10.404+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:28:10.404+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_1180040358548378627.dat
2022-11-02T08:28:10.404+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:28:10.404+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:28:10.404+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:28:10.404+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:28:10.404+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:28:10.404+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:28:10.404+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:28:10.405+01:00  INFO 40828 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:28:10.411+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:28:10.416+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:28:10.417+01:00  INFO 40828 --- [pool-22-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:28:10.417+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:28:10.417+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:28:10.420+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:28:10.420+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:28:10.420+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:28:10.420+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:28:10.420+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:28:10.420+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:28:10.420+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:28:10.420+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:28:10.421+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:28:10.422+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:28:10.422+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:28:10.425+01:00  WARN 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:28:10.425+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:28:10.425+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:28:10.425+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:28:10.426+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:28:10.426+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:28:10.426+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:28:10.426+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:28:10.427+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:28:10.427+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:28:10.427+01:00  WARN 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:28:10.427+01:00 ERROR 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:28:10.920+01:00  WARN 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:28:10.922+01:00  INFO 40828 --- [pool-23-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:28:10.922+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:28:10.923+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:28:10.923+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:28:10.923+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:28:10.924+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:28:10.924+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:28:10.924+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:28:10.924+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:28:10.924+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:28:10.924+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:28:10.924+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:28:10.924+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:28:10.924+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:28:10.924+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_7182882803568758390.dat
2022-11-02T08:28:10.924+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:28:10.924+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:28:10.924+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:28:10.924+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_1180040358548378627.dat
2022-11-02T08:28:10.924+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:28:10.924+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:28:10.924+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:28:10.924+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:28:10.924+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:28:10.924+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:28:10.924+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:28:10.925+01:00  INFO 40828 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:28:10.932+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:28:10.936+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:28:10.937+01:00  INFO 40828 --- [pool-24-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:28:10.937+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:28:10.937+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:28:10.940+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:28:10.941+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:28:10.941+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:28:10.941+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:28:10.941+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:28:10.941+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:28:10.941+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:28:10.942+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:28:10.942+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:28:10.943+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:28:10.943+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:28:10.946+01:00  WARN 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:28:10.946+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:28:10.946+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:28:10.946+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:28:10.947+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:28:10.947+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:28:10.947+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:28:10.947+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:28:10.948+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:28:10.948+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:28:10.948+01:00  WARN 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:28:10.948+01:00 ERROR 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:28:11.318+01:00  INFO 40828 --- [SpringApplicationShutdownHook] io.debezium.embedded.EmbeddedEngine      : Stopping the embedded engine
2022-11-02T08:28:11.318+01:00  INFO 40828 --- [SpringApplicationShutdownHook] io.debezium.embedded.EmbeddedEngine      : Waiting for PT5M for connector to stop
2022-11-02T08:28:11.441+01:00  WARN 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:28:11.443+01:00  INFO 40828 --- [pool-25-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:28:11.443+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:28:11.444+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:28:11.444+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:28:11.445+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:28:11.445+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:28:11.445+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:28:11.445+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:28:11.445+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:28:11.445+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:28:11.445+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:28:11.445+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:28:11.445+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:28:11.445+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:28:11.445+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_7182882803568758390.dat
2022-11-02T08:28:11.445+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:28:11.445+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:28:11.445+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:28:11.445+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_1180040358548378627.dat
2022-11-02T08:28:11.445+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:28:11.445+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:28:11.445+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:28:11.445+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:28:11.445+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:28:11.445+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:28:11.445+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:28:11.446+01:00  INFO 40828 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:28:11.454+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:28:11.458+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:28:11.459+01:00  INFO 40828 --- [pool-26-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:28:11.459+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:28:11.459+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:28:11.462+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:28:11.462+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:28:11.463+01:00  INFO 40828 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Stopping the task and engine
2022-11-02T08:28:11.463+01:00  INFO 40828 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Stopping down connector
2022-11-02T08:28:11.463+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:28:11.463+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:28:11.463+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:28:11.463+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:28:11.463+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:28:11.463+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:28:11.463+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:28:11.465+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:28:11.465+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:28:11.467+01:00  WARN 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:28:11.467+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:28:11.467+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:28:11.467+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:28:11.468+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:28:11.468+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:28:11.468+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:28:11.468+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:28:11.469+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:28:11.469+01:00  INFO 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:28:11.469+01:00  WARN 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:28:11.469+01:00 ERROR 40828 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:28:11.470+01:00  INFO 40828 --- [pool-27-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:28:11.471+01:00  INFO 40828 --- [pool-1-thread-1] o.a.k.c.storage.FileOffsetBackingStore   : Stopped FileOffsetBackingStore
2022-11-02T08:28:11.471+01:00  INFO 40828 --- [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2022-11-02T08:28:11.473+01:00  INFO 40828 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-11-02T08:28:11.477+01:00  INFO 40828 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-11-02T08:30:36.793+01:00  INFO 41849 --- [main] c.example.demo.AuditLogTestApplication   : Starting AuditLogTestApplication using Java 17.0.4.1 with PID 41849 (/home/schmitz/dev/security/audit_test/target/classes started by schmitz in /home/schmitz/dev/security/audit_test)
2022-11-02T08:30:36.795+01:00  INFO 41849 --- [main] c.example.demo.AuditLogTestApplication   : No active profile set, falling back to 1 default profile: "default"
2022-11-02T08:30:37.256+01:00  INFO 41849 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-11-02T08:30:37.306+01:00  INFO 41849 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 41 ms. Found 1 JPA repository interfaces.
2022-11-02T08:30:37.661+01:00  INFO 41849 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
2022-11-02T08:30:37.669+01:00  INFO 41849 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-11-02T08:30:37.670+01:00  INFO 41849 --- [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.0.27]
2022-11-02T08:30:37.760+01:00  INFO 41849 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-11-02T08:30:37.761+01:00  INFO 41849 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 933 ms
2022-11-02T08:30:37.877+01:00  INFO 41849 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-11-02T08:30:37.911+01:00  INFO 41849 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.1.5.Final
2022-11-02T08:30:38.015+01:00  WARN 41849 --- [main] org.hibernate.orm.deprecation            : HHH90000021: Encountered deprecated setting [javax.persistence.sharedCache.mode], use [jakarta.persistence.sharedCache.mode] instead
2022-11-02T08:30:38.085+01:00  INFO 41849 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-11-02T08:30:38.342+01:00  INFO 41849 --- [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@3d8d52be
2022-11-02T08:30:38.344+01:00  INFO 41849 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-11-02T08:30:38.377+01:00  INFO 41849 --- [main] SQL dialect                              : HHH000400: Using dialect: org.hibernate.dialect.MySQLDialect
2022-11-02T08:30:38.825+01:00  INFO 41849 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-11-02T08:30:38.831+01:00  INFO 41849 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-11-02T08:30:38.876+01:00  INFO 41849 --- [main] o.a.k.connect.json.JsonConverterConfig   : JsonConverterConfig values: 
	converter.type = key
	decimal.format = BASE64
	schemas.cache.size = 1000
	schemas.enable = false

2022-11-02T08:30:38.878+01:00  INFO 41849 --- [main] o.a.k.connect.json.JsonConverterConfig   : JsonConverterConfig values: 
	converter.type = value
	decimal.format = BASE64
	schemas.cache.size = 1000
	schemas.enable = false

2022-11-02T08:30:38.884+01:00  INFO 41849 --- [main] i.d.e.EmbeddedEngine$EmbeddedConfig      : EmbeddedConfig values: 
	access.control.allow.methods = 
	access.control.allow.origin = 
	admin.listeners = null
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	config.providers = []
	connector.client.config.override.policy = All
	header.converter = class org.apache.kafka.connect.storage.SimpleHeaderConverter
	key.converter = class org.apache.kafka.connect.json.JsonConverter
	listeners = [http://:8083]
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	offset.flush.interval.ms = 60000
	offset.flush.timeout.ms = 5000
	offset.storage.file.filename = /tmp/offsets_12834694799747246179.dat
	offset.storage.partitions = null
	offset.storage.replication.factor = null
	offset.storage.topic = 
	plugin.path = null
	response.http.headers.config = 
	rest.advertised.host.name = null
	rest.advertised.listener = null
	rest.advertised.port = null
	rest.extension.classes = []
	ssl.cipher.suites = null
	ssl.client.auth = none
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	task.shutdown.graceful.timeout.ms = 5000
	topic.creation.enable = true
	topic.tracking.allow.reset = true
	topic.tracking.enable = true
	value.converter = class org.apache.kafka.connect.json.JsonConverter

2022-11-02T08:30:38.885+01:00  WARN 41849 --- [main] o.a.kafka.connect.runtime.WorkerConfig   : Variables cannot be used in the 'plugin.path' property, since the property is used by plugin scanning before the config providers that replace the variables are initialized. The raw value 'null' was used for plugin scanning, as opposed to the transformed value 'null', and this may cause unexpected results.
2022-11-02T08:30:38.890+01:00  INFO 41849 --- [pool-1-thread-1] o.a.k.c.storage.FileOffsetBackingStore   : Starting FileOffsetBackingStore with file /tmp/offsets_12834694799747246179.dat
2022-11-02T08:30:38.939+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:30:38.940+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:30:38.940+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:30:38.940+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:30:38.940+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:30:38.940+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:30:38.941+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:30:38.941+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:30:38.941+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:30:38.941+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:30:38.941+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_11459419229921683401.dat
2022-11-02T08:30:38.941+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:30:38.941+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:30:38.941+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:30:38.942+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_12834694799747246179.dat
2022-11-02T08:30:38.942+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:30:38.942+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:30:38.942+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:30:38.942+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:30:38.942+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:30:38.943+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:30:38.943+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:30:38.970+01:00  INFO 41849 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:30:39.022+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:30:39.089+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:30:39.091+01:00  INFO 41849 --- [pool-2-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:30:39.092+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:30:39.092+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:30:39.129+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:30:39.133+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:30:39.136+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:30:39.137+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:30:39.143+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:30:39.143+01:00  WARN 41849 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-11-02T08:30:39.143+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:30:39.144+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:30:39.144+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:30:39.145+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:30:39.147+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:30:39.147+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:30:39.164+01:00  WARN 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:30:39.166+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:30:39.167+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:30:39.168+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:30:39.170+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:30:39.171+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:30:39.172+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:30:39.172+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:30:39.173+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:30:39.176+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:30:39.176+01:00  WARN 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:30:39.176+01:00 ERROR 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:30:39.514+01:00  INFO 41849 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
2022-11-02T08:30:39.525+01:00  INFO 41849 --- [main] c.example.demo.AuditLogTestApplication   : Started AuditLogTestApplication in 3.028 seconds (process running for 3.442)
2022-11-02T08:30:39.635+01:00  WARN 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:30:39.637+01:00  INFO 41849 --- [pool-3-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:30:39.637+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:30:39.638+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:30:39.638+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:30:39.639+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:30:39.639+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:30:39.639+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:30:39.639+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:30:39.639+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:30:39.639+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:30:39.639+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:30:39.639+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:30:39.639+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:30:39.639+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:30:39.640+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_11459419229921683401.dat
2022-11-02T08:30:39.640+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:30:39.640+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:30:39.640+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:30:39.640+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_12834694799747246179.dat
2022-11-02T08:30:39.640+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:30:39.640+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:30:39.640+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:30:39.640+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:30:39.640+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:30:39.640+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:30:39.640+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:30:39.641+01:00  INFO 41849 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:30:39.647+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:30:39.652+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:30:39.653+01:00  INFO 41849 --- [pool-4-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:30:39.654+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:30:39.654+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:30:39.657+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:30:39.657+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:30:39.658+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:30:39.658+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:30:39.658+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:30:39.658+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:30:39.658+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:30:39.659+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:30:39.659+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:30:39.660+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:30:39.660+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:30:39.663+01:00  WARN 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:30:39.663+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:30:39.663+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:30:39.663+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:30:39.664+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:30:39.664+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:30:39.664+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:30:39.665+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:30:39.665+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:30:39.666+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:30:39.666+01:00  WARN 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:30:39.666+01:00 ERROR 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:30:40.158+01:00  WARN 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:30:40.160+01:00  INFO 41849 --- [pool-5-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:30:40.161+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:30:40.161+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:30:40.162+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:30:40.162+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:30:40.163+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:30:40.163+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:30:40.163+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:30:40.163+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:30:40.163+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:30:40.163+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:30:40.163+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:30:40.163+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:30:40.163+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:30:40.163+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_11459419229921683401.dat
2022-11-02T08:30:40.163+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:30:40.163+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:30:40.163+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:30:40.163+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_12834694799747246179.dat
2022-11-02T08:30:40.163+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:30:40.163+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:30:40.163+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:30:40.163+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:30:40.163+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:30:40.163+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:30:40.163+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:30:40.164+01:00  INFO 41849 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:30:40.171+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:30:40.176+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:30:40.176+01:00  INFO 41849 --- [pool-6-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:30:40.176+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:30:40.176+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:30:40.179+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:30:40.179+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:30:40.180+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:30:40.180+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:30:40.180+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:30:40.180+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:30:40.180+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:30:40.180+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:30:40.180+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:30:40.181+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:30:40.181+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:30:40.183+01:00  WARN 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:30:40.184+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:30:40.184+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:30:40.184+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:30:40.184+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:30:40.185+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:30:40.185+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:30:40.185+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:30:40.185+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:30:40.186+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:30:40.186+01:00  WARN 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:30:40.186+01:00 ERROR 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:30:40.679+01:00  WARN 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:30:40.681+01:00  INFO 41849 --- [pool-7-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:30:40.681+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:30:40.682+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:30:40.682+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:30:40.683+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:30:40.683+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:30:40.683+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:30:40.683+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:30:40.683+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:30:40.683+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:30:40.683+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:30:40.683+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:30:40.683+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:30:40.683+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:30:40.683+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_11459419229921683401.dat
2022-11-02T08:30:40.683+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:30:40.683+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:30:40.683+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:30:40.683+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_12834694799747246179.dat
2022-11-02T08:30:40.683+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:30:40.683+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:30:40.683+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:30:40.683+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:30:40.683+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:30:40.683+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:30:40.683+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:30:40.684+01:00  INFO 41849 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:30:40.690+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:30:40.695+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:30:40.696+01:00  INFO 41849 --- [pool-8-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:30:40.696+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:30:40.697+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:30:40.699+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:30:40.699+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:30:40.700+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:30:40.700+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:30:40.700+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:30:40.700+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:30:40.700+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:30:40.701+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:30:40.701+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:30:40.702+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:30:40.702+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:30:40.704+01:00  WARN 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:30:40.704+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:30:40.704+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:30:40.704+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:30:40.705+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:30:40.705+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:30:40.705+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:30:40.705+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:30:40.705+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:30:40.706+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:30:40.706+01:00  WARN 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:30:40.706+01:00 ERROR 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:30:41.200+01:00  WARN 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:30:41.202+01:00  INFO 41849 --- [pool-9-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:30:41.202+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:30:41.202+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:30:41.202+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:30:41.203+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:30:41.203+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:30:41.203+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:30:41.203+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:30:41.203+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:30:41.203+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:30:41.203+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:30:41.203+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:30:41.203+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:30:41.203+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:30:41.203+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_11459419229921683401.dat
2022-11-02T08:30:41.203+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:30:41.203+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:30:41.203+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:30:41.203+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_12834694799747246179.dat
2022-11-02T08:30:41.203+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:30:41.203+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:30:41.203+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:30:41.203+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:30:41.203+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:30:41.203+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:30:41.203+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:30:41.204+01:00  INFO 41849 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:30:41.209+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:30:41.214+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:30:41.214+01:00  INFO 41849 --- [pool-10-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:30:41.215+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:30:41.215+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:30:41.218+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:30:41.218+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:30:41.219+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:30:41.219+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:30:41.219+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:30:41.219+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:30:41.219+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:30:41.220+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:30:41.220+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:30:41.221+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:30:41.221+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:30:41.223+01:00  WARN 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:30:41.223+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:30:41.223+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:30:41.223+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:30:41.224+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:30:41.224+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:30:41.224+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:30:41.224+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:30:41.225+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:30:41.225+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:30:41.225+01:00  WARN 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:30:41.225+01:00 ERROR 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:30:41.719+01:00  WARN 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:30:41.722+01:00  INFO 41849 --- [pool-11-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:30:41.723+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:30:41.724+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:30:41.724+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:30:41.725+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:30:41.725+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:30:41.725+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:30:41.725+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:30:41.725+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:30:41.725+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:30:41.725+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:30:41.725+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:30:41.725+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:30:41.725+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:30:41.725+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_11459419229921683401.dat
2022-11-02T08:30:41.725+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:30:41.725+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:30:41.725+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:30:41.725+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_12834694799747246179.dat
2022-11-02T08:30:41.725+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:30:41.725+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:30:41.725+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:30:41.725+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:30:41.725+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:30:41.726+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:30:41.726+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:30:41.726+01:00  INFO 41849 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:30:41.735+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:30:41.741+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:30:41.741+01:00  INFO 41849 --- [pool-12-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:30:41.742+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:30:41.742+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:30:41.746+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:30:41.746+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:30:41.747+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:30:41.748+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:30:41.748+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:30:41.748+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:30:41.748+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:30:41.748+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:30:41.748+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:30:41.749+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:30:41.749+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:30:41.752+01:00  WARN 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:30:41.752+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:30:41.752+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:30:41.752+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:30:41.753+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:30:41.753+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:30:41.754+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:30:41.754+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:30:41.754+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:30:41.755+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:30:41.755+01:00  WARN 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:30:41.755+01:00 ERROR 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:30:42.247+01:00  WARN 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:30:42.249+01:00  INFO 41849 --- [pool-13-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:30:42.249+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:30:42.250+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:30:42.250+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:30:42.250+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:30:42.250+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:30:42.250+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:30:42.250+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:30:42.250+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:30:42.250+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:30:42.250+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:30:42.250+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:30:42.250+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:30:42.251+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:30:42.251+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_11459419229921683401.dat
2022-11-02T08:30:42.251+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:30:42.251+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:30:42.251+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:30:42.251+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_12834694799747246179.dat
2022-11-02T08:30:42.251+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:30:42.251+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:30:42.251+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:30:42.251+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:30:42.251+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:30:42.251+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:30:42.251+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:30:42.252+01:00  INFO 41849 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:30:42.258+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:30:42.262+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:30:42.262+01:00  INFO 41849 --- [pool-14-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:30:42.262+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:30:42.262+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:30:42.265+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:30:42.265+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:30:42.266+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:30:42.266+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:30:42.266+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:30:42.266+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:30:42.266+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:30:42.267+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:30:42.267+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:30:42.268+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:30:42.268+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:30:42.271+01:00  WARN 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:30:42.271+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:30:42.271+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:30:42.271+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:30:42.271+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:30:42.272+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:30:42.272+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:30:42.272+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:30:42.272+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:30:42.272+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:30:42.273+01:00  WARN 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:30:42.273+01:00 ERROR 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:30:42.765+01:00  WARN 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:30:42.766+01:00  INFO 41849 --- [pool-15-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:30:42.767+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:30:42.767+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:30:42.767+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:30:42.767+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:30:42.768+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:30:42.768+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:30:42.768+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:30:42.768+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:30:42.768+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:30:42.768+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:30:42.768+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:30:42.768+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:30:42.768+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:30:42.768+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_11459419229921683401.dat
2022-11-02T08:30:42.768+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:30:42.768+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:30:42.768+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:30:42.768+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_12834694799747246179.dat
2022-11-02T08:30:42.768+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:30:42.768+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:30:42.768+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:30:42.768+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:30:42.768+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:30:42.768+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:30:42.768+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:30:42.769+01:00  INFO 41849 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:30:42.776+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:30:42.780+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:30:42.781+01:00  INFO 41849 --- [pool-16-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:30:42.781+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:30:42.781+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:30:42.785+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:30:42.785+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:30:42.785+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:30:42.785+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:30:42.785+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:30:42.785+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:30:42.785+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:30:42.786+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:30:42.786+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:30:42.787+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:30:42.787+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:30:42.789+01:00  WARN 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:30:42.789+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:30:42.789+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:30:42.789+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:30:42.790+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:30:42.790+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:30:42.790+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:30:42.790+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:30:42.791+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:30:42.791+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:30:42.791+01:00  WARN 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:30:42.791+01:00 ERROR 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:30:43.285+01:00  WARN 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:30:43.287+01:00  INFO 41849 --- [pool-17-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:30:43.287+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:30:43.288+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:30:43.288+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:30:43.288+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:30:43.288+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:30:43.288+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:30:43.288+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:30:43.288+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:30:43.288+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:30:43.288+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:30:43.288+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:30:43.288+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:30:43.288+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:30:43.288+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_11459419229921683401.dat
2022-11-02T08:30:43.288+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:30:43.288+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:30:43.288+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:30:43.288+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_12834694799747246179.dat
2022-11-02T08:30:43.288+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:30:43.289+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:30:43.289+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:30:43.289+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:30:43.289+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:30:43.289+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:30:43.289+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:30:43.290+01:00  INFO 41849 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:30:43.296+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:30:43.300+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:30:43.301+01:00  INFO 41849 --- [pool-18-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:30:43.301+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:30:43.301+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:30:43.304+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:30:43.304+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:30:43.304+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:30:43.304+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:30:43.304+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:30:43.304+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:30:43.304+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:30:43.305+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:30:43.305+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:30:43.305+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:30:43.305+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:30:43.307+01:00  WARN 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:30:43.307+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:30:43.307+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:30:43.307+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:30:43.308+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:30:43.308+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:30:43.308+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:30:43.308+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:30:43.309+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:30:43.309+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:30:43.309+01:00  WARN 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:30:43.309+01:00 ERROR 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:30:43.804+01:00  WARN 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:30:43.806+01:00  INFO 41849 --- [pool-19-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:30:43.806+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:30:43.807+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:30:43.807+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:30:43.807+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:30:43.807+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:30:43.808+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:30:43.808+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:30:43.808+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:30:43.808+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:30:43.808+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:30:43.808+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:30:43.808+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:30:43.808+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:30:43.808+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_11459419229921683401.dat
2022-11-02T08:30:43.808+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:30:43.808+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:30:43.808+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:30:43.808+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_12834694799747246179.dat
2022-11-02T08:30:43.808+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:30:43.808+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:30:43.808+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:30:43.808+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:30:43.808+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:30:43.808+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:30:43.808+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:30:43.808+01:00  INFO 41849 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:30:43.815+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:30:43.819+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:30:43.820+01:00  INFO 41849 --- [pool-20-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:30:43.820+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:30:43.820+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:30:43.822+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:30:43.822+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:30:43.823+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:30:43.823+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:30:43.823+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:30:43.823+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:30:43.823+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:30:43.823+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:30:43.823+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:30:43.824+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:30:43.824+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:30:43.827+01:00  WARN 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:30:43.828+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:30:43.828+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:30:43.828+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:30:43.829+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:30:43.829+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:30:43.829+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:30:43.829+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:30:43.830+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:30:43.831+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:30:43.831+01:00  WARN 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:30:43.831+01:00 ERROR 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:30:44.323+01:00  WARN 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:30:44.325+01:00  INFO 41849 --- [pool-21-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:30:44.325+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:30:44.325+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:30:44.325+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:30:44.326+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:30:44.326+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:30:44.326+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:30:44.326+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:30:44.326+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:30:44.326+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:30:44.326+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:30:44.326+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:30:44.326+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:30:44.326+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:30:44.326+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_11459419229921683401.dat
2022-11-02T08:30:44.326+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:30:44.326+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:30:44.326+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:30:44.326+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_12834694799747246179.dat
2022-11-02T08:30:44.326+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:30:44.326+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:30:44.326+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:30:44.326+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:30:44.326+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:30:44.326+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:30:44.326+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:30:44.327+01:00  INFO 41849 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:30:44.333+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:30:44.338+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:30:44.338+01:00  INFO 41849 --- [pool-22-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:30:44.338+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:30:44.338+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:30:44.340+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:30:44.340+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:30:44.341+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:30:44.341+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:30:44.341+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:30:44.341+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:30:44.341+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:30:44.341+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:30:44.341+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:30:44.342+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:30:44.342+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:30:44.345+01:00  WARN 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:30:44.345+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:30:44.345+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:30:44.345+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:30:44.345+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:30:44.346+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:30:44.346+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:30:44.346+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:30:44.346+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:30:44.346+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:30:44.346+01:00  WARN 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:30:44.346+01:00 ERROR 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:30:44.841+01:00  WARN 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:30:44.843+01:00  INFO 41849 --- [pool-23-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:30:44.843+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:30:44.844+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:30:44.844+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:30:44.844+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:30:44.844+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:30:44.844+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:30:44.844+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:30:44.845+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:30:44.845+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:30:44.845+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:30:44.845+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:30:44.845+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:30:44.845+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:30:44.845+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_11459419229921683401.dat
2022-11-02T08:30:44.845+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:30:44.845+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:30:44.845+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:30:44.845+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_12834694799747246179.dat
2022-11-02T08:30:44.845+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:30:44.845+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:30:44.845+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:30:44.845+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:30:44.845+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:30:44.845+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:30:44.845+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:30:44.846+01:00  INFO 41849 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:30:44.852+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:30:44.855+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:30:44.856+01:00  INFO 41849 --- [pool-24-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:30:44.856+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:30:44.856+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:30:44.858+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:30:44.858+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:30:44.858+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:30:44.858+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:30:44.859+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:30:44.859+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:30:44.859+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:30:44.859+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:30:44.859+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:30:44.860+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:30:44.860+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:30:44.862+01:00  WARN 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:30:44.862+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:30:44.862+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:30:44.862+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:30:44.862+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:30:44.863+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:30:44.863+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:30:44.863+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:30:44.863+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:30:44.864+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:30:44.864+01:00  WARN 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:30:44.864+01:00 ERROR 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:30:45.358+01:00  WARN 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:30:45.360+01:00  INFO 41849 --- [pool-25-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:30:45.360+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:30:45.361+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:30:45.361+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:30:45.361+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:30:45.362+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:30:45.362+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:30:45.362+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:30:45.362+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:30:45.362+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:30:45.362+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:30:45.362+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:30:45.362+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:30:45.362+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:30:45.362+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_11459419229921683401.dat
2022-11-02T08:30:45.362+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:30:45.362+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:30:45.362+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:30:45.362+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_12834694799747246179.dat
2022-11-02T08:30:45.362+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:30:45.362+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:30:45.362+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:30:45.362+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:30:45.362+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:30:45.362+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:30:45.362+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:30:45.363+01:00  INFO 41849 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:30:45.371+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:30:45.374+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:30:45.374+01:00  INFO 41849 --- [pool-26-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:30:45.374+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:30:45.374+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:30:45.376+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:30:45.376+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:30:45.377+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:30:45.377+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:30:45.377+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:30:45.377+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:30:45.377+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:30:45.377+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:30:45.377+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:30:45.378+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:30:45.379+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:30:45.381+01:00  WARN 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:30:45.381+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:30:45.381+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:30:45.381+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:30:45.382+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:30:45.382+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:30:45.382+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:30:45.382+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:30:45.383+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:30:45.383+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:30:45.383+01:00  WARN 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:30:45.383+01:00 ERROR 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:30:45.877+01:00  WARN 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:30:45.878+01:00  INFO 41849 --- [pool-27-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:30:45.879+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:30:45.879+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:30:45.879+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:30:45.880+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:30:45.880+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:30:45.880+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:30:45.880+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:30:45.880+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:30:45.880+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:30:45.880+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:30:45.880+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:30:45.880+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:30:45.880+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:30:45.880+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_11459419229921683401.dat
2022-11-02T08:30:45.880+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:30:45.880+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:30:45.880+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:30:45.880+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_12834694799747246179.dat
2022-11-02T08:30:45.880+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:30:45.880+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:30:45.881+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:30:45.881+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:30:45.881+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:30:45.881+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:30:45.881+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:30:45.881+01:00  INFO 41849 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:30:45.888+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:30:45.893+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:30:45.894+01:00  INFO 41849 --- [pool-28-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:30:45.894+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:30:45.894+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:30:45.897+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:30:45.897+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:30:45.898+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:30:45.898+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:30:45.898+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:30:45.898+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:30:45.898+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:30:45.899+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:30:45.899+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:30:45.900+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:30:45.900+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:30:45.903+01:00  WARN 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:30:45.903+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:30:45.903+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:30:45.903+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:30:45.904+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:30:45.904+01:00  INFO 41849 --- [SpringApplicationShutdownHook] io.debezium.embedded.EmbeddedEngine      : Stopping the embedded engine
2022-11-02T08:30:45.904+01:00  INFO 41849 --- [SpringApplicationShutdownHook] io.debezium.embedded.EmbeddedEngine      : Waiting for PT5M for connector to stop
2022-11-02T08:30:45.904+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:30:45.905+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:30:45.905+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:30:45.905+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:30:45.905+01:00  INFO 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:30:45.905+01:00  WARN 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:30:45.905+01:00 ERROR 41849 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:30:46.398+01:00  INFO 41849 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Stopping the task and engine
2022-11-02T08:30:46.398+01:00  INFO 41849 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Stopping down connector
2022-11-02T08:30:46.399+01:00  INFO 41849 --- [pool-29-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:30:46.400+01:00  INFO 41849 --- [pool-1-thread-1] o.a.k.c.storage.FileOffsetBackingStore   : Stopped FileOffsetBackingStore
2022-11-02T08:30:46.400+01:00  INFO 41849 --- [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2022-11-02T08:30:46.402+01:00  INFO 41849 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-11-02T08:30:46.406+01:00  INFO 41849 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-11-02T08:32:11.371+01:00  INFO 42496 --- [main] c.example.demo.AuditLogTestApplication   : Starting AuditLogTestApplication using Java 17.0.4.1 with PID 42496 (/home/schmitz/dev/security/audit_test/target/classes started by schmitz in /home/schmitz/dev/security/audit_test)
2022-11-02T08:32:11.373+01:00  INFO 42496 --- [main] c.example.demo.AuditLogTestApplication   : No active profile set, falling back to 1 default profile: "default"
2022-11-02T08:32:11.899+01:00  INFO 42496 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-11-02T08:32:11.952+01:00  INFO 42496 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 44 ms. Found 1 JPA repository interfaces.
2022-11-02T08:32:12.339+01:00  INFO 42496 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
2022-11-02T08:32:12.346+01:00  INFO 42496 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-11-02T08:32:12.347+01:00  INFO 42496 --- [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.0.27]
2022-11-02T08:32:12.422+01:00  INFO 42496 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-11-02T08:32:12.423+01:00  INFO 42496 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1002 ms
2022-11-02T08:32:12.551+01:00  INFO 42496 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-11-02T08:32:12.585+01:00  INFO 42496 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.1.5.Final
2022-11-02T08:32:12.686+01:00  WARN 42496 --- [main] org.hibernate.orm.deprecation            : HHH90000021: Encountered deprecated setting [javax.persistence.sharedCache.mode], use [jakarta.persistence.sharedCache.mode] instead
2022-11-02T08:32:12.754+01:00  INFO 42496 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-11-02T08:32:13.016+01:00  INFO 42496 --- [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@72f3f14c
2022-11-02T08:32:13.017+01:00  INFO 42496 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-11-02T08:32:13.062+01:00  INFO 42496 --- [main] SQL dialect                              : HHH000400: Using dialect: org.hibernate.dialect.MySQLDialect
2022-11-02T08:32:13.517+01:00  INFO 42496 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-11-02T08:32:13.521+01:00  INFO 42496 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-11-02T08:32:13.562+01:00  INFO 42496 --- [main] o.a.k.connect.json.JsonConverterConfig   : JsonConverterConfig values: 
	converter.type = key
	decimal.format = BASE64
	schemas.cache.size = 1000
	schemas.enable = false

2022-11-02T08:32:13.563+01:00  INFO 42496 --- [main] o.a.k.connect.json.JsonConverterConfig   : JsonConverterConfig values: 
	converter.type = value
	decimal.format = BASE64
	schemas.cache.size = 1000
	schemas.enable = false

2022-11-02T08:32:13.570+01:00  INFO 42496 --- [main] i.d.e.EmbeddedEngine$EmbeddedConfig      : EmbeddedConfig values: 
	access.control.allow.methods = 
	access.control.allow.origin = 
	admin.listeners = null
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	config.providers = []
	connector.client.config.override.policy = All
	header.converter = class org.apache.kafka.connect.storage.SimpleHeaderConverter
	key.converter = class org.apache.kafka.connect.json.JsonConverter
	listeners = [http://:8083]
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	offset.flush.interval.ms = 60000
	offset.flush.timeout.ms = 5000
	offset.storage.file.filename = /tmp/offsets_10533733514931589238.dat
	offset.storage.partitions = null
	offset.storage.replication.factor = null
	offset.storage.topic = 
	plugin.path = null
	response.http.headers.config = 
	rest.advertised.host.name = null
	rest.advertised.listener = null
	rest.advertised.port = null
	rest.extension.classes = []
	ssl.cipher.suites = null
	ssl.client.auth = none
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	task.shutdown.graceful.timeout.ms = 5000
	topic.creation.enable = true
	topic.tracking.allow.reset = true
	topic.tracking.enable = true
	value.converter = class org.apache.kafka.connect.json.JsonConverter

2022-11-02T08:32:13.571+01:00  WARN 42496 --- [main] o.a.kafka.connect.runtime.WorkerConfig   : Variables cannot be used in the 'plugin.path' property, since the property is used by plugin scanning before the config providers that replace the variables are initialized. The raw value 'null' was used for plugin scanning, as opposed to the transformed value 'null', and this may cause unexpected results.
2022-11-02T08:32:13.577+01:00  INFO 42496 --- [pool-1-thread-1] o.a.k.c.storage.FileOffsetBackingStore   : Starting FileOffsetBackingStore with file /tmp/offsets_10533733514931589238.dat
2022-11-02T08:32:13.619+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:32:13.620+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:32:13.620+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:32:13.620+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:32:13.620+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:32:13.620+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:32:13.620+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:32:13.620+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:32:13.621+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:32:13.621+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:32:13.621+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_6811957109620597890.dat
2022-11-02T08:32:13.621+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:32:13.621+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:32:13.621+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:32:13.622+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_10533733514931589238.dat
2022-11-02T08:32:13.622+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:32:13.622+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:32:13.622+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:32:13.622+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:32:13.622+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:32:13.623+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:32:13.623+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:32:13.653+01:00  INFO 42496 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:32:13.693+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:32:13.752+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:32:13.754+01:00  INFO 42496 --- [pool-2-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:32:13.755+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:32:13.755+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:32:13.795+01:00  INFO 42496 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:32:13.798+01:00  INFO 42496 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:32:13.803+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:32:13.803+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:32:13.809+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:32:13.810+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:32:13.810+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:32:13.811+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:32:13.811+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:32:13.814+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:32:13.815+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:32:13.832+01:00  WARN 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:32:13.833+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:32:13.835+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:32:13.836+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:32:13.839+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:32:13.840+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:32:13.841+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:32:13.841+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:32:13.842+01:00  WARN 42496 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-11-02T08:32:13.843+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:32:13.845+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:32:13.845+01:00  WARN 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:32:13.846+01:00 ERROR 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:32:14.262+01:00  INFO 42496 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
2022-11-02T08:32:14.271+01:00  INFO 42496 --- [main] c.example.demo.AuditLogTestApplication   : Started AuditLogTestApplication in 3.2 seconds (process running for 3.613)
2022-11-02T08:32:14.301+01:00  WARN 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:32:14.303+01:00  INFO 42496 --- [pool-3-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:32:14.303+01:00  INFO 42496 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:32:14.305+01:00  INFO 42496 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:32:14.305+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:32:14.305+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:32:14.306+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:32:14.306+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:32:14.306+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:32:14.306+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:32:14.306+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:32:14.306+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:32:14.306+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:32:14.306+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:32:14.306+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:32:14.306+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_6811957109620597890.dat
2022-11-02T08:32:14.306+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:32:14.306+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:32:14.306+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:32:14.306+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_10533733514931589238.dat
2022-11-02T08:32:14.306+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:32:14.306+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:32:14.306+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:32:14.307+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:32:14.307+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:32:14.307+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:32:14.307+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:32:14.308+01:00  INFO 42496 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:32:14.314+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:32:14.319+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:32:14.320+01:00  INFO 42496 --- [pool-4-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:32:14.320+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:32:14.321+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:32:14.324+01:00  INFO 42496 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:32:14.324+01:00  INFO 42496 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:32:14.325+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:32:14.325+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:32:14.325+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:32:14.325+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:32:14.325+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:32:14.325+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:32:14.326+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:32:14.327+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:32:14.327+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:32:14.329+01:00  WARN 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:32:14.329+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:32:14.329+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:32:14.329+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:32:14.330+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:32:14.331+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:32:14.331+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:32:14.332+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:32:14.332+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:32:14.333+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:32:14.333+01:00  WARN 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:32:14.333+01:00 ERROR 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:32:14.825+01:00  WARN 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:32:14.827+01:00  INFO 42496 --- [pool-5-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:32:14.827+01:00  INFO 42496 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:32:14.828+01:00  INFO 42496 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:32:14.828+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:32:14.828+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:32:14.829+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:32:14.829+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:32:14.829+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:32:14.829+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:32:14.829+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:32:14.829+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:32:14.829+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:32:14.829+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:32:14.829+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:32:14.829+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_6811957109620597890.dat
2022-11-02T08:32:14.829+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:32:14.829+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:32:14.829+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:32:14.829+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_10533733514931589238.dat
2022-11-02T08:32:14.829+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:32:14.829+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:32:14.829+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:32:14.829+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:32:14.829+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:32:14.829+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:32:14.829+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:32:14.831+01:00  INFO 42496 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:32:14.838+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:32:14.844+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:32:14.845+01:00  INFO 42496 --- [pool-6-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:32:14.845+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:32:14.845+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:32:14.848+01:00  INFO 42496 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:32:14.849+01:00  INFO 42496 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:32:14.849+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:32:14.849+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:32:14.849+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:32:14.849+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:32:14.849+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:32:14.850+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:32:14.850+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:32:14.851+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:32:14.851+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:32:14.853+01:00  WARN 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:32:14.853+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:32:14.853+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:32:14.854+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:32:14.854+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:32:14.854+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:32:14.854+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:32:14.854+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:32:14.855+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:32:14.855+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:32:14.855+01:00  WARN 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:32:14.855+01:00 ERROR 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:32:15.349+01:00  WARN 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:32:15.352+01:00  INFO 42496 --- [pool-7-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:32:15.352+01:00  INFO 42496 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:32:15.354+01:00  INFO 42496 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:32:15.354+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:32:15.355+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:32:15.355+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:32:15.355+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:32:15.355+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:32:15.355+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:32:15.355+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:32:15.356+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:32:15.356+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:32:15.356+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:32:15.356+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:32:15.356+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_6811957109620597890.dat
2022-11-02T08:32:15.356+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:32:15.356+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:32:15.356+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:32:15.356+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_10533733514931589238.dat
2022-11-02T08:32:15.356+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:32:15.356+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:32:15.356+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:32:15.357+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:32:15.357+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:32:15.357+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:32:15.357+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:32:15.358+01:00  INFO 42496 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:32:15.365+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:32:15.372+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:32:15.372+01:00  INFO 42496 --- [pool-8-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:32:15.372+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:32:15.373+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:32:15.376+01:00  INFO 42496 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:32:15.376+01:00  INFO 42496 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:32:15.377+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:32:15.377+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:32:15.377+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:32:15.377+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:32:15.377+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:32:15.377+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:32:15.377+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:32:15.379+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:32:15.379+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:32:15.381+01:00  WARN 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:32:15.382+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:32:15.382+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:32:15.382+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:32:15.383+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:32:15.383+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:32:15.383+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:32:15.383+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:32:15.383+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:32:15.384+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:32:15.384+01:00  WARN 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:32:15.384+01:00 ERROR 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:32:15.877+01:00  WARN 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:32:15.881+01:00  INFO 42496 --- [pool-9-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:32:15.881+01:00  INFO 42496 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:32:15.882+01:00  INFO 42496 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:32:15.882+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:32:15.883+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:32:15.883+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:32:15.883+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:32:15.883+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:32:15.883+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:32:15.883+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:32:15.883+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:32:15.883+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:32:15.883+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:32:15.884+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:32:15.884+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_6811957109620597890.dat
2022-11-02T08:32:15.884+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:32:15.884+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:32:15.884+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:32:15.884+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_10533733514931589238.dat
2022-11-02T08:32:15.884+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:32:15.884+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:32:15.884+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:32:15.884+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:32:15.884+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:32:15.884+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:32:15.884+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:32:15.885+01:00  INFO 42496 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:32:15.893+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:32:15.903+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:32:15.903+01:00  INFO 42496 --- [pool-10-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:32:15.904+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:32:15.904+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:32:15.907+01:00  INFO 42496 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:32:15.907+01:00  INFO 42496 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:32:15.909+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:32:15.909+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:32:15.909+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:32:15.909+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:32:15.909+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:32:15.910+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:32:15.910+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:32:15.912+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:32:15.912+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:32:15.915+01:00  WARN 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:32:15.915+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:32:15.915+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:32:15.915+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:32:15.916+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:32:15.916+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:32:15.917+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:32:15.917+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:32:15.917+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:32:15.918+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:32:15.918+01:00  WARN 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:32:15.918+01:00 ERROR 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:32:16.340+01:00  INFO 42496 --- [SpringApplicationShutdownHook] io.debezium.embedded.EmbeddedEngine      : Stopping the embedded engine
2022-11-02T08:32:16.341+01:00  INFO 42496 --- [SpringApplicationShutdownHook] io.debezium.embedded.EmbeddedEngine      : Waiting for PT5M for connector to stop
2022-11-02T08:32:16.407+01:00  WARN 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Going to restart connector after 10 sec. after a retriable exception
2022-11-02T08:32:16.409+01:00  INFO 42496 --- [pool-11-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:32:16.410+01:00  INFO 42496 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Retriable exception thrown, connector will be restarted; errors.max.retries=-1

org.apache.kafka.connect.errors.RetriableException: An exception occurred in the change event producer. This connector will be restarted.
	at io.debezium.pipeline.ErrorHandler.setProducerThrowable(ErrorHandler.java:49) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:116) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 5 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:32:16.410+01:00  INFO 42496 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Starting connector, attempt 1
2022-11-02T08:32:16.410+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Connector has already been stopped
2022-11-02T08:32:16.410+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:32:16.411+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:32:16.411+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:32:16.411+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:32:16.411+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:32:16.411+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:32:16.411+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:32:16.411+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:32:16.411+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:32:16.411+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:32:16.411+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_6811957109620597890.dat
2022-11-02T08:32:16.411+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:32:16.411+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:32:16.411+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:32:16.411+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_10533733514931589238.dat
2022-11-02T08:32:16.411+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:32:16.411+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:32:16.411+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:32:16.411+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:32:16.411+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:32:16.411+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:32:16.411+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:32:16.412+01:00  INFO 42496 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:32:16.420+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:32:16.423+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:32:16.424+01:00  INFO 42496 --- [pool-12-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:32:16.424+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:32:16.424+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:32:16.426+01:00  INFO 42496 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:32:16.426+01:00  INFO 42496 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:32:16.427+01:00  INFO 42496 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Stopping the task and engine
2022-11-02T08:32:16.427+01:00  INFO 42496 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Stopping down connector
2022-11-02T08:32:16.427+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:32:16.427+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:32:16.427+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:32:16.427+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:32:16.427+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:32:16.427+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:32:16.427+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:32:16.428+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, performance_schema]
2022-11-02T08:32:16.428+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:32:16.431+01:00  WARN 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 skipping database 'performance_schema' due to error reading tables: Access denied for user 'user'@'%' to database 'performance_schema'
2022-11-02T08:32:16.431+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, dbSRC]
2022-11-02T08:32:16.431+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:32:16.431+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:32:16.432+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:32:16.433+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Unable to flush and acquire global read lock, will use table read locks after reading table names
2022-11-02T08:32:16.433+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:32:16.433+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:32:16.433+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain read lock for [dbSRC.customer] tables (preventing writes)
2022-11-02T08:32:16.434+01:00  INFO 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:32:16.434+01:00  WARN 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot was not completed successfully, it will be re-executed upon connector restart
2022-11-02T08:32:16.434+01:00 ERROR 42496 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.pipeline.ErrorHandler        : Producer failure

io.debezium.DebeziumException: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:85) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.doSnapshot(ChangeEventSourceCoordinator.java:155) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.executeChangeEventSources(ChangeEventSourceCoordinator.java:137) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.ChangeEventSourceCoordinator.lambda$start$0(ChangeEventSourceCoordinator.java:109) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Access denied; you need (at least one of) the RELOAD or FLUSH_TABLES privilege(s) for this operation
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.executeInternal(StatementImpl.java:763) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at com.mysql.cj.jdbc.StatementImpl.execute(StatementImpl.java:648) ~[mysql-connector-j-8.0.31.jar:8.0.31]
	at io.debezium.jdbc.JdbcConnection.executeWithoutCommitting(JdbcConnection.java:1440) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.tableLock(MySqlSnapshotChangeEventSource.java:445) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:309) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlSnapshotChangeEventSource.readTableStructure(MySqlSnapshotChangeEventSource.java:46) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.RelationalSnapshotChangeEventSource.doExecute(RelationalSnapshotChangeEventSource.java:117) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.pipeline.source.AbstractSnapshotChangeEventSource.execute(AbstractSnapshotChangeEventSource.java:76) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	... 8 common frames omitted

2022-11-02T08:32:16.436+01:00  INFO 42496 --- [pool-13-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:32:16.437+01:00  INFO 42496 --- [pool-1-thread-1] o.a.k.c.storage.FileOffsetBackingStore   : Stopped FileOffsetBackingStore
2022-11-02T08:32:16.437+01:00  INFO 42496 --- [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2022-11-02T08:32:16.439+01:00  INFO 42496 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-11-02T08:32:16.444+01:00  INFO 42496 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-11-02T08:43:03.323+01:00  INFO 11306 --- [main] c.example.demo.AuditLogTestApplication   : Starting AuditLogTestApplication using Java 17.0.4.1 with PID 11306 (/home/schmitz/dev/security/audit_test/target/classes started by schmitz in /home/schmitz/dev/security/audit_test)
2022-11-02T08:43:03.326+01:00  INFO 11306 --- [main] c.example.demo.AuditLogTestApplication   : No active profile set, falling back to 1 default profile: "default"
2022-11-02T08:43:03.888+01:00  INFO 11306 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-11-02T08:43:03.940+01:00  INFO 11306 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 42 ms. Found 1 JPA repository interfaces.
2022-11-02T08:43:04.387+01:00  INFO 11306 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
2022-11-02T08:43:04.395+01:00  INFO 11306 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-11-02T08:43:04.395+01:00  INFO 11306 --- [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.0.27]
2022-11-02T08:43:04.477+01:00  INFO 11306 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-11-02T08:43:04.477+01:00  INFO 11306 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1109 ms
2022-11-02T08:43:04.624+01:00  INFO 11306 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-11-02T08:43:04.685+01:00  INFO 11306 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.1.5.Final
2022-11-02T08:43:04.852+01:00  WARN 11306 --- [main] org.hibernate.orm.deprecation            : HHH90000021: Encountered deprecated setting [javax.persistence.sharedCache.mode], use [jakarta.persistence.sharedCache.mode] instead
2022-11-02T08:43:04.973+01:00  INFO 11306 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-11-02T08:43:05.264+01:00  INFO 11306 --- [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@3d8d52be
2022-11-02T08:43:05.266+01:00  INFO 11306 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-11-02T08:43:05.317+01:00  INFO 11306 --- [main] SQL dialect                              : HHH000400: Using dialect: org.hibernate.dialect.MySQLDialect
2022-11-02T08:43:05.906+01:00  INFO 11306 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-11-02T08:43:05.912+01:00  INFO 11306 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-11-02T08:43:05.958+01:00  INFO 11306 --- [main] o.a.k.connect.json.JsonConverterConfig   : JsonConverterConfig values: 
	converter.type = key
	decimal.format = BASE64
	schemas.cache.size = 1000
	schemas.enable = false

2022-11-02T08:43:05.961+01:00  INFO 11306 --- [main] o.a.k.connect.json.JsonConverterConfig   : JsonConverterConfig values: 
	converter.type = value
	decimal.format = BASE64
	schemas.cache.size = 1000
	schemas.enable = false

2022-11-02T08:43:05.968+01:00  INFO 11306 --- [main] i.d.e.EmbeddedEngine$EmbeddedConfig      : EmbeddedConfig values: 
	access.control.allow.methods = 
	access.control.allow.origin = 
	admin.listeners = null
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	config.providers = []
	connector.client.config.override.policy = All
	header.converter = class org.apache.kafka.connect.storage.SimpleHeaderConverter
	key.converter = class org.apache.kafka.connect.json.JsonConverter
	listeners = [http://:8083]
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	offset.flush.interval.ms = 60000
	offset.flush.timeout.ms = 5000
	offset.storage.file.filename = /tmp/offsets_2588167960808785328.dat
	offset.storage.partitions = null
	offset.storage.replication.factor = null
	offset.storage.topic = 
	plugin.path = null
	response.http.headers.config = 
	rest.advertised.host.name = null
	rest.advertised.listener = null
	rest.advertised.port = null
	rest.extension.classes = []
	ssl.cipher.suites = null
	ssl.client.auth = none
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	task.shutdown.graceful.timeout.ms = 5000
	topic.creation.enable = true
	topic.tracking.allow.reset = true
	topic.tracking.enable = true
	value.converter = class org.apache.kafka.connect.json.JsonConverter

2022-11-02T08:43:05.969+01:00  WARN 11306 --- [main] o.a.kafka.connect.runtime.WorkerConfig   : Variables cannot be used in the 'plugin.path' property, since the property is used by plugin scanning before the config providers that replace the variables are initialized. The raw value 'null' was used for plugin scanning, as opposed to the transformed value 'null', and this may cause unexpected results.
2022-11-02T08:43:05.975+01:00  INFO 11306 --- [pool-1-thread-1] o.a.k.c.storage.FileOffsetBackingStore   : Starting FileOffsetBackingStore with file /tmp/offsets_2588167960808785328.dat
2022-11-02T08:43:06.029+01:00  INFO 11306 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T08:43:06.031+01:00  INFO 11306 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T08:43:06.031+01:00  INFO 11306 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T08:43:06.031+01:00  INFO 11306 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T08:43:06.031+01:00  INFO 11306 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T08:43:06.032+01:00  INFO 11306 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T08:43:06.032+01:00  INFO 11306 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T08:43:06.032+01:00  INFO 11306 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T08:43:06.032+01:00  INFO 11306 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T08:43:06.032+01:00  INFO 11306 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T08:43:06.032+01:00  INFO 11306 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_12454197598179257905.dat
2022-11-02T08:43:06.032+01:00  INFO 11306 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T08:43:06.032+01:00  INFO 11306 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T08:43:06.032+01:00  INFO 11306 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T08:43:06.033+01:00  INFO 11306 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_2588167960808785328.dat
2022-11-02T08:43:06.033+01:00  INFO 11306 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T08:43:06.033+01:00  INFO 11306 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T08:43:06.033+01:00  INFO 11306 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T08:43:06.033+01:00  INFO 11306 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T08:43:06.034+01:00  INFO 11306 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T08:43:06.034+01:00  INFO 11306 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:43:06.034+01:00  INFO 11306 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T08:43:06.067+01:00  INFO 11306 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T08:43:06.133+01:00  INFO 11306 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T08:43:06.221+01:00  INFO 11306 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T08:43:06.224+01:00  INFO 11306 --- [pool-2-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T08:43:06.225+01:00  INFO 11306 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T08:43:06.226+01:00  INFO 11306 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T08:43:06.271+01:00  INFO 11306 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T08:43:06.274+01:00  INFO 11306 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T08:43:06.278+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T08:43:06.279+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T08:43:06.285+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T08:43:06.286+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T08:43:06.287+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T08:43:06.288+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T08:43:06.288+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T08:43:06.291+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, mysql, performance_schema, sys]
2022-11-02T08:43:06.291+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T08:43:06.292+01:00  WARN 11306 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-11-02T08:43:06.313+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, performance_schema, dbSRC, mysql, sys]
2022-11-02T08:43:06.314+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T08:43:06.323+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T08:43:06.327+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T08:43:06.330+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T08:43:06.337+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read binlog position of MySQL primary server
2022-11-02T08:43:06.340+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 using binlog 'binlog.000002' at position '1147' and gtid ''
2022-11-02T08:43:06.340+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T08:43:06.340+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : All eligible tables schema should be captured, capturing: [dbSRC.customer]
2022-11-02T08:43:06.767+01:00  INFO 11306 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
2022-11-02T08:43:06.784+01:00  INFO 11306 --- [main] c.example.demo.AuditLogTestApplication   : Started AuditLogTestApplication in 3.829 seconds (process running for 4.334)
2022-11-02T08:43:06.985+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Reading structure of database 'dbSRC'
2022-11-02T08:43:07.089+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 6 - Persisting schema history
2022-11-02T08:43:07.126+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Releasing global read lock to enable MySQL writes
2022-11-02T08:43:07.128+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Writes to MySQL tables prevented for a total of 00:00:00.798
2022-11-02T08:43:07.128+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 7 - Snapshotting data
2022-11-02T08:43:07.129+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshotting contents of 1 tables while still in transaction
2022-11-02T08:43:07.129+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Exporting data from table 'dbSRC.customer' (1 of 1 tables)
2022-11-02T08:43:07.131+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : 	 For table 'dbSRC.customer' using select statement: 'SELECT `id`, `email`, `fullname` FROM `dbSRC`.`customer`'
2022-11-02T08:43:07.149+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : 	 Finished exporting 0 records for table 'dbSRC.customer'; total duration '00:00:00.02'
2022-11-02T08:43:07.153+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T08:43:07.154+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot completed
2022-11-02T08:43:07.154+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Snapshot ended with SnapshotResult [status=COMPLETED, offset=MySqlOffsetContext [sourceInfoSchema=Schema{io.debezium.connector.mysql.Source:STRUCT}, sourceInfo=SourceInfo [currentGtid=null, currentBinlogFilename=binlog.000002, currentBinlogPosition=1147, currentRowNumber=0, serverId=0, sourceTime=2022-11-02T07:43:07.108Z, threadId=-1, currentQuery=null, tableIds=[dbSRC.customer], databaseName=dbSRC], snapshotCompleted=true, transactionContext=TransactionContext [currentTransactionId=null, perTableEventCount={}, totalEventCount=0], restartGtidSet=null, currentGtidSet=null, restartBinlogFilename=binlog.000002, restartBinlogPosition=1147, restartRowsToSkip=0, restartEventsToSkip=0, currentEventLengthInBytes=0, inTransaction=false, transactionId=null, incrementalSnapshotContext =IncrementalSnapshotContext [windowOpened=false, chunkEndPosition=null, dataCollectionsToSnapshot=[], lastEventKeySent=null, maximumKey=null]]]
2022-11-02T08:43:07.188+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = binlog-client
2022-11-02T08:43:07.191+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Starting streaming
2022-11-02T08:43:07.202+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlStreamingChangeEventSource  : Skip 0 events on streaming start
2022-11-02T08:43:07.203+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlStreamingChangeEventSource  : Skip 0 rows on streaming start
2022-11-02T08:43:07.204+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-binlog-client
2022-11-02T08:43:07.208+01:00  INFO 11306 --- [blc-localhost:3306] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-binlog-client
2022-11-02T08:43:07.218+01:00  INFO 11306 --- [blc-localhost:3306] c.g.shyiko.mysql.binlog.BinaryLogClient  : Connected to localhost:3306 at binlog.000002/1147 (sid:1, cid:22)
2022-11-02T08:43:07.218+01:00  INFO 11306 --- [blc-localhost:3306] i.d.c.m.MySqlStreamingChangeEventSource  : Connected to MySQL binlog at localhost:3306, starting at MySqlOffsetContext [sourceInfoSchema=Schema{io.debezium.connector.mysql.Source:STRUCT}, sourceInfo=SourceInfo [currentGtid=null, currentBinlogFilename=binlog.000002, currentBinlogPosition=1147, currentRowNumber=0, serverId=0, sourceTime=2022-11-02T07:43:07.108Z, threadId=-1, currentQuery=null, tableIds=[dbSRC.customer], databaseName=dbSRC], snapshotCompleted=true, transactionContext=TransactionContext [currentTransactionId=null, perTableEventCount={}, totalEventCount=0], restartGtidSet=null, currentGtidSet=null, restartBinlogFilename=binlog.000002, restartBinlogPosition=1147, restartRowsToSkip=0, restartEventsToSkip=0, currentEventLengthInBytes=0, inTransaction=false, transactionId=null, incrementalSnapshotContext =IncrementalSnapshotContext [windowOpened=false, chunkEndPosition=null, dataCollectionsToSnapshot=[], lastEventKeySent=null, maximumKey=null]]
2022-11-02T08:43:07.219+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlStreamingChangeEventSource  : Waiting for keepalive thread to start
2022-11-02T08:43:07.220+01:00  INFO 11306 --- [blc-localhost:3306] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-binlog-client
2022-11-02T08:43:07.320+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlStreamingChangeEventSource  : Keepalive thread is running
2022-11-02T08:44:59.002+01:00  INFO 11306 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : 1 records sent during previous 00:01:53.006, last recorded offset of {server=my-app-connector} partition is {transaction_id=null, ts_sec=1667375098, file=binlog.000002, pos=1226, row=1, server_id=1, event=2}
2022-11-02T08:44:59.003+01:00  INFO 11306 --- [pool-1-thread-1] c.e.demo.listener.DebeziumListener       : Key = 'Struct{id=1}' value = 'Struct{after=Struct{id=1,email=jd@example.com,fullname=John Doe},source=Struct{version=2.0.0.Final,connector=mysql,name=my-app-connector,ts_ms=1667375098000,db=dbSRC,table=customer,server_id=1,file=binlog.000002,pos=1368,row=0,thread=23},op=c,ts_ms=1667375098906}'
2022-11-02T08:47:32.814+01:00  INFO 11306 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : 2 records sent during previous 00:02:33.812, last recorded offset of {server=my-app-connector} partition is {transaction_id=null, ts_sec=1667375252, file=binlog.000002, pos=1548, row=1, server_id=1, event=2}
2022-11-02T08:47:32.814+01:00  INFO 11306 --- [pool-1-thread-1] c.e.demo.listener.DebeziumListener       : Key = 'Struct{id=1}' value = 'Struct{before=Struct{id=1,email=jd@example.com,fullname=John Doe},source=Struct{version=2.0.0.Final,connector=mysql,name=my-app-connector,ts_ms=1667375252000,db=dbSRC,table=customer,server_id=1,file=binlog.000002,pos=1690,row=0,thread=25},op=d,ts_ms=1667375252638}'
2022-11-02T08:47:32.814+01:00  INFO 11306 --- [pool-1-thread-1] c.e.demo.listener.DebeziumListener       : Key = 'Struct{id=1}' value = 'null'
2022-11-02T09:33:16.307+01:00  INFO 11306 --- [SpringApplicationShutdownHook] io.debezium.embedded.EmbeddedEngine      : Stopping the embedded engine
2022-11-02T09:33:16.307+01:00  INFO 11306 --- [SpringApplicationShutdownHook] io.debezium.embedded.EmbeddedEngine      : Waiting for PT5M for connector to stop
2022-11-02T09:33:16.793+01:00  INFO 11306 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Stopping the task and engine
2022-11-02T09:33:16.793+01:00  INFO 11306 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Stopping down connector
2022-11-02T09:33:16.848+01:00  INFO 11306 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Finished streaming
2022-11-02T09:33:16.849+01:00  INFO 11306 --- [blc-localhost:3306] i.d.c.m.MySqlStreamingChangeEventSource  : Stopped reading binlog after 0 events, last recorded offset: {transaction_id=null, ts_sec=1667375252, file=binlog.000002, pos=1791, server_id=1, event=1}
2022-11-02T09:33:16.850+01:00  INFO 11306 --- [pool-3-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T09:33:16.850+01:00  INFO 11306 --- [pool-1-thread-1] o.a.k.c.storage.FileOffsetBackingStore   : Stopped FileOffsetBackingStore
2022-11-02T09:33:16.851+01:00  INFO 11306 --- [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2022-11-02T09:33:16.852+01:00  INFO 11306 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-11-02T09:33:16.857+01:00  INFO 11306 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-11-02T12:21:21.178+01:00  INFO 92547 --- [main] c.example.demo.AuditLogTestApplication   : Starting AuditLogTestApplication using Java 17.0.4.1 with PID 92547 (/home/schmitz/dev/security/audit_test/target/classes started by schmitz in /home/schmitz/dev/security/audit_test)
2022-11-02T12:21:21.183+01:00  INFO 92547 --- [main] c.example.demo.AuditLogTestApplication   : No active profile set, falling back to 1 default profile: "default"
2022-11-02T12:21:21.946+01:00  INFO 92547 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-11-02T12:21:22.018+01:00  INFO 92547 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 59 ms. Found 1 JPA repository interfaces.
2022-11-02T12:21:22.625+01:00  INFO 92547 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
2022-11-02T12:21:22.639+01:00  INFO 92547 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-11-02T12:21:22.640+01:00  INFO 92547 --- [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.0.27]
2022-11-02T12:21:22.791+01:00  INFO 92547 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-11-02T12:21:22.792+01:00  INFO 92547 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1542 ms
2022-11-02T12:21:23.083+01:00  INFO 92547 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-11-02T12:21:23.156+01:00  INFO 92547 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.1.5.Final
2022-11-02T12:21:23.344+01:00  WARN 92547 --- [main] org.hibernate.orm.deprecation            : HHH90000021: Encountered deprecated setting [javax.persistence.sharedCache.mode], use [jakarta.persistence.sharedCache.mode] instead
2022-11-02T12:21:23.473+01:00  INFO 92547 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-11-02T12:21:23.953+01:00  INFO 92547 --- [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@4a122e68
2022-11-02T12:21:23.956+01:00  INFO 92547 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-11-02T12:21:24.022+01:00  INFO 92547 --- [main] SQL dialect                              : HHH000400: Using dialect: org.hibernate.dialect.MySQLDialect
2022-11-02T12:21:24.917+01:00  INFO 92547 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-11-02T12:21:24.926+01:00  INFO 92547 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-11-02T12:21:24.988+01:00  INFO 92547 --- [main] o.a.k.connect.json.JsonConverterConfig   : JsonConverterConfig values: 
	converter.type = key
	decimal.format = BASE64
	schemas.cache.size = 1000
	schemas.enable = false

2022-11-02T12:21:24.991+01:00  INFO 92547 --- [main] o.a.k.connect.json.JsonConverterConfig   : JsonConverterConfig values: 
	converter.type = value
	decimal.format = BASE64
	schemas.cache.size = 1000
	schemas.enable = false

2022-11-02T12:21:25.003+01:00  INFO 92547 --- [main] i.d.e.EmbeddedEngine$EmbeddedConfig      : EmbeddedConfig values: 
	access.control.allow.methods = 
	access.control.allow.origin = 
	admin.listeners = null
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	config.providers = []
	connector.client.config.override.policy = All
	header.converter = class org.apache.kafka.connect.storage.SimpleHeaderConverter
	key.converter = class org.apache.kafka.connect.json.JsonConverter
	listeners = [http://:8083]
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	offset.flush.interval.ms = 60000
	offset.flush.timeout.ms = 5000
	offset.storage.file.filename = /tmp/offsets_6555694870918628027.dat
	offset.storage.partitions = null
	offset.storage.replication.factor = null
	offset.storage.topic = 
	plugin.path = null
	response.http.headers.config = 
	rest.advertised.host.name = null
	rest.advertised.listener = null
	rest.advertised.port = null
	rest.extension.classes = []
	ssl.cipher.suites = null
	ssl.client.auth = none
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	task.shutdown.graceful.timeout.ms = 5000
	topic.creation.enable = true
	topic.tracking.allow.reset = true
	topic.tracking.enable = true
	value.converter = class org.apache.kafka.connect.json.JsonConverter

2022-11-02T12:21:25.004+01:00  WARN 92547 --- [main] o.a.kafka.connect.runtime.WorkerConfig   : Variables cannot be used in the 'plugin.path' property, since the property is used by plugin scanning before the config providers that replace the variables are initialized. The raw value 'null' was used for plugin scanning, as opposed to the transformed value 'null', and this may cause unexpected results.
2022-11-02T12:21:25.010+01:00  INFO 92547 --- [pool-1-thread-1] o.a.k.c.storage.FileOffsetBackingStore   : Starting FileOffsetBackingStore with file /tmp/offsets_6555694870918628027.dat
2022-11-02T12:21:25.072+01:00  INFO 92547 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T12:21:25.073+01:00  INFO 92547 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T12:21:25.073+01:00  INFO 92547 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T12:21:25.074+01:00  INFO 92547 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T12:21:25.074+01:00  INFO 92547 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T12:21:25.074+01:00  INFO 92547 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T12:21:25.074+01:00  INFO 92547 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T12:21:25.074+01:00  INFO 92547 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T12:21:25.074+01:00  INFO 92547 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T12:21:25.075+01:00  INFO 92547 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T12:21:25.075+01:00  INFO 92547 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_9320439931712104210.dat
2022-11-02T12:21:25.075+01:00  INFO 92547 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T12:21:25.075+01:00  INFO 92547 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T12:21:25.075+01:00  INFO 92547 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T12:21:25.076+01:00  INFO 92547 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_6555694870918628027.dat
2022-11-02T12:21:25.076+01:00  INFO 92547 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T12:21:25.076+01:00  INFO 92547 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T12:21:25.076+01:00  INFO 92547 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T12:21:25.076+01:00  INFO 92547 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T12:21:25.077+01:00  INFO 92547 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T12:21:25.077+01:00  INFO 92547 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T12:21:25.077+01:00  INFO 92547 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T12:21:25.121+01:00  INFO 92547 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T12:21:25.182+01:00  INFO 92547 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T12:21:25.269+01:00  INFO 92547 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T12:21:25.272+01:00  INFO 92547 --- [pool-2-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T12:21:25.273+01:00  INFO 92547 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T12:21:25.273+01:00  INFO 92547 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T12:21:25.340+01:00  INFO 92547 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T12:21:25.345+01:00  INFO 92547 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T12:21:25.351+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T12:21:25.354+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T12:21:25.363+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T12:21:25.363+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T12:21:25.364+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T12:21:25.365+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T12:21:25.369+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T12:21:25.376+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, mysql, performance_schema, sys]
2022-11-02T12:21:25.377+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T12:21:25.404+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, performance_schema, dbSRC, mysql, sys]
2022-11-02T12:21:25.406+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T12:21:25.408+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T12:21:25.412+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T12:21:25.415+01:00  WARN 92547 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-11-02T12:21:25.416+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T12:21:25.431+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read binlog position of MySQL primary server
2022-11-02T12:21:25.434+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 using binlog 'binlog.000002' at position '1791' and gtid ''
2022-11-02T12:21:25.435+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T12:21:25.435+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : All eligible tables schema should be captured, capturing: [dbSRC.customer]
2022-11-02T12:21:25.992+01:00  INFO 92547 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
2022-11-02T12:21:26.013+01:00  INFO 92547 --- [main] c.example.demo.AuditLogTestApplication   : Started AuditLogTestApplication in 5.293 seconds (process running for 5.942)
2022-11-02T12:21:26.179+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Reading structure of database 'dbSRC'
2022-11-02T12:21:26.294+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 6 - Persisting schema history
2022-11-02T12:21:26.343+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Releasing global read lock to enable MySQL writes
2022-11-02T12:21:26.345+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Writes to MySQL tables prevented for a total of 00:00:00.929
2022-11-02T12:21:26.345+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 7 - Snapshotting data
2022-11-02T12:21:26.346+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshotting contents of 1 tables while still in transaction
2022-11-02T12:21:26.347+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Exporting data from table 'dbSRC.customer' (1 of 1 tables)
2022-11-02T12:21:26.349+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : 	 For table 'dbSRC.customer' using select statement: 'SELECT `id`, `email`, `fullname` FROM `dbSRC`.`customer`'
2022-11-02T12:21:26.366+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : 	 Finished exporting 0 records for table 'dbSRC.customer'; total duration '00:00:00.019'
2022-11-02T12:21:26.371+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T12:21:26.372+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot completed
2022-11-02T12:21:26.372+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Snapshot ended with SnapshotResult [status=COMPLETED, offset=MySqlOffsetContext [sourceInfoSchema=Schema{io.debezium.connector.mysql.Source:STRUCT}, sourceInfo=SourceInfo [currentGtid=null, currentBinlogFilename=binlog.000002, currentBinlogPosition=1791, currentRowNumber=0, serverId=0, sourceTime=2022-11-02T11:21:26.319Z, threadId=-1, currentQuery=null, tableIds=[dbSRC.customer], databaseName=dbSRC], snapshotCompleted=true, transactionContext=TransactionContext [currentTransactionId=null, perTableEventCount={}, totalEventCount=0], restartGtidSet=null, currentGtidSet=null, restartBinlogFilename=binlog.000002, restartBinlogPosition=1791, restartRowsToSkip=0, restartEventsToSkip=0, currentEventLengthInBytes=0, inTransaction=false, transactionId=null, incrementalSnapshotContext =IncrementalSnapshotContext [windowOpened=false, chunkEndPosition=null, dataCollectionsToSnapshot=[], lastEventKeySent=null, maximumKey=null]]]
2022-11-02T12:21:26.420+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = binlog-client
2022-11-02T12:21:26.424+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Starting streaming
2022-11-02T12:21:26.440+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlStreamingChangeEventSource  : Skip 0 events on streaming start
2022-11-02T12:21:26.440+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlStreamingChangeEventSource  : Skip 0 rows on streaming start
2022-11-02T12:21:26.441+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-binlog-client
2022-11-02T12:21:26.446+01:00  INFO 92547 --- [blc-localhost:3306] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-binlog-client
2022-11-02T12:21:26.458+01:00  INFO 92547 --- [blc-localhost:3306] c.g.shyiko.mysql.binlog.BinaryLogClient  : Connected to localhost:3306 at binlog.000002/1791 (sid:1, cid:48)
2022-11-02T12:21:26.458+01:00  INFO 92547 --- [blc-localhost:3306] i.d.c.m.MySqlStreamingChangeEventSource  : Connected to MySQL binlog at localhost:3306, starting at MySqlOffsetContext [sourceInfoSchema=Schema{io.debezium.connector.mysql.Source:STRUCT}, sourceInfo=SourceInfo [currentGtid=null, currentBinlogFilename=binlog.000002, currentBinlogPosition=1791, currentRowNumber=0, serverId=0, sourceTime=2022-11-02T11:21:26.319Z, threadId=-1, currentQuery=null, tableIds=[dbSRC.customer], databaseName=dbSRC], snapshotCompleted=true, transactionContext=TransactionContext [currentTransactionId=null, perTableEventCount={}, totalEventCount=0], restartGtidSet=null, currentGtidSet=null, restartBinlogFilename=binlog.000002, restartBinlogPosition=1791, restartRowsToSkip=0, restartEventsToSkip=0, currentEventLengthInBytes=0, inTransaction=false, transactionId=null, incrementalSnapshotContext =IncrementalSnapshotContext [windowOpened=false, chunkEndPosition=null, dataCollectionsToSnapshot=[], lastEventKeySent=null, maximumKey=null]]
2022-11-02T12:21:26.459+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlStreamingChangeEventSource  : Waiting for keepalive thread to start
2022-11-02T12:21:26.460+01:00  INFO 92547 --- [blc-localhost:3306] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-binlog-client
2022-11-02T12:21:26.560+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlStreamingChangeEventSource  : Keepalive thread is running
2022-11-02T12:22:00.417+01:00  INFO 92547 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : 1 records sent during previous 00:00:35.383, last recorded offset of {server=my-app-connector} partition is {transaction_id=null, ts_sec=1667388119, file=binlog.000002, pos=1870, row=1, server_id=1, event=2}
2022-11-02T12:22:00.419+01:00  INFO 92547 --- [pool-1-thread-1] c.e.demo.listener.DebeziumListener       : Key = 'Struct{id=1}' value = 'Struct{after=Struct{id=1,email=jd@example.com,fullname=John Doe},source=Struct{version=2.0.0.Final,connector=mysql,name=my-app-connector,ts_ms=1667388119000,db=dbSRC,table=customer,server_id=1,file=binlog.000002,pos=2012,row=0,thread=49},op=c,ts_ms=1667388119957}'
2022-11-02T12:22:17.955+01:00  INFO 92547 --- [pool-1-thread-1] c.e.demo.listener.DebeziumListener       : Key = 'Struct{id=1}' value = 'Struct{before=Struct{id=1,email=jd@example.com,fullname=John Doe},source=Struct{version=2.0.0.Final,connector=mysql,name=my-app-connector,ts_ms=1667388137000,db=dbSRC,table=customer,server_id=1,file=binlog.000002,pos=2334,row=0,thread=50},op=d,ts_ms=1667388137790}'
2022-11-02T12:22:17.955+01:00  INFO 92547 --- [pool-1-thread-1] c.e.demo.listener.DebeziumListener       : Key = 'Struct{id=1}' value = 'null'
2022-11-02T13:13:43.329+01:00  INFO 92547 --- [SpringApplicationShutdownHook] io.debezium.embedded.EmbeddedEngine      : Stopping the embedded engine
2022-11-02T13:13:43.329+01:00  INFO 92547 --- [SpringApplicationShutdownHook] io.debezium.embedded.EmbeddedEngine      : Waiting for PT5M for connector to stop
2022-11-02T13:13:43.615+01:00  INFO 92547 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Stopping the task and engine
2022-11-02T13:13:43.615+01:00  INFO 92547 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Stopping down connector
2022-11-02T13:13:43.699+01:00  INFO 92547 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Finished streaming
2022-11-02T13:13:43.700+01:00  INFO 92547 --- [blc-localhost:3306] i.d.c.m.MySqlStreamingChangeEventSource  : Stopped reading binlog after 0 events, last recorded offset: {transaction_id=null, ts_sec=1667388137, file=binlog.000002, pos=2435, server_id=1, event=1}
2022-11-02T13:13:43.701+01:00  INFO 92547 --- [pool-3-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T13:13:43.707+01:00  INFO 92547 --- [pool-1-thread-1] o.a.k.c.storage.FileOffsetBackingStore   : Stopped FileOffsetBackingStore
2022-11-02T13:13:43.708+01:00  INFO 92547 --- [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2022-11-02T13:13:43.710+01:00  INFO 92547 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-11-02T13:13:43.715+01:00  INFO 92547 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-11-02T13:42:18.534+01:00  INFO 133742 --- [main] c.example.demo.AuditLogTestApplication   : Starting AuditLogTestApplication using Java 17.0.4.1 with PID 133742 (/home/schmitz/dev/security/audit_test/target/classes started by schmitz in /home/schmitz/dev/security/audit_test)
2022-11-02T13:42:18.536+01:00  INFO 133742 --- [main] c.example.demo.AuditLogTestApplication   : No active profile set, falling back to 1 default profile: "default"
2022-11-02T13:42:19.051+01:00  INFO 133742 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-11-02T13:42:19.102+01:00  INFO 133742 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 42 ms. Found 1 JPA repository interfaces.
2022-11-02T13:42:19.543+01:00  INFO 133742 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
2022-11-02T13:42:19.552+01:00  INFO 133742 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-11-02T13:42:19.553+01:00  INFO 133742 --- [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.0.27]
2022-11-02T13:42:19.637+01:00  INFO 133742 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-11-02T13:42:19.637+01:00  INFO 133742 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1061 ms
2022-11-02T13:42:19.758+01:00  INFO 133742 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-11-02T13:42:19.795+01:00  INFO 133742 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.1.5.Final
2022-11-02T13:42:19.911+01:00  WARN 133742 --- [main] org.hibernate.orm.deprecation            : HHH90000021: Encountered deprecated setting [javax.persistence.sharedCache.mode], use [jakarta.persistence.sharedCache.mode] instead
2022-11-02T13:42:19.991+01:00  INFO 133742 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-11-02T13:42:20.270+01:00  INFO 133742 --- [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@31b6b0c7
2022-11-02T13:42:20.272+01:00  INFO 133742 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-11-02T13:42:20.317+01:00  INFO 133742 --- [main] SQL dialect                              : HHH000400: Using dialect: org.hibernate.dialect.MySQLDialect
2022-11-02T13:42:20.816+01:00  INFO 133742 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-11-02T13:42:20.822+01:00  INFO 133742 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-11-02T13:42:20.882+01:00  INFO 133742 --- [main] o.a.k.connect.json.JsonConverterConfig   : JsonConverterConfig values: 
	converter.type = key
	decimal.format = BASE64
	schemas.cache.size = 1000
	schemas.enable = false

2022-11-02T13:42:20.884+01:00  INFO 133742 --- [main] o.a.k.connect.json.JsonConverterConfig   : JsonConverterConfig values: 
	converter.type = value
	decimal.format = BASE64
	schemas.cache.size = 1000
	schemas.enable = false

2022-11-02T13:42:20.892+01:00  INFO 133742 --- [main] i.d.e.EmbeddedEngine$EmbeddedConfig      : EmbeddedConfig values: 
	access.control.allow.methods = 
	access.control.allow.origin = 
	admin.listeners = null
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	config.providers = []
	connector.client.config.override.policy = All
	header.converter = class org.apache.kafka.connect.storage.SimpleHeaderConverter
	key.converter = class org.apache.kafka.connect.json.JsonConverter
	listeners = [http://:8083]
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	offset.flush.interval.ms = 60000
	offset.flush.timeout.ms = 5000
	offset.storage.file.filename = /tmp/offsets_16227454402835251428.dat
	offset.storage.partitions = null
	offset.storage.replication.factor = null
	offset.storage.topic = 
	plugin.path = null
	response.http.headers.config = 
	rest.advertised.host.name = null
	rest.advertised.listener = null
	rest.advertised.port = null
	rest.extension.classes = []
	ssl.cipher.suites = null
	ssl.client.auth = none
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	task.shutdown.graceful.timeout.ms = 5000
	topic.creation.enable = true
	topic.tracking.allow.reset = true
	topic.tracking.enable = true
	value.converter = class org.apache.kafka.connect.json.JsonConverter

2022-11-02T13:42:20.893+01:00  WARN 133742 --- [main] o.a.kafka.connect.runtime.WorkerConfig   : Variables cannot be used in the 'plugin.path' property, since the property is used by plugin scanning before the config providers that replace the variables are initialized. The raw value 'null' was used for plugin scanning, as opposed to the transformed value 'null', and this may cause unexpected results.
2022-11-02T13:42:20.899+01:00  INFO 133742 --- [pool-1-thread-1] o.a.k.c.storage.FileOffsetBackingStore   : Starting FileOffsetBackingStore with file /tmp/offsets_16227454402835251428.dat
2022-11-02T13:42:20.946+01:00  INFO 133742 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T13:42:20.947+01:00  INFO 133742 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T13:42:20.947+01:00  INFO 133742 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T13:42:20.947+01:00  INFO 133742 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T13:42:20.947+01:00  INFO 133742 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T13:42:20.947+01:00  INFO 133742 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T13:42:20.947+01:00  INFO 133742 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.history.internal.file.filename = /tmp/dbhistory_8518916130343746596.dat
2022-11-02T13:42:20.947+01:00  INFO 133742 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T13:42:20.947+01:00  INFO 133742 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T13:42:20.948+01:00  INFO 133742 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T13:42:20.948+01:00  INFO 133742 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T13:42:20.948+01:00  INFO 133742 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T13:42:20.948+01:00  INFO 133742 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T13:42:20.948+01:00  INFO 133742 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T13:42:20.948+01:00  INFO 133742 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_16227454402835251428.dat
2022-11-02T13:42:20.949+01:00  INFO 133742 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T13:42:20.949+01:00  INFO 133742 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T13:42:20.949+01:00  INFO 133742 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T13:42:20.949+01:00  INFO 133742 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T13:42:20.949+01:00  INFO 133742 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T13:42:20.950+01:00  INFO 133742 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T13:42:20.950+01:00  INFO 133742 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T13:42:20.986+01:00  INFO 133742 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T13:42:21.039+01:00  INFO 133742 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T13:42:21.072+01:00 ERROR 133742 --- [pool-1-thread-1] i.d.s.file.history.FileSchemaHistory     : The 'schema.history.internal.file.filename' value is invalid: A value is required
2022-11-02T13:42:21.073+01:00  INFO 133742 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Stopping down connector
2022-11-02T13:42:21.075+01:00  INFO 133742 --- [pool-2-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T13:42:21.077+01:00  INFO 133742 --- [pool-1-thread-1] o.a.k.c.storage.FileOffsetBackingStore   : Stopped FileOffsetBackingStore
2022-11-02T13:42:21.077+01:00 ERROR 133742 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Unable to initialize and start connector's task class 'io.debezium.connector.mysql.MySqlConnectorTask' with config: {database.allowPublicKeyRetrieval=true, connector.class=io.debezium.connector.mysql.MySqlConnector, database.user=user, offset.storage=org.apache.kafka.connect.storage.FileOffsetBackingStore, database.server.id=1, database.history.internal.file.filename=/tmp/dbhistory_8518916130343746596.dat, offset.flush.timeout.ms=5000, errors.retry.delay.max.ms=10000, include.schema.changes=false, database.port=3306, offset.flush.interval.ms=60000, topic.prefix=my-app-connector, schema.history.internal=io.debezium.storage.file.history.FileSchemaHistory, offset.storage.file.filename=/tmp/offsets_16227454402835251428.dat, errors.max.retries=-1, database.hostname=localhost, database.password=********, name=engine, errors.retry.delay.initial.ms=300, value.converter=org.apache.kafka.connect.json.JsonConverter, key.converter=org.apache.kafka.connect.json.JsonConverter}

org.apache.kafka.connect.errors.ConnectException: Error configuring an instance of FileSchemaHistory; check the logs for details
	at io.debezium.storage.file.history.FileSchemaHistory.configure(FileSchemaHistory.java:64) ~[debezium-storage-file-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.HistorizedRelationalDatabaseConnectorConfig.getSchemaHistory(HistorizedRelationalDatabaseConnectorConfig.java:115) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.HistorizedRelationalDatabaseSchema.<init>(HistorizedRelationalDatabaseSchema.java:41) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlDatabaseSchema.<init>(MySqlDatabaseSchema.java:81) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlConnectorTask.start(MySqlConnectorTask.java:88) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.common.BaseSourceTask.start(BaseSourceTask.java:135) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.embedded.EmbeddedEngine.run(EmbeddedEngine.java:797) ~[debezium-embedded-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.embedded.ConvertingEngineBuilder$2.run(ConvertingEngineBuilder.java:195) ~[debezium-embedded-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]

2022-11-02T13:42:21.168+01:00  WARN 133742 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-11-02T13:42:21.509+01:00  INFO 133742 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
2022-11-02T13:42:21.521+01:00  INFO 133742 --- [main] c.example.demo.AuditLogTestApplication   : Started AuditLogTestApplication in 3.316 seconds (process running for 3.792)
2022-11-02T13:44:42.584+01:00  INFO 133742 --- [SpringApplicationShutdownHook] io.debezium.embedded.EmbeddedEngine      : Stopping the embedded engine
2022-11-02T13:44:42.585+01:00  INFO 133742 --- [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2022-11-02T13:44:42.586+01:00  INFO 133742 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-11-02T13:44:42.591+01:00  INFO 133742 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-11-02T13:44:44.800+01:00  INFO 135324 --- [main] c.example.demo.AuditLogTestApplication   : Starting AuditLogTestApplication using Java 17.0.4.1 with PID 135324 (/home/schmitz/dev/security/audit_test/target/classes started by schmitz in /home/schmitz/dev/security/audit_test)
2022-11-02T13:44:44.802+01:00  INFO 135324 --- [main] c.example.demo.AuditLogTestApplication   : No active profile set, falling back to 1 default profile: "default"
2022-11-02T13:44:45.343+01:00  INFO 135324 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-11-02T13:44:45.389+01:00  INFO 135324 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 38 ms. Found 1 JPA repository interfaces.
2022-11-02T13:44:45.848+01:00  INFO 135324 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
2022-11-02T13:44:45.857+01:00  INFO 135324 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-11-02T13:44:45.858+01:00  INFO 135324 --- [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.0.27]
2022-11-02T13:44:45.948+01:00  INFO 135324 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-11-02T13:44:45.949+01:00  INFO 135324 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1103 ms
2022-11-02T13:44:46.110+01:00  INFO 135324 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-11-02T13:44:46.150+01:00  INFO 135324 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.1.5.Final
2022-11-02T13:44:46.270+01:00  WARN 135324 --- [main] org.hibernate.orm.deprecation            : HHH90000021: Encountered deprecated setting [javax.persistence.sharedCache.mode], use [jakarta.persistence.sharedCache.mode] instead
2022-11-02T13:44:46.353+01:00  INFO 135324 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-11-02T13:44:46.661+01:00  INFO 135324 --- [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@3739f3c9
2022-11-02T13:44:46.663+01:00  INFO 135324 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-11-02T13:44:46.716+01:00  INFO 135324 --- [main] SQL dialect                              : HHH000400: Using dialect: org.hibernate.dialect.MySQLDialect
2022-11-02T13:44:47.220+01:00  INFO 135324 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-11-02T13:44:47.225+01:00  INFO 135324 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-11-02T13:44:47.276+01:00  INFO 135324 --- [main] o.a.k.connect.json.JsonConverterConfig   : JsonConverterConfig values: 
	converter.type = key
	decimal.format = BASE64
	schemas.cache.size = 1000
	schemas.enable = false

2022-11-02T13:44:47.278+01:00  INFO 135324 --- [main] o.a.k.connect.json.JsonConverterConfig   : JsonConverterConfig values: 
	converter.type = value
	decimal.format = BASE64
	schemas.cache.size = 1000
	schemas.enable = false

2022-11-02T13:44:47.287+01:00  INFO 135324 --- [main] i.d.e.EmbeddedEngine$EmbeddedConfig      : EmbeddedConfig values: 
	access.control.allow.methods = 
	access.control.allow.origin = 
	admin.listeners = null
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	config.providers = []
	connector.client.config.override.policy = All
	header.converter = class org.apache.kafka.connect.storage.SimpleHeaderConverter
	key.converter = class org.apache.kafka.connect.json.JsonConverter
	listeners = [http://:8083]
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	offset.flush.interval.ms = 60000
	offset.flush.timeout.ms = 5000
	offset.storage.file.filename = /tmp/offsets_5186267138157937898.dat
	offset.storage.partitions = null
	offset.storage.replication.factor = null
	offset.storage.topic = 
	plugin.path = null
	response.http.headers.config = 
	rest.advertised.host.name = null
	rest.advertised.listener = null
	rest.advertised.port = null
	rest.extension.classes = []
	ssl.cipher.suites = null
	ssl.client.auth = none
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	task.shutdown.graceful.timeout.ms = 5000
	topic.creation.enable = true
	topic.tracking.allow.reset = true
	topic.tracking.enable = true
	value.converter = class org.apache.kafka.connect.json.JsonConverter

2022-11-02T13:44:47.287+01:00  WARN 135324 --- [main] o.a.kafka.connect.runtime.WorkerConfig   : Variables cannot be used in the 'plugin.path' property, since the property is used by plugin scanning before the config providers that replace the variables are initialized. The raw value 'null' was used for plugin scanning, as opposed to the transformed value 'null', and this may cause unexpected results.
2022-11-02T13:44:47.293+01:00  INFO 135324 --- [pool-1-thread-1] o.a.k.c.storage.FileOffsetBackingStore   : Starting FileOffsetBackingStore with file /tmp/offsets_5186267138157937898.dat
2022-11-02T13:44:47.343+01:00  INFO 135324 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T13:44:47.344+01:00  INFO 135324 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T13:44:47.344+01:00  INFO 135324 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T13:44:47.344+01:00  INFO 135324 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T13:44:47.344+01:00  INFO 135324 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T13:44:47.344+01:00  INFO 135324 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T13:44:47.345+01:00  INFO 135324 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.history.internal.file.filename = /tmp/dbhistory_10035146776103717297.dat
2022-11-02T13:44:47.345+01:00  INFO 135324 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T13:44:47.345+01:00  INFO 135324 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T13:44:47.345+01:00  INFO 135324 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T13:44:47.345+01:00  INFO 135324 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T13:44:47.345+01:00  INFO 135324 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T13:44:47.346+01:00  INFO 135324 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T13:44:47.346+01:00  INFO 135324 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T13:44:47.346+01:00  INFO 135324 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_5186267138157937898.dat
2022-11-02T13:44:47.346+01:00  INFO 135324 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T13:44:47.346+01:00  INFO 135324 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T13:44:47.346+01:00  INFO 135324 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T13:44:47.347+01:00  INFO 135324 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T13:44:47.347+01:00  INFO 135324 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T13:44:47.347+01:00  INFO 135324 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T13:44:47.347+01:00  INFO 135324 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T13:44:47.384+01:00  INFO 135324 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T13:44:47.433+01:00  INFO 135324 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T13:44:47.467+01:00 ERROR 135324 --- [pool-1-thread-1] i.d.s.file.history.FileSchemaHistory     : The 'schema.history.internal.file.filename' value is invalid: A value is required
2022-11-02T13:44:47.468+01:00  INFO 135324 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Stopping down connector
2022-11-02T13:44:47.470+01:00  INFO 135324 --- [pool-2-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T13:44:47.471+01:00  INFO 135324 --- [pool-1-thread-1] o.a.k.c.storage.FileOffsetBackingStore   : Stopped FileOffsetBackingStore
2022-11-02T13:44:47.472+01:00 ERROR 135324 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Unable to initialize and start connector's task class 'io.debezium.connector.mysql.MySqlConnectorTask' with config: {database.allowPublicKeyRetrieval=true, connector.class=io.debezium.connector.mysql.MySqlConnector, database.user=user, offset.storage=org.apache.kafka.connect.storage.FileOffsetBackingStore, database.server.id=1, database.history.internal.file.filename=/tmp/dbhistory_10035146776103717297.dat, offset.flush.timeout.ms=5000, errors.retry.delay.max.ms=10000, include.schema.changes=false, database.port=3306, offset.flush.interval.ms=60000, topic.prefix=my-app-connector, schema.history.internal=io.debezium.storage.file.history.FileSchemaHistory, offset.storage.file.filename=/tmp/offsets_5186267138157937898.dat, errors.max.retries=-1, database.hostname=localhost, database.password=********, name=engine, errors.retry.delay.initial.ms=300, value.converter=org.apache.kafka.connect.json.JsonConverter, key.converter=org.apache.kafka.connect.json.JsonConverter}

org.apache.kafka.connect.errors.ConnectException: Error configuring an instance of FileSchemaHistory; check the logs for details
	at io.debezium.storage.file.history.FileSchemaHistory.configure(FileSchemaHistory.java:64) ~[debezium-storage-file-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.HistorizedRelationalDatabaseConnectorConfig.getSchemaHistory(HistorizedRelationalDatabaseConnectorConfig.java:115) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.HistorizedRelationalDatabaseSchema.<init>(HistorizedRelationalDatabaseSchema.java:41) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlDatabaseSchema.<init>(MySqlDatabaseSchema.java:81) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlConnectorTask.start(MySqlConnectorTask.java:88) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.common.BaseSourceTask.start(BaseSourceTask.java:135) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.embedded.EmbeddedEngine.run(EmbeddedEngine.java:797) ~[debezium-embedded-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.embedded.ConvertingEngineBuilder$2.run(ConvertingEngineBuilder.java:195) ~[debezium-embedded-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]

2022-11-02T13:44:47.545+01:00  WARN 135324 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-11-02T13:44:47.833+01:00  INFO 135324 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
2022-11-02T13:44:47.842+01:00  INFO 135324 --- [main] c.example.demo.AuditLogTestApplication   : Started AuditLogTestApplication in 3.391 seconds (process running for 3.755)
2022-11-02T13:50:29.190+01:00  INFO 135324 --- [SpringApplicationShutdownHook] io.debezium.embedded.EmbeddedEngine      : Stopping the embedded engine
2022-11-02T13:50:29.190+01:00  INFO 135324 --- [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2022-11-02T13:50:29.191+01:00  INFO 135324 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-11-02T13:50:29.196+01:00  INFO 135324 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-11-02T13:51:15.105+01:00  INFO 139906 --- [main] c.example.demo.AuditLogTestApplication   : Starting AuditLogTestApplication using Java 17.0.4.1 with PID 139906 (/home/schmitz/dev/security/audit_test/target/classes started by schmitz in /home/schmitz/dev/security/audit_test)
2022-11-02T13:51:15.107+01:00  INFO 139906 --- [main] c.example.demo.AuditLogTestApplication   : No active profile set, falling back to 1 default profile: "default"
2022-11-02T13:51:15.634+01:00  INFO 139906 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-11-02T13:51:15.688+01:00  INFO 139906 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 45 ms. Found 1 JPA repository interfaces.
2022-11-02T13:51:16.105+01:00  INFO 139906 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
2022-11-02T13:51:16.115+01:00  INFO 139906 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-11-02T13:51:16.115+01:00  INFO 139906 --- [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.0.27]
2022-11-02T13:51:16.203+01:00  INFO 139906 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-11-02T13:51:16.203+01:00  INFO 139906 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1054 ms
2022-11-02T13:51:16.341+01:00  INFO 139906 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-11-02T13:51:16.384+01:00  INFO 139906 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.1.5.Final
2022-11-02T13:51:16.529+01:00  WARN 139906 --- [main] org.hibernate.orm.deprecation            : HHH90000021: Encountered deprecated setting [javax.persistence.sharedCache.mode], use [jakarta.persistence.sharedCache.mode] instead
2022-11-02T13:51:16.621+01:00  INFO 139906 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-11-02T13:51:16.889+01:00  INFO 139906 --- [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@401926df
2022-11-02T13:51:16.891+01:00  INFO 139906 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-11-02T13:51:16.934+01:00  INFO 139906 --- [main] SQL dialect                              : HHH000400: Using dialect: org.hibernate.dialect.MySQLDialect
2022-11-02T13:51:17.422+01:00  INFO 139906 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-11-02T13:51:17.428+01:00  INFO 139906 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-11-02T13:51:17.485+01:00  INFO 139906 --- [main] o.a.k.connect.json.JsonConverterConfig   : JsonConverterConfig values: 
	converter.type = key
	decimal.format = BASE64
	schemas.cache.size = 1000
	schemas.enable = false

2022-11-02T13:51:17.488+01:00  INFO 139906 --- [main] o.a.k.connect.json.JsonConverterConfig   : JsonConverterConfig values: 
	converter.type = value
	decimal.format = BASE64
	schemas.cache.size = 1000
	schemas.enable = false

2022-11-02T13:51:17.495+01:00  INFO 139906 --- [main] i.d.e.EmbeddedEngine$EmbeddedConfig      : EmbeddedConfig values: 
	access.control.allow.methods = 
	access.control.allow.origin = 
	admin.listeners = null
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	config.providers = []
	connector.client.config.override.policy = All
	header.converter = class org.apache.kafka.connect.storage.SimpleHeaderConverter
	key.converter = class org.apache.kafka.connect.json.JsonConverter
	listeners = [http://:8083]
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	offset.flush.interval.ms = 60000
	offset.flush.timeout.ms = 5000
	offset.storage.file.filename = /tmp/offsets_7138461274327255394.dat
	offset.storage.partitions = null
	offset.storage.replication.factor = null
	offset.storage.topic = 
	plugin.path = null
	response.http.headers.config = 
	rest.advertised.host.name = null
	rest.advertised.listener = null
	rest.advertised.port = null
	rest.extension.classes = []
	ssl.cipher.suites = null
	ssl.client.auth = none
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	task.shutdown.graceful.timeout.ms = 5000
	topic.creation.enable = true
	topic.tracking.allow.reset = true
	topic.tracking.enable = true
	value.converter = class org.apache.kafka.connect.json.JsonConverter

2022-11-02T13:51:17.496+01:00  WARN 139906 --- [main] o.a.kafka.connect.runtime.WorkerConfig   : Variables cannot be used in the 'plugin.path' property, since the property is used by plugin scanning before the config providers that replace the variables are initialized. The raw value 'null' was used for plugin scanning, as opposed to the transformed value 'null', and this may cause unexpected results.
2022-11-02T13:51:17.503+01:00  INFO 139906 --- [pool-1-thread-1] o.a.k.c.storage.FileOffsetBackingStore   : Starting FileOffsetBackingStore with file /tmp/offsets_7138461274327255394.dat
2022-11-02T13:51:17.561+01:00  INFO 139906 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T13:51:17.562+01:00  INFO 139906 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T13:51:17.563+01:00  INFO 139906 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T13:51:17.563+01:00  INFO 139906 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T13:51:17.563+01:00  INFO 139906 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T13:51:17.563+01:00  INFO 139906 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T13:51:17.563+01:00  INFO 139906 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.history.internal.file.filename = /tmp/dbhistory_8055923058878939393.dat
2022-11-02T13:51:17.563+01:00  INFO 139906 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T13:51:17.563+01:00  INFO 139906 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T13:51:17.564+01:00  INFO 139906 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T13:51:17.564+01:00  INFO 139906 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T13:51:17.565+01:00  INFO 139906 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T13:51:17.565+01:00  INFO 139906 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T13:51:17.565+01:00  INFO 139906 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T13:51:17.565+01:00  INFO 139906 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_7138461274327255394.dat
2022-11-02T13:51:17.565+01:00  INFO 139906 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T13:51:17.566+01:00  INFO 139906 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T13:51:17.566+01:00  INFO 139906 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T13:51:17.566+01:00  INFO 139906 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T13:51:17.566+01:00  INFO 139906 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T13:51:17.567+01:00  INFO 139906 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T13:51:17.567+01:00  INFO 139906 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T13:51:17.603+01:00  INFO 139906 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T13:51:17.653+01:00  INFO 139906 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T13:51:17.694+01:00 ERROR 139906 --- [pool-1-thread-1] i.d.s.file.history.FileSchemaHistory     : The 'schema.history.internal.file.filename' value is invalid: A value is required
2022-11-02T13:51:17.695+01:00  INFO 139906 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Stopping down connector
2022-11-02T13:51:17.697+01:00  INFO 139906 --- [pool-2-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T13:51:17.698+01:00  INFO 139906 --- [pool-1-thread-1] o.a.k.c.storage.FileOffsetBackingStore   : Stopped FileOffsetBackingStore
2022-11-02T13:51:17.699+01:00 ERROR 139906 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Unable to initialize and start connector's task class 'io.debezium.connector.mysql.MySqlConnectorTask' with config: {database.allowPublicKeyRetrieval=true, connector.class=io.debezium.connector.mysql.MySqlConnector, database.user=user, offset.storage=org.apache.kafka.connect.storage.FileOffsetBackingStore, database.server.id=1, database.history.internal.file.filename=/tmp/dbhistory_8055923058878939393.dat, offset.flush.timeout.ms=5000, errors.retry.delay.max.ms=10000, include.schema.changes=false, database.port=3306, offset.flush.interval.ms=60000, topic.prefix=my-app-connector, schema.history.internal=io.debezium.storage.file.history.FileSchemaHistory, offset.storage.file.filename=/tmp/offsets_7138461274327255394.dat, errors.max.retries=-1, database.hostname=localhost, database.password=********, name=engine, errors.retry.delay.initial.ms=300, value.converter=org.apache.kafka.connect.json.JsonConverter, key.converter=org.apache.kafka.connect.json.JsonConverter}

org.apache.kafka.connect.errors.ConnectException: Error configuring an instance of FileSchemaHistory; check the logs for details
	at io.debezium.storage.file.history.FileSchemaHistory.configure(FileSchemaHistory.java:64) ~[debezium-storage-file-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.HistorizedRelationalDatabaseConnectorConfig.getSchemaHistory(HistorizedRelationalDatabaseConnectorConfig.java:115) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.HistorizedRelationalDatabaseSchema.<init>(HistorizedRelationalDatabaseSchema.java:41) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlDatabaseSchema.<init>(MySqlDatabaseSchema.java:81) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlConnectorTask.start(MySqlConnectorTask.java:88) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.common.BaseSourceTask.start(BaseSourceTask.java:135) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.embedded.EmbeddedEngine.run(EmbeddedEngine.java:797) ~[debezium-embedded-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.embedded.ConvertingEngineBuilder$2.run(ConvertingEngineBuilder.java:195) ~[debezium-embedded-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]

2022-11-02T13:51:17.785+01:00  WARN 139906 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-11-02T13:51:18.112+01:00  INFO 139906 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
2022-11-02T13:51:18.125+01:00  INFO 139906 --- [main] c.example.demo.AuditLogTestApplication   : Started AuditLogTestApplication in 3.341 seconds (process running for 3.823)
2022-11-02T13:54:29.139+01:00  INFO 139906 --- [SpringApplicationShutdownHook] io.debezium.embedded.EmbeddedEngine      : Stopping the embedded engine
2022-11-02T13:54:29.139+01:00  INFO 139906 --- [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2022-11-02T13:54:29.141+01:00  INFO 139906 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-11-02T13:54:29.146+01:00  INFO 139906 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-11-02T13:54:47.142+01:00  INFO 142048 --- [main] c.example.demo.AuditLogTestApplication   : Starting AuditLogTestApplication using Java 17.0.4.1 with PID 142048 (/home/schmitz/dev/security/audit_test/target/classes started by schmitz in /home/schmitz/dev/security/audit_test)
2022-11-02T13:54:47.146+01:00  INFO 142048 --- [main] c.example.demo.AuditLogTestApplication   : No active profile set, falling back to 1 default profile: "default"
2022-11-02T13:54:47.685+01:00  INFO 142048 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-11-02T13:54:47.737+01:00  INFO 142048 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 42 ms. Found 1 JPA repository interfaces.
2022-11-02T13:54:48.155+01:00  INFO 142048 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
2022-11-02T13:54:48.164+01:00  INFO 142048 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-11-02T13:54:48.164+01:00  INFO 142048 --- [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.0.27]
2022-11-02T13:54:48.252+01:00  INFO 142048 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-11-02T13:54:48.253+01:00  INFO 142048 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1068 ms
2022-11-02T13:54:48.386+01:00  INFO 142048 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-11-02T13:54:48.428+01:00  INFO 142048 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.1.5.Final
2022-11-02T13:54:48.552+01:00  WARN 142048 --- [main] org.hibernate.orm.deprecation            : HHH90000021: Encountered deprecated setting [javax.persistence.sharedCache.mode], use [jakarta.persistence.sharedCache.mode] instead
2022-11-02T13:54:48.633+01:00  INFO 142048 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-11-02T13:54:48.910+01:00  INFO 142048 --- [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@31b6b0c7
2022-11-02T13:54:48.912+01:00  INFO 142048 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-11-02T13:54:48.962+01:00  INFO 142048 --- [main] SQL dialect                              : HHH000400: Using dialect: org.hibernate.dialect.MySQLDialect
2022-11-02T13:54:49.485+01:00  INFO 142048 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-11-02T13:54:49.491+01:00  INFO 142048 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-11-02T13:54:49.548+01:00  INFO 142048 --- [main] o.a.k.connect.json.JsonConverterConfig   : JsonConverterConfig values: 
	converter.type = key
	decimal.format = BASE64
	schemas.cache.size = 1000
	schemas.enable = false

2022-11-02T13:54:49.550+01:00  INFO 142048 --- [main] o.a.k.connect.json.JsonConverterConfig   : JsonConverterConfig values: 
	converter.type = value
	decimal.format = BASE64
	schemas.cache.size = 1000
	schemas.enable = false

2022-11-02T13:54:49.558+01:00  INFO 142048 --- [main] i.d.e.EmbeddedEngine$EmbeddedConfig      : EmbeddedConfig values: 
	access.control.allow.methods = 
	access.control.allow.origin = 
	admin.listeners = null
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	config.providers = []
	connector.client.config.override.policy = All
	header.converter = class org.apache.kafka.connect.storage.SimpleHeaderConverter
	key.converter = class org.apache.kafka.connect.json.JsonConverter
	listeners = [http://:8083]
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	offset.flush.interval.ms = 60000
	offset.flush.timeout.ms = 5000
	offset.storage.file.filename = /tmp/offsets_3711167316676818849.dat
	offset.storage.partitions = null
	offset.storage.replication.factor = null
	offset.storage.topic = 
	plugin.path = null
	response.http.headers.config = 
	rest.advertised.host.name = null
	rest.advertised.listener = null
	rest.advertised.port = null
	rest.extension.classes = []
	ssl.cipher.suites = null
	ssl.client.auth = none
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	task.shutdown.graceful.timeout.ms = 5000
	topic.creation.enable = true
	topic.tracking.allow.reset = true
	topic.tracking.enable = true
	value.converter = class org.apache.kafka.connect.json.JsonConverter

2022-11-02T13:54:49.559+01:00  WARN 142048 --- [main] o.a.kafka.connect.runtime.WorkerConfig   : Variables cannot be used in the 'plugin.path' property, since the property is used by plugin scanning before the config providers that replace the variables are initialized. The raw value 'null' was used for plugin scanning, as opposed to the transformed value 'null', and this may cause unexpected results.
2022-11-02T13:54:49.565+01:00  INFO 142048 --- [pool-1-thread-1] o.a.k.c.storage.FileOffsetBackingStore   : Starting FileOffsetBackingStore with file /tmp/offsets_3711167316676818849.dat
2022-11-02T13:54:49.621+01:00  INFO 142048 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T13:54:49.622+01:00  INFO 142048 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T13:54:49.622+01:00  INFO 142048 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T13:54:49.623+01:00  INFO 142048 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T13:54:49.623+01:00  INFO 142048 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T13:54:49.623+01:00  INFO 142048 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.history.internal.file.filename = /tmp/dbhistory_9999125928243805461.dat
2022-11-02T13:54:49.623+01:00  INFO 142048 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T13:54:49.623+01:00  INFO 142048 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T13:54:49.623+01:00  INFO 142048 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T13:54:49.623+01:00  INFO 142048 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T13:54:49.623+01:00  INFO 142048 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T13:54:49.624+01:00  INFO 142048 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T13:54:49.624+01:00  INFO 142048 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T13:54:49.624+01:00  INFO 142048 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_3711167316676818849.dat
2022-11-02T13:54:49.624+01:00  INFO 142048 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T13:54:49.624+01:00  INFO 142048 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T13:54:49.624+01:00  INFO 142048 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T13:54:49.625+01:00  INFO 142048 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T13:54:49.625+01:00  INFO 142048 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T13:54:49.626+01:00  INFO 142048 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T13:54:49.626+01:00  INFO 142048 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T13:54:49.659+01:00  INFO 142048 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T13:54:49.709+01:00  INFO 142048 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T13:54:49.741+01:00 ERROR 142048 --- [pool-1-thread-1] i.d.s.file.history.FileSchemaHistory     : The 'schema.history.internal.file.filename' value is invalid: A value is required
2022-11-02T13:54:49.741+01:00  INFO 142048 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Stopping down connector
2022-11-02T13:54:49.744+01:00  INFO 142048 --- [pool-2-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T13:54:49.745+01:00  INFO 142048 --- [pool-1-thread-1] o.a.k.c.storage.FileOffsetBackingStore   : Stopped FileOffsetBackingStore
2022-11-02T13:54:49.745+01:00 ERROR 142048 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Unable to initialize and start connector's task class 'io.debezium.connector.mysql.MySqlConnectorTask' with config: {connector.class=io.debezium.connector.mysql.MySqlConnector, database.user=user, offset.storage=org.apache.kafka.connect.storage.FileOffsetBackingStore, database.server.id=1, database.history.internal.file.filename=/tmp/dbhistory_9999125928243805461.dat, offset.flush.timeout.ms=5000, errors.retry.delay.max.ms=10000, include.schema.changes=false, database.port=3306, offset.flush.interval.ms=60000, topic.prefix=my-app-connector, schema.history.internal=io.debezium.storage.file.history.FileSchemaHistory, offset.storage.file.filename=/tmp/offsets_3711167316676818849.dat, errors.max.retries=-1, database.hostname=localhost, database.password=********, name=engine, errors.retry.delay.initial.ms=300, value.converter=org.apache.kafka.connect.json.JsonConverter, key.converter=org.apache.kafka.connect.json.JsonConverter}

org.apache.kafka.connect.errors.ConnectException: Error configuring an instance of FileSchemaHistory; check the logs for details
	at io.debezium.storage.file.history.FileSchemaHistory.configure(FileSchemaHistory.java:64) ~[debezium-storage-file-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.HistorizedRelationalDatabaseConnectorConfig.getSchemaHistory(HistorizedRelationalDatabaseConnectorConfig.java:115) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.relational.HistorizedRelationalDatabaseSchema.<init>(HistorizedRelationalDatabaseSchema.java:41) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlDatabaseSchema.<init>(MySqlDatabaseSchema.java:81) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.mysql.MySqlConnectorTask.start(MySqlConnectorTask.java:88) ~[debezium-connector-mysql-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.connector.common.BaseSourceTask.start(BaseSourceTask.java:135) ~[debezium-core-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.embedded.EmbeddedEngine.run(EmbeddedEngine.java:797) ~[debezium-embedded-2.0.0.Final.jar:2.0.0.Final]
	at io.debezium.embedded.ConvertingEngineBuilder$2.run(ConvertingEngineBuilder.java:195) ~[debezium-embedded-2.0.0.Final.jar:2.0.0.Final]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~[na:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]

2022-11-02T13:54:49.828+01:00  WARN 142048 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-11-02T13:54:50.169+01:00  INFO 142048 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
2022-11-02T13:54:50.179+01:00  INFO 142048 --- [main] c.example.demo.AuditLogTestApplication   : Started AuditLogTestApplication in 3.382 seconds (process running for 3.88)
2022-11-02T13:57:15.157+01:00  INFO 142048 --- [SpringApplicationShutdownHook] io.debezium.embedded.EmbeddedEngine      : Stopping the embedded engine
2022-11-02T13:57:15.157+01:00  INFO 142048 --- [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2022-11-02T13:57:15.158+01:00  INFO 142048 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-11-02T13:57:15.163+01:00  INFO 142048 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-11-02T13:57:16.197+01:00  INFO 143497 --- [main] c.example.demo.AuditLogTestApplication   : Starting AuditLogTestApplication using Java 17.0.4.1 with PID 143497 (/home/schmitz/dev/security/audit_test/target/classes started by schmitz in /home/schmitz/dev/security/audit_test)
2022-11-02T13:57:16.200+01:00  INFO 143497 --- [main] c.example.demo.AuditLogTestApplication   : No active profile set, falling back to 1 default profile: "default"
2022-11-02T13:57:16.700+01:00  INFO 143497 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-11-02T13:57:16.748+01:00  INFO 143497 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 40 ms. Found 1 JPA repository interfaces.
2022-11-02T13:57:17.199+01:00  INFO 143497 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
2022-11-02T13:57:17.205+01:00  INFO 143497 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-11-02T13:57:17.205+01:00  INFO 143497 --- [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.0.27]
2022-11-02T13:57:17.287+01:00  INFO 143497 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-11-02T13:57:17.288+01:00  INFO 143497 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1045 ms
2022-11-02T13:57:17.414+01:00  INFO 143497 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-11-02T13:57:17.454+01:00  INFO 143497 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.1.5.Final
2022-11-02T13:57:17.574+01:00  WARN 143497 --- [main] org.hibernate.orm.deprecation            : HHH90000021: Encountered deprecated setting [javax.persistence.sharedCache.mode], use [jakarta.persistence.sharedCache.mode] instead
2022-11-02T13:57:17.662+01:00  INFO 143497 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-11-02T13:57:17.942+01:00  INFO 143497 --- [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@6335f04a
2022-11-02T13:57:17.944+01:00  INFO 143497 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-11-02T13:57:17.988+01:00  INFO 143497 --- [main] SQL dialect                              : HHH000400: Using dialect: org.hibernate.dialect.MySQLDialect
2022-11-02T13:57:18.467+01:00  INFO 143497 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-11-02T13:57:18.472+01:00  INFO 143497 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-11-02T13:57:18.525+01:00  INFO 143497 --- [main] o.a.k.connect.json.JsonConverterConfig   : JsonConverterConfig values: 
	converter.type = key
	decimal.format = BASE64
	schemas.cache.size = 1000
	schemas.enable = false

2022-11-02T13:57:18.527+01:00  INFO 143497 --- [main] o.a.k.connect.json.JsonConverterConfig   : JsonConverterConfig values: 
	converter.type = value
	decimal.format = BASE64
	schemas.cache.size = 1000
	schemas.enable = false

2022-11-02T13:57:18.534+01:00  INFO 143497 --- [main] i.d.e.EmbeddedEngine$EmbeddedConfig      : EmbeddedConfig values: 
	access.control.allow.methods = 
	access.control.allow.origin = 
	admin.listeners = null
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	config.providers = []
	connector.client.config.override.policy = All
	header.converter = class org.apache.kafka.connect.storage.SimpleHeaderConverter
	key.converter = class org.apache.kafka.connect.json.JsonConverter
	listeners = [http://:8083]
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	offset.flush.interval.ms = 60000
	offset.flush.timeout.ms = 5000
	offset.storage.file.filename = /tmp/offsets_1336563261339266002.dat
	offset.storage.partitions = null
	offset.storage.replication.factor = null
	offset.storage.topic = 
	plugin.path = null
	response.http.headers.config = 
	rest.advertised.host.name = null
	rest.advertised.listener = null
	rest.advertised.port = null
	rest.extension.classes = []
	ssl.cipher.suites = null
	ssl.client.auth = none
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	task.shutdown.graceful.timeout.ms = 5000
	topic.creation.enable = true
	topic.tracking.allow.reset = true
	topic.tracking.enable = true
	value.converter = class org.apache.kafka.connect.json.JsonConverter

2022-11-02T13:57:18.535+01:00  WARN 143497 --- [main] o.a.kafka.connect.runtime.WorkerConfig   : Variables cannot be used in the 'plugin.path' property, since the property is used by plugin scanning before the config providers that replace the variables are initialized. The raw value 'null' was used for plugin scanning, as opposed to the transformed value 'null', and this may cause unexpected results.
2022-11-02T13:57:18.541+01:00  INFO 143497 --- [pool-1-thread-1] o.a.k.c.storage.FileOffsetBackingStore   : Starting FileOffsetBackingStore with file /tmp/offsets_1336563261339266002.dat
2022-11-02T13:57:18.598+01:00  INFO 143497 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Starting MySqlConnectorTask with configuration:
2022-11-02T13:57:18.599+01:00  INFO 143497 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    connector.class = io.debezium.connector.mysql.MySqlConnector
2022-11-02T13:57:18.600+01:00  INFO 143497 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.allowPublicKeyRetrieval = true
2022-11-02T13:57:18.601+01:00  INFO 143497 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.user = user
2022-11-02T13:57:18.601+01:00  INFO 143497 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage = org.apache.kafka.connect.storage.FileOffsetBackingStore
2022-11-02T13:57:18.601+01:00  INFO 143497 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.server.id = 1
2022-11-02T13:57:18.601+01:00  INFO 143497 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.timeout.ms = 5000
2022-11-02T13:57:18.601+01:00  INFO 143497 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.max.ms = 10000
2022-11-02T13:57:18.601+01:00  INFO 143497 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    include.schema.changes = false
2022-11-02T13:57:18.601+01:00  INFO 143497 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.port = 3306
2022-11-02T13:57:18.602+01:00  INFO 143497 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal.file.filename = /tmp/dbhistory_12284755628651767695.dat
2022-11-02T13:57:18.602+01:00  INFO 143497 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.flush.interval.ms = 60000
2022-11-02T13:57:18.602+01:00  INFO 143497 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    topic.prefix = my-app-connector
2022-11-02T13:57:18.603+01:00  INFO 143497 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    schema.history.internal = io.debezium.storage.file.history.FileSchemaHistory
2022-11-02T13:57:18.603+01:00  INFO 143497 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    offset.storage.file.filename = /tmp/offsets_1336563261339266002.dat
2022-11-02T13:57:18.603+01:00  INFO 143497 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.max.retries = -1
2022-11-02T13:57:18.603+01:00  INFO 143497 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.hostname = localhost
2022-11-02T13:57:18.604+01:00  INFO 143497 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    database.password = ********
2022-11-02T13:57:18.604+01:00  INFO 143497 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    name = engine
2022-11-02T13:57:18.604+01:00  INFO 143497 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    errors.retry.delay.initial.ms = 300
2022-11-02T13:57:18.604+01:00  INFO 143497 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    value.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T13:57:18.604+01:00  INFO 143497 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      :    key.converter = org.apache.kafka.connect.json.JsonConverter
2022-11-02T13:57:18.642+01:00  INFO 143497 --- [pool-1-thread-1] i.debezium.config.CommonConnectorConfig  : Loading the custom topic naming strategy plugin: io.debezium.schema.DefaultTopicNamingStrategy
2022-11-02T13:57:18.687+01:00  INFO 143497 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : No previous offsets found
2022-11-02T13:57:18.830+01:00  INFO 143497 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Closing connection before starting schema recovery
2022-11-02T13:57:18.832+01:00  INFO 143497 --- [pool-2-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T13:57:18.833+01:00  INFO 143497 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Connector started for the first time, database schema history recovery will not be executed
2022-11-02T13:57:18.833+01:00  INFO 143497 --- [pool-1-thread-1] i.d.connector.mysql.MySqlConnectorTask   : Reconnecting after finishing schema recovery
2022-11-02T13:57:18.848+01:00  WARN 143497 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-11-02T13:57:18.878+01:00  INFO 143497 --- [pool-1-thread-1] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = change-event-source-coordinator
2022-11-02T13:57:18.881+01:00  INFO 143497 --- [pool-1-thread-1] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-change-event-source-coordinator
2022-11-02T13:57:18.885+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Metrics registered
2022-11-02T13:57:18.886+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Context created
2022-11-02T13:57:18.891+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : No previous offset has been found
2022-11-02T13:57:18.892+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : According to the connector configuration both schema and data will be snapshotted
2022-11-02T13:57:18.893+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 1 - Preparing
2022-11-02T13:57:18.894+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 2 - Determining captured tables
2022-11-02T13:57:18.895+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available databases
2022-11-02T13:57:18.898+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 list of available databases is: [dbSRC, information_schema, mysql, performance_schema, sys]
2022-11-02T13:57:18.898+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read list of available tables in each database
2022-11-02T13:57:18.912+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	snapshot continuing with database(s): [information_schema, performance_schema, dbSRC, mysql, sys]
2022-11-02T13:57:18.913+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Adding table dbSRC.customer to the list of capture schema tables
2022-11-02T13:57:18.915+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 3 - Locking captured tables [dbSRC.customer]
2022-11-02T13:57:18.918+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Flush and obtain global read lock to prevent writes to database
2022-11-02T13:57:18.920+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 4 - Determining snapshot offset
2022-11-02T13:57:18.925+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Read binlog position of MySQL primary server
2022-11-02T13:57:18.928+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : 	 using binlog 'binlog.000002' at position '2435' and gtid ''
2022-11-02T13:57:18.928+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 5 - Reading structure of captured tables
2022-11-02T13:57:18.928+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : All eligible tables schema should be captured, capturing: [dbSRC.customer]
2022-11-02T13:57:19.168+01:00  INFO 143497 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
2022-11-02T13:57:19.177+01:00  INFO 143497 --- [main] c.example.demo.AuditLogTestApplication   : Started AuditLogTestApplication in 3.333 seconds (process running for 3.653)
2022-11-02T13:57:19.389+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Reading structure of database 'dbSRC'
2022-11-02T13:57:19.455+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 6 - Persisting schema history
2022-11-02T13:57:19.487+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Releasing global read lock to enable MySQL writes
2022-11-02T13:57:19.488+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlSnapshotChangeEventSource   : Writes to MySQL tables prevented for a total of 00:00:00.569
2022-11-02T13:57:19.489+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshot step 7 - Snapshotting data
2022-11-02T13:57:19.490+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Snapshotting contents of 1 tables while still in transaction
2022-11-02T13:57:19.490+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : Exporting data from table 'dbSRC.customer' (1 of 1 tables)
2022-11-02T13:57:19.491+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : 	 For table 'dbSRC.customer' using select statement: 'SELECT `id`, `email`, `fullname` FROM `dbSRC`.`customer`'
2022-11-02T13:57:19.506+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.r.RelationalSnapshotChangeEventSource : 	 Finished exporting 0 records for table 'dbSRC.customer'; total duration '00:00:00.015'
2022-11-02T13:57:19.509+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot - Final stage
2022-11-02T13:57:19.509+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] .d.p.s.AbstractSnapshotChangeEventSource : Snapshot completed
2022-11-02T13:57:19.509+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Snapshot ended with SnapshotResult [status=COMPLETED, offset=MySqlOffsetContext [sourceInfoSchema=Schema{io.debezium.connector.mysql.Source:STRUCT}, sourceInfo=SourceInfo [currentGtid=null, currentBinlogFilename=binlog.000002, currentBinlogPosition=2435, currentRowNumber=0, serverId=0, sourceTime=2022-11-02T12:57:19.470Z, threadId=-1, currentQuery=null, tableIds=[dbSRC.customer], databaseName=dbSRC], snapshotCompleted=true, transactionContext=TransactionContext [currentTransactionId=null, perTableEventCount={}, totalEventCount=0], restartGtidSet=null, currentGtidSet=null, restartBinlogFilename=binlog.000002, restartBinlogPosition=2435, restartRowsToSkip=0, restartEventsToSkip=0, currentEventLengthInBytes=0, inTransaction=false, transactionId=null, incrementalSnapshotContext =IncrementalSnapshotContext [windowOpened=false, chunkEndPosition=null, dataCollectionsToSnapshot=[], lastEventKeySent=null, maximumKey=null]]]
2022-11-02T13:57:19.546+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.util.Threads                 : Requested thread factory for connector MySqlConnector, id = my-app-connector named = binlog-client
2022-11-02T13:57:19.550+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Starting streaming
2022-11-02T13:57:19.561+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlStreamingChangeEventSource  : Skip 0 events on streaming start
2022-11-02T13:57:19.562+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlStreamingChangeEventSource  : Skip 0 rows on streaming start
2022-11-02T13:57:19.563+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-binlog-client
2022-11-02T13:57:19.567+01:00  INFO 143497 --- [blc-localhost:3306] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-binlog-client
2022-11-02T13:57:19.579+01:00  INFO 143497 --- [blc-localhost:3306] c.g.shyiko.mysql.binlog.BinaryLogClient  : Connected to localhost:3306 at binlog.000002/2435 (sid:1, cid:117)
2022-11-02T13:57:19.579+01:00  INFO 143497 --- [blc-localhost:3306] i.d.c.m.MySqlStreamingChangeEventSource  : Connected to MySQL binlog at localhost:3306, starting at MySqlOffsetContext [sourceInfoSchema=Schema{io.debezium.connector.mysql.Source:STRUCT}, sourceInfo=SourceInfo [currentGtid=null, currentBinlogFilename=binlog.000002, currentBinlogPosition=2435, currentRowNumber=0, serverId=0, sourceTime=2022-11-02T12:57:19.470Z, threadId=-1, currentQuery=null, tableIds=[dbSRC.customer], databaseName=dbSRC], snapshotCompleted=true, transactionContext=TransactionContext [currentTransactionId=null, perTableEventCount={}, totalEventCount=0], restartGtidSet=null, currentGtidSet=null, restartBinlogFilename=binlog.000002, restartBinlogPosition=2435, restartRowsToSkip=0, restartEventsToSkip=0, currentEventLengthInBytes=0, inTransaction=false, transactionId=null, incrementalSnapshotContext =IncrementalSnapshotContext [windowOpened=false, chunkEndPosition=null, dataCollectionsToSnapshot=[], lastEventKeySent=null, maximumKey=null]]
2022-11-02T13:57:19.580+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlStreamingChangeEventSource  : Waiting for keepalive thread to start
2022-11-02T13:57:19.580+01:00  INFO 143497 --- [blc-localhost:3306] io.debezium.util.Threads                 : Creating thread debezium-mysqlconnector-my-app-connector-binlog-client
2022-11-02T13:57:19.681+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.c.m.MySqlStreamingChangeEventSource  : Keepalive thread is running
2022-11-02T13:57:38.923+01:00  INFO 143497 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : 1 records sent during previous 00:00:20.36, last recorded offset of {server=my-app-connector} partition is {transaction_id=null, ts_sec=1667393858, file=binlog.000002, pos=2514, row=1, server_id=1, event=2}
2022-11-02T13:57:38.925+01:00  INFO 143497 --- [pool-1-thread-1] c.e.demo.listener.DebeziumListener       : Key = 'Struct{id=1}' value = 'Struct{after=Struct{id=1,email=jd@example.com,fullname=John Doe},source=Struct{version=2.0.0.Final,connector=mysql,name=my-app-connector,ts_ms=1667393858000,db=dbSRC,table=customer,server_id=1,file=binlog.000002,pos=2656,row=0,thread=49},op=c,ts_ms=1667393858706}'
2022-11-02T13:57:44.436+01:00  INFO 143497 --- [pool-1-thread-1] c.e.demo.listener.DebeziumListener       : Key = 'Struct{id=1}' value = 'Struct{before=Struct{id=1,email=jd@example.com,fullname=John Doe},source=Struct{version=2.0.0.Final,connector=mysql,name=my-app-connector,ts_ms=1667393863000,db=dbSRC,table=customer,server_id=1,file=binlog.000002,pos=2978,row=0,thread=50},op=d,ts_ms=1667393863970}'
2022-11-02T13:57:44.437+01:00  INFO 143497 --- [pool-1-thread-1] c.e.demo.listener.DebeziumListener       : Key = 'Struct{id=1}' value = 'null'
2022-11-02T13:57:48.679+01:00  INFO 143497 --- [SpringApplicationShutdownHook] io.debezium.embedded.EmbeddedEngine      : Stopping the embedded engine
2022-11-02T13:57:48.679+01:00  INFO 143497 --- [SpringApplicationShutdownHook] io.debezium.embedded.EmbeddedEngine      : Waiting for PT5M for connector to stop
2022-11-02T13:57:48.946+01:00  INFO 143497 --- [pool-1-thread-1] io.debezium.embedded.EmbeddedEngine      : Stopping the task and engine
2022-11-02T13:57:48.946+01:00  INFO 143497 --- [pool-1-thread-1] i.d.connector.common.BaseSourceTask      : Stopping down connector
2022-11-02T13:57:49.037+01:00  INFO 143497 --- [debezium-mysqlconnector-my-app-connector-change-event-source-coordinator] i.d.p.ChangeEventSourceCoordinator       : Finished streaming
2022-11-02T13:57:49.038+01:00  INFO 143497 --- [blc-localhost:3306] i.d.c.m.MySqlStreamingChangeEventSource  : Stopped reading binlog after 0 events, last recorded offset: {transaction_id=null, ts_sec=1667393863, file=binlog.000002, pos=3079, server_id=1, event=1}
2022-11-02T13:57:49.040+01:00  INFO 143497 --- [pool-3-thread-1] io.debezium.jdbc.JdbcConnection          : Connection gracefully closed
2022-11-02T13:57:49.051+01:00  INFO 143497 --- [pool-1-thread-1] o.a.k.c.storage.FileOffsetBackingStore   : Stopped FileOffsetBackingStore
2022-11-02T13:57:49.052+01:00  INFO 143497 --- [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2022-11-02T13:57:49.053+01:00  INFO 143497 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-11-02T13:57:49.059+01:00  INFO 143497 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
